"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[964],{964:(re,h,n)=>{n.r(h),n.d(h,{UsersModule:()=>W});var b=n(6814),s=n(95),v=n(86),A=n(5861),p=n(5219),Z=n(9862),C=n(3519),U=n.n(C),c=n(2791),e=n(4946),I=n(8672),m=n(4104),g=n(7213),T=n(5817),w=n(2656),f=n(9664),d=n(707),x=n(4480),_=n(3714);function N(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.openNew())}),e.qZA()}}function S(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",44)(1,"h5",45),e._uU(2,"Lista de Usuarios"),e.qZA(),e.TgZ(3,"span",46)(4,"form",47)(5,"div",48)(6,"input",49),e.NdJ("input",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.searchInput())}),e.qZA(),e.TgZ(7,"button",50),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.search(i.dt))}),e.qZA()()()()()}if(2&r){const t=e.oxw();e.xp6(4),e.Q6J("formGroup",t.formSearch)}}function y(r,l){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Usuario"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Correo"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Estado"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Rol"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Acciones"),e.qZA()())}function q(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"p-button",54),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.getAUser(i.id))}),e.qZA()}}function J(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"p-button",55),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.confirmDelete(i.id))}),e.qZA()}}function P(r,l){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td",51),e.YNc(10,q,1,0,"p-button",52),e._UZ(11,"p-confirmDialog"),e.YNc(12,J,1,0,"p-button",53),e.qZA()()),2&r){const t=l.$implicit,o=e.oxw();e.xp6(2),e.Oqu(t.usuario),e.xp6(2),e.Oqu(t.email),e.xp6(2),e.Oqu(o.getStatusName(t.estado)),e.xp6(2),e.Oqu(o.getRolName(t.rol_id)),e.xp6(2),e.Q6J("ngIf",o.permisoActualizar),e.xp6(2),e.Q6J("ngIf",o.permisoEliminar)}}function D(r,l){if(1&r&&e._UZ(0,"input",56),2&r){const t=e.oxw();e.Q6J("value",t.userData.id)}}function E(r,l){if(1&r&&e._UZ(0,"input",57),2&r){const t=e.oxw();e.s9C("placeholder",t.userData.usuario)}}function Y(r,l){if(1&r&&e._UZ(0,"input",58),2&r){const t=e.oxw();e.s9C("placeholder",t.userData.email)}}const R=function(){return{"min-width":"50rem"}},B=function(){return["nombre","medida","precio","cantidad","inventario","acciones"]},F=function(){return{width:"50vw"}},M=function(){return{width:"500px"}};let Q=(()=>{class r{constructor(t,o,i,a,u,ee,te,ie,se){this.confirmationService=t,this.spinner=o,this.toastModule=i,this.dialogModule=a,this.messageService=u,this.usersService=ee,this.breadcrumbService=te,this.tableModule=ie,this.buttonModule=se,this.permisoCrear=c.e.hasPermission(["administracion.usuario.crear"]),this.permisoActualizar=c.e.hasPermission(["administracion.usuario.actualizar"]),this.permisoEliminar=c.e.hasPermission(["administracion.usuario.eliminar"]),this.visible=!1,this.visibleDialog1=!1,this.selectedState=null,this.selectedUserIndex=-1,this.pageCount=10,this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1,this.loadingTable=!1,this.first=0,this.rows=8,this.formSearch=new s.cw({search:new s.NI("",[])}),this.formNuser=new s.cw({usuario:new s.NI("",s.kI.required),email:new s.NI("",[s.kI.required,s.kI.email]),rol_id:new s.NI("",s.kI.required),superadmin:new s.NI("",s.kI.required),password:new s.NI("",s.kI.required)}),this.formEuser=new s.cw({usuario:new s.NI("",s.kI.required),email:new s.NI("",[s.kI.required,s.kI.email]),rol_id:new s.NI("",s.kI.required),superadmin:new s.NI("",s.kI.required),id:new s.NI("",s.kI.required)})}ngOnInit(){this.getIndex(),this.usersService.data.subscribe(t=>{this.users=t,console.log(this.users)}),this.breadcrumbService.currentBreadcrumbs.subscribe(t=>this.breadcrumbs=t)}onQuitItem(t){this.breadcrumbService.quitItem(t)}getIndex(t="",o=this.pageCount,i=1){this.spinner.show(),this.loadingTable=!0,this.usersService.getAll(o,t,i).subscribe(a=>{this.loadingTable=!1,this.users=a.data,this.ultimaPage=a.last_page,this.totalUsers=a.total,this.ultimaPage=a.last_page,a.total>o&&(this.disablePageRight=!0),this.validatePage(),this.spinner.hide()},a=>{console.log("Error: ",a)})}getAUser(t){this.usersService.getById(t).subscribe(o=>{this.userData=o,this.userData.id=t,console.log(this.userData),this.visibleDialog1=!0})}getRolName(t){return 1===t?"Super Administrador":2===t?"Administrador":3===t?"Gestor":"Rol no identificado"}getStatusName(t){return 1===t?"Activo":0===t?"Inactivo":"Estado no identificado"}openNew(){this.visible=!0}newUser(){var t=this;return(0,A.Z)(function*(){t.usersService.insertData(t.formNuser.value).subscribe(i=>{console.log(i),t.messageService.add({severity:"info",summary:"Confirmaci\xf3n Exitosa",detail:"Usuario creado.",sticky:!0,life:200}),t.visible=!1,t.usersService.refreshUsersData()},i=>{console.log("Error:",i)})})()}updateUser(){this.formEuser.get("id").setValue(this.userData.id),this.usersService.updateUser(this.formEuser.value).subscribe(o=>{this.visibleDialog1=!1,this.messageService.add({severity:"info",summary:"Confirmaci\xf3n Exitosa",detail:"Hotel actualizado.",sticky:!0,life:200}),this.usersService.refreshUsersData()},o=>{console.log("Error:",o)})}deleteUser(t){const o={headers:new Z.WM({"Content-Type":"application/x-www-form-urlencoded"}),body:`id=${t}`};this.usersService.deleteUser(o).subscribe(i=>{this.usersService.refreshUsersData(),console.log(i)},i=>{console.log("Error:",i)})}confirmDelete(t){console.log(t),U().fire({title:"\xbfEstas Seguro que deseas eliminar el usuario?",text:"Ten cuidado esta acci\xf3n no se prodr\xe1 reversar",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(o=>{o.isConfirmed&&(this.deleteUser(t),U().fire({title:"Confirmaci\xf3n",text:"El usuario ha sido eliminado.",icon:"success"}))})}searchInput(){let t=this.formSearch.get("search").value;""==t&&this.getIndex(t)}search(t){let o=this.formSearch.get("search").value;this.getIndex(o)}onPage(t){this.pageCount=t.rows,this.getIndex("",this.pageCount)}onPageChange(t){this.first=t.first,this.rows=t.rows}leftTable(){this.pageActual=this.pageActual-1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(p.YP),e.Y36(I.t2),e.Y36(m.EV),e.Y36(g.S),e.Y36(p.ez),e.Y36(T.f),e.Y36(w.p),e.Y36(f.U$),e.Y36(d.hJ))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],features:[e._Bn([p.YP,p.ez])],decls:95,vars:29,consts:[[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"pi","pi-users","mr-2"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Crear","class","p-button-outlined mr-2","icon","pi pi-user-plus",3,"click",4,"ngIf"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],["header","Nuevo Usuario",3,"visible","modal","draggable","resizable","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6"],["type","text","placeholder","Usuario","pInputText","","formControlName","usuario",1,"w-full","mb-3","border-round-3xl"],["id","email1","type","email","placeholder","Correo Electr\xf3nico","pInputText","","formControlName","email",1,"w-full","mb-3","border-round-3xl"],[1,"field","col-12","md:col-3"],["htmlFor","state"],["formControlName","rol_id",1,"w-full","mb-3","border-round-3xl","selects-main"],["value",""],["value","2"],["value","3    "],["formControlName","superadmin",1,"w-full","mb-3","border-round-3xl","selects-main"],["value","1"],["id","password","type","password","placeholder","Contrase\xf1a","pInputText","","formControlName","password",1,"w-full","mb-3","border-round-3xl"],[1,"field","col-12","md:col-12"],["pButton","","pRipple","","label","Crear Usuario","icon","pi pi-user","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],["id","editU","header","Editar Usuario","modal","modal",3,"visible","visibleChange","onVisibleChange"],["type","text","hidden","hidden","pInputText","","class","w-full mb-3 border-round-3xl","formControlName","id",3,"value",4,"ngIf"],["type","text","pInputText","","class","w-full mb-3 border-round-3xl","formControlName","usuario",3,"placeholder",4,"ngIf"],["id","email1","type","email","pInputText","","class","w-full mb-3 border-round-3xl","formControlName","email",3,"placeholder",4,"ngIf"],["value","3"],["pButton","","pRipple","","label","Editar Usuario","icon","pi pi-pencil","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],["pButton","","pRipple","","label","Crear","icon","pi pi-user-plus",1,"p-button-outlined","mr-2",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[1,"flex","gap-2"],["icon","pi pi-user-edit","severity","info",3,"click",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"click",4,"ngIf"],["icon","pi pi-user-edit","severity","info",3,"click"],["icon","pi pi-trash","severity","danger",3,"click"],["type","text","hidden","hidden","pInputText","","formControlName","id",1,"w-full","mb-3","border-round-3xl",3,"value"],["type","text","pInputText","","formControlName","usuario",1,"w-full","mb-3","border-round-3xl",3,"placeholder"],["id","email1","type","email","pInputText","","formControlName","email",1,"w-full","mb-3","border-round-3xl",3,"placeholder"]],template:function(o,i){1&o&&(e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"div",1)(3,"div")(4,"div",2),e._uU(5,"Usuarios"),e.qZA(),e.TgZ(6,"div",3)(7,"div",4),e._UZ(8,"i",5),e.TgZ(9,"span"),e._uU(10),e.qZA()()()(),e.TgZ(11,"div",6),e.YNc(12,N,1,0,"button",7),e.qZA()()(),e.TgZ(13,"div",8)(14,"div",9)(15,"div",10)(16,"p-table",11),e.NdJ("onPage",function(u){return i.onPage(u)}),e.YNc(17,S,8,1,"ng-template",12),e.YNc(18,y,11,0,"ng-template",13),e.YNc(19,P,13,6,"ng-template",14),e.qZA(),e._UZ(20,"br"),e.TgZ(21,"div",15)(22,"span",16)(23,"button",17),e.NdJ("click",function(){return i.leftTable()}),e.qZA(),e._UZ(24,"button",18),e.TgZ(25,"button",19),e.NdJ("click",function(){return i.rightTable()}),e.qZA()()()()()(),e.TgZ(26,"p-dialog",20),e.NdJ("visibleChange",function(u){return i.visible=u}),e.TgZ(27,"div",9)(28,"form",21),e.NdJ("ngSubmit",function(){return i.newUser()}),e.TgZ(29,"div",22)(30,"div",23)(31,"label"),e._uU(32,"Usuario"),e.qZA(),e._UZ(33,"input",24),e.qZA(),e.TgZ(34,"div",23)(35,"label"),e._uU(36,"Email"),e.qZA(),e._UZ(37,"input",25),e.qZA(),e.TgZ(38,"div",26)(39,"label",27),e._uU(40,"Rol"),e.qZA(),e.TgZ(41,"select",28)(42,"option",29),e._uU(43,"Seleccione una opci\xf3n"),e.qZA(),e.TgZ(44,"option",30),e._uU(45,"Administrador"),e.qZA(),e.TgZ(46,"option",31),e._uU(47,"Gestor"),e.qZA()()(),e.TgZ(48,"div",26)(49,"label",27),e._uU(50,"Super Admin"),e.qZA(),e.TgZ(51,"select",32)(52,"option",29),e._uU(53,"Seleccione una opci\xf3n"),e.qZA(),e.TgZ(54,"option",33),e._uU(55,"Si"),e.qZA(),e.TgZ(56,"option",30),e._uU(57,"No"),e.qZA()()(),e.TgZ(58,"div",23)(59,"label"),e._uU(60,"Contrase\xf1a"),e.qZA(),e._UZ(61,"input",34),e.qZA(),e.TgZ(62,"div",35),e._UZ(63,"button",36),e.qZA()()()()(),e.TgZ(64,"p-dialog",37),e.NdJ("visibleChange",function(u){return i.visibleDialog1=u})("onVisibleChange",function(){return i.visibleDialog1=!i.visibleDialog1}),e.TgZ(65,"form",21),e.NdJ("ngSubmit",function(){return i.updateUser()}),e.TgZ(66,"div",22)(67,"div",35),e.YNc(68,D,1,1,"input",38),e.qZA(),e.TgZ(69,"div",23)(70,"label"),e._uU(71,"Usuario"),e.qZA(),e.YNc(72,E,1,1,"input",39),e.qZA(),e.TgZ(73,"div",23)(74,"label"),e._uU(75,"Email"),e.qZA(),e.YNc(76,Y,1,1,"input",40),e.qZA(),e.TgZ(77,"div",23)(78,"label",27),e._uU(79,"Rol"),e.qZA(),e.TgZ(80,"select",28)(81,"option",30),e._uU(82,"Administrador"),e.qZA(),e.TgZ(83,"option",41),e._uU(84,"Gestor"),e.qZA()()(),e.TgZ(85,"div",23)(86,"label",27),e._uU(87,"Super Admin"),e.qZA(),e.TgZ(88,"select",32)(89,"option",33),e._uU(90,"Si"),e.qZA(),e.TgZ(91,"option",30),e._uU(92,"No"),e.qZA()()(),e.TgZ(93,"div",35),e._UZ(94,"button",42),e.qZA()()()()),2&o&&(e.xp6(10),e.hij("",i.totalUsers," Usuarios Creados"),e.xp6(2),e.Q6J("ngIf",i.permisoCrear),e.xp6(4),e.Q6J("value",i.users)("tableStyle",e.DdM(25,R))("loading",i.loadingTable)("rows",8)("globalFilterFields",e.DdM(26,B))("rowHover",!0),e.xp6(7),e.Q6J("disabled",!i.disablePageLeft),e.xp6(1),e.Q6J("label",i.pageActual),e.xp6(1),e.Q6J("disabled",!i.disablePageRight),e.xp6(1),e.Akn(e.DdM(27,F)),e.Q6J("visible",i.visible)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(2),e.Q6J("formGroup",i.formNuser),e.xp6(36),e.Akn(e.DdM(28,M)),e.Q6J("visible",i.visibleDialog1),e.xp6(1),e.Q6J("formGroup",i.formEuser),e.xp6(3),e.Q6J("ngIf",i.visibleDialog1),e.xp6(4),e.Q6J("ngIf",i.visibleDialog1),e.xp6(4),e.Q6J("ngIf",i.visibleDialog1))},dependencies:[b.O5,f.iA,p.jx,d.Hq,d.zx,s._Y,s.YN,s.Kr,s.Fj,s.EJ,s.JJ,s.JL,x.H,m.FN,_.o,g.V,s.sg,s.u],encapsulation:2})}return r})();var k=n(2506);let G=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275mod=e.oAB({type:r});static#i=this.\u0275inj=e.cJS({imports:[v.Bz.forChild([{path:"",component:Q,canActivate:[k.a],data:{permissions:["administracion.usuario"]}}]),v.Bz]})}return r})();var z=n(6068),H=n(6340),j=n(6022),L=n(6218),V=n(2160),K=n(1865),O=n(354),$=n(8712),X=n(5722);let W=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275mod=e.oAB({type:r});static#i=this.\u0275inj=e.cJS({providers:[{provide:Z.TP,useClass:$.n,multi:!0},T.f],imports:[b.ez,G,f.U$,z.O,s.u5,d.hJ,x.T,m.EV,H.V,j.Xt,_.j,L.A,V.kW,K.cc,O.L$,g.S,X.ii.forRoot(),s.UX]})}return r})()}}]);