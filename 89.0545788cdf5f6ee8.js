"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[89],{1089:(_,h,i)=>{i.r(h),i.d(h,{InstallmentModule:()=>W});var g=i(177),o=i(4341),f=i(3386),F=i(5493),m=i(1141),b=i(563),j=i(9998),T=i(1830),y=i(4714),v=i(2242),E=i(1305),R=i(9883),P=i(494),A=i(981),k=i(1570),u=i(1626),$=i(635),G=i(4058),d=i(6554),B=i(6627),I=i(3091),D=i(8032),p=i.n(D),C=i(306),X=i(5989),t=i(540);let x=(()=>{class n{constructor(e){this.httpClient=e,this.baseUrl=C.T.url,this.endpointListar="/abonoListar",this.endpointDelete="/abonoEliminar"}getAll(e,s="",a=1){const l={headers:new u.Lr({"Content-Type":"application/json"})};return this.httpClient.post(`${this.baseUrl+this.endpointListar}?per_page=${e}&page=${a}&search=${s}`,l)}deleteInstallments(e){return this.httpClient.post(`${this.baseUrl+this.endpointDelete}`,e)}static{this.\u0275fac=function(s){return new(s||n)(t.KVO(u.Qq))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var N=i(92),U=i(7693),V=i(5779);function L(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",17),t.nrm(1,"h5",18),t.j41(2,"span",19)(3,"form",20)(4,"div",21)(5,"input",22),t.bIt("keyup.enter",function(a){t.eBV(e);const l=t.XpG();return t.Njj(l.buscarPorTecla(a))})("input",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.searchInput())}),t.k0s(),t.j41(6,"button",23),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.search())}),t.k0s()()()()()}if(2&n){const e=t.XpG();t.R7$(3),t.Y8G("formGroup",e.formSearch)}}function S(n,r){1&n&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Hotel"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Cliente"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Valor"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Metodo de pago"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Estado"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Acciones"),t.k0s()())}function Y(n,r){if(1&n){const e=t.RV6();t.j41(0,"p-button",28),t.bIt("click",function(){t.eBV(e);const a=t.XpG().$implicit,l=t.XpG();return t.Njj(l.confirmAbrirPdfAbono(a.id))}),t.k0s()}}function w(n,r){if(1&n){const e=t.RV6();t.j41(0,"p-button",29),t.bIt("click",function(){t.eBV(e);const a=t.XpG().$implicit,l=t.XpG();return t.Njj(l.confirmDelete(a.id))}),t.k0s()}}function J(n,r){1&n&&(t.j41(0,"p-button",30),t.EFF(1,"."),t.k0s())}function M(n,r){if(1&n&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td",24),t.DNE(12,Y,1,0,"p-button",25),t.nrm(13,"p-confirmDialog"),t.DNE(14,w,1,0,"p-button",26),t.DNE(15,J,2,0,"p-button",27),t.k0s()()),2&n){const e=r.$implicit,s=t.XpG();t.R7$(2),t.JRh(e.hotel.nombre),t.R7$(2),t.Lme("",e.cliente.nombres," ",e.cliente.apellidos,""),t.R7$(2),t.JRh(e.valor),t.R7$(2),t.JRh(e.metodo_pago.nombre),t.R7$(2),t.JRh(s.getEstado(e.estado)),t.R7$(2),t.Y8G("ngIf",0!=e.estado),t.R7$(2),t.Y8G("ngIf",1==e.estado&&s.permisoEliminar),t.R7$(1),t.Y8G("ngIf",0==e.estado)}}function O(n,r){1&n&&(t.j41(0,"tr")(1,"td",31),t.EFF(2,"Cargando informacion porfavor espere ..."),t.k0s()())}const H=function(){return{"min-width":"50rem"}},Z=function(){return["nombre","descripcion_secuencia","secuencia_incial","secuencia_actual","acciones"]};let K=(()=>{class n{constructor(e,s,a,l,c){this.installment=e,this.spinner=s,this.FB=a,this.appComponent=l,this.layoutService=c,this.permisoEliminar=X.u.hasPermission(["administracion.abono.eliminar"]),this.loadingTable=!1,this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1,this.first=0,this.rows=8,this.pageCount=10}ngOnInit(){this.buildForm(),this.getIndex(),this.baseUrl=C.T.url,this.token=this.appComponent.getToken()}buildForm(){this.formSearch=this.FB.group({search:["",[]]})}getEstado(e){switch(e){case 1:return"Activo";case 0:return"Anulado";case 2:return"Facturado";default:return"Desconocido"}}getIndex(e="",s=this.pageCount,a=1){this.spinner.show(),this.loadingTable=!0,this.installment.getAll(s,e,a).subscribe(l=>{this.loadingTable=!1,this.installmentData=l.data,this.ultimaPage=l.last_page,this.countRegisters=l.total,l.total>s&&(this.disablePageRight=!0),this.validatePage(),this.spinner.hide()},l=>{console.error("Error: ",l)})}confirmDelete(e){p().fire({title:"\xbfEstas seguro que deseas anular este abono?",text:"Ten cuidado esta acci\xf3n no se prodr\xe1 reversar",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&(this.spinner.show(),this.installment.deleteInstallments({id:e}).subscribe(a=>{this.spinner.hide(),"success"==a.code?(p().fire({title:"Exito",text:"Abono anulado exitosamente.",icon:"success"}),this.getIndex(),this.layoutService.reloadComponent()):"warning"==a.code?p().fire({title:"Advertencia",text:a.error,icon:"warning"}):p().fire({title:"Error",text:"Error al anular el abono.",icon:"error"})},a=>{console.log("Error: ",a)}))})}confirmAbrirPdfAbono(e){window.open(this.baseUrl+"/facturaAbonoPdf/"+e+"?token="+this.token,"_blank")}searchInput(){let e=this.formSearch.get("search").value;this.pageActual=1,""==e&&this.getIndex(e)}search(){let e=this.formSearch.get("search").value;this.getIndex(e)}onPage(e){this.pageCount=e.rows,this.getIndex("",this.pageCount)}onPageChange(e){this.first=e.first,this.rows=e.rows}leftTable(){this.pageActual=this.pageActual-1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}buscarPorTecla(e){"Enter"==e.code&&this.search()}static{this.\u0275fac=function(s){return new(s||n)(t.rXU(x),t.rXU(d.ex),t.rXU(o.ok),t.rXU(N.Z),t.rXU(U.Y))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-installment"]],decls:20,vars:11,consts:[["type","ball-scale-multiple","size","large","bdColor","rgba(192,192,192,0.8)","template","<img src='assets/loading/cargando.gif' />"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"keyup.enter","input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[1,"flex","gap-2"],["icon","pi pi-file-pdf","severity","info",3,"click",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"click",4,"ngIf"],["style","visibility: hidden;","disabled","",4,"ngIf"],["icon","pi pi-file-pdf","severity","info",3,"click"],["icon","pi pi-trash","severity","danger",3,"click"],["disabled","",2,"visibility","hidden"],["colspan","8"]],template:function(s,a){1&s&&(t.nrm(0,"ngx-spinner",0),t.j41(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),t.EFF(5,"Abonos"),t.k0s()()()(),t.j41(6,"div",4)(7,"div",5)(8,"div",6)(9,"p-table",7),t.bIt("onPage",function(c){return a.onPage(c)}),t.DNE(10,L,7,1,"ng-template",8),t.DNE(11,S,13,0,"ng-template",9),t.DNE(12,M,16,9,"ng-template",10),t.DNE(13,O,3,0,"ng-template",11),t.k0s(),t.nrm(14,"br"),t.j41(15,"div",12)(16,"span",13)(17,"button",14),t.bIt("click",function(){return a.leftTable()}),t.k0s(),t.nrm(18,"button",15),t.j41(19,"button",16),t.bIt("click",function(){return a.rightTable()}),t.k0s()()()()()()),2&s&&(t.R7$(9),t.Y8G("value",a.installmentData)("tableStyle",t.lJ4(9,H))("loading",a.loadingTable)("rows",8)("globalFilterFields",t.lJ4(10,Z))("rowHover",!0),t.R7$(8),t.Y8G("disabled",!a.disablePageLeft),t.R7$(1),t.Y8G("label",a.pageActual),t.R7$(1),t.Y8G("disabled",!a.disablePageRight))},dependencies:[g.bT,f.XI,V.Ei,m._f,m.$n,o.qT,o.me,o.BC,o.cb,b.n,v.S,o.j4,o.JD,d.et]})}}return n})();var z=i(1765);let Q=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[I.iI.forChild([{path:"",component:K,canActivate:[z.q],data:{permissions:["administracion.abono"]}}]),I.iI]})}}return n})(),W=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({providers:[{provide:u.a7,useClass:$.R,multi:!0},x],imports:[g.MD,Q,f.bG,F.e,o.YN,m.tm,b.Z,j.MB,T.m,y.wZ,v.u,E.f,R.kr,P.Ko,A.O3,k.P,G.RZ.forRoot(),o.X1,d.PO,B.I]})}}return n})()}}]);