"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[315],{6315:(k,d,i)=>{i.r(d),i.d(d,{InstallmentModule:()=>W});var h=i(6814),s=i(95),f=i(9664),Z=i(6068),m=i(707),v=i(4480),C=i(4104),I=i(6340),y=i(6022),b=i(3714),P=i(6218),U=i(2160),J=i(1865),F=i(354),E=i(7213),u=i(9862),N=i(8712),w=i(5722),g=i(8672),B=i(1712),x=i(86),Y=i(3519),p=i.n(Y),T=i(4444),_=i(2791),t=i(4946);let A=(()=>{class n{constructor(e){this.httpClient=e,this.baseUrl=T.D.url,this.endpointListar="/abonoListar",this.endpointDelete="/abonoEliminar"}getAll(e,a="",o=1){const l={headers:new u.WM({"Content-Type":"application/json"})};return this.httpClient.post(`${this.baseUrl+this.endpointListar}?per_page=${e}&page=${o}&search=${a}`,l)}deleteInstallments(e){return this.httpClient.post(`${this.baseUrl+this.endpointDelete}`,e)}static#t=this.\u0275fac=function(a){return new(a||n)(t.LFG(u.eN))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var R=i(6401),D=i(3859),L=i(5219);function M(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",17)(1,"h5",18),t._uU(2,"Lista de Abonos"),t.qZA(),t.TgZ(3,"span",19)(4,"form",20)(5,"div",21)(6,"input",22),t.NdJ("input",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.searchInput())}),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.search(o.dt))}),t.qZA()()()()()}if(2&n){const e=t.oxw();t.xp6(4),t.Q6J("formGroup",e.formSearch)}}function S(n,r){1&n&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Hotel"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Cliente"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Valor"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Metodo Pago"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Estado"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Acciones"),t.qZA()())}function $(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-button",28),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,l=t.oxw();return t.KtG(l.confirmAbrirPdfAbono(o.id))}),t.qZA()}}function H(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-button",29),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,l=t.oxw();return t.KtG(l.confirmDelete(o.id))}),t.qZA()}}function j(n,r){1&n&&(t.TgZ(0,"p-button",30),t._uU(1,"."),t.qZA())}function O(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td",24),t.YNc(12,$,1,0,"p-button",25),t._UZ(13,"p-confirmDialog"),t.YNc(14,H,1,0,"p-button",26),t.YNc(15,j,2,0,"p-button",27),t.qZA()()),2&n){const e=r.$implicit,a=t.oxw();t.xp6(2),t.Oqu(e.hotel.nombre),t.xp6(2),t.AsE("",e.cliente.nombres," ",e.cliente.apellidos,""),t.xp6(2),t.Oqu(e.valor),t.xp6(2),t.Oqu(e.metodo_pago.nombre),t.xp6(2),t.Oqu(a.getEstado(e.estado)),t.xp6(2),t.Q6J("ngIf",0!=e.estado),t.xp6(2),t.Q6J("ngIf",1==e.estado&&a.permisoEliminar),t.xp6(1),t.Q6J("ngIf",0==e.estado)}}function Q(n,r){1&n&&(t.TgZ(0,"tr")(1,"td",31),t._uU(2,"Cargando informacion porfavor espere ..."),t.qZA()())}const G=function(){return{"min-width":"50rem"}},z=function(){return["nombre","descripcion_secuencia","secuencia_incial","secuencia_actual","acciones"]};let K=(()=>{class n{constructor(e,a,o,l,c){this.installment=e,this.spinner=a,this.FB=o,this.appComponent=l,this.layoutService=c,this.permisoEliminar=_.e.hasPermission(["administracion.abono.eliminar"]),this.loadingTable=!1,this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1,this.first=0,this.rows=8,this.pageCount=10}ngOnInit(){this.buildForm(),this.getIndex(),this.baseUrl=T.D.url,this.token=this.appComponent.getToken()}buildForm(){this.formSearch=this.FB.group({search:["",[]]})}getEstado(e){switch(e){case 1:return"Activo";case 0:return"Anulado";case 2:return"Facturado";default:return"Desconocido"}}getIndex(e="",a=this.pageCount,o=1){this.spinner.show(),this.loadingTable=!0,this.installment.getAll(a,e,o).subscribe(l=>{this.loadingTable=!1,this.installmentData=l.data,this.ultimaPage=l.last_page,this.countRegisters=l.total,l.total>a&&(this.disablePageRight=!0),this.validatePage(),this.spinner.hide()},l=>{console.error("Error: ",l)})}confirmDelete(e){p().fire({title:"\xbfEstas seguro que deseas anular este abono?",text:"Ten cuidado esta acci\xf3n no se prodr\xe1 reversar",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(a=>{a.isConfirmed&&(this.spinner.show(),this.installment.deleteInstallments({id:e}).subscribe(o=>{this.spinner.hide(),"success"==o.code?(p().fire({title:"Exito",text:"Abono anulado exitosamente.",icon:"success"}),this.getIndex(),this.layoutService.reloadComponent()):"warning"==o.code?p().fire({title:"Advertencia",text:o.error,icon:"warning"}):p().fire({title:"Error",text:"Error al anular el abono.",icon:"error"})},o=>{console.log("Error: ",o)}))})}confirmAbrirPdfAbono(e){window.open(this.baseUrl+"/facturaAbonoPdf/"+e+"?token="+this.token,"_blank")}searchInput(){let e=this.formSearch.get("search").value;""==e&&this.getIndex(e)}search(e){let a=this.formSearch.get("search").value;this.getIndex(a)}onPage(e){this.pageCount=e.rows,this.getIndex("",this.pageCount)}onPageChange(e){this.first=e.first,this.rows=e.rows}leftTable(){this.pageActual=this.pageActual-1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}static#t=this.\u0275fac=function(a){return new(a||n)(t.Y36(A),t.Y36(g.t2),t.Y36(s.qu),t.Y36(R.y),t.Y36(D.P))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-installment"]],decls:20,vars:11,consts:[["type","ball-scale-multiple"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[1,"flex","gap-2"],["icon","pi pi-file-pdf","severity","info",3,"click",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"click",4,"ngIf"],["style","visibility: hidden;","disabled","",4,"ngIf"],["icon","pi pi-file-pdf","severity","info",3,"click"],["icon","pi pi-trash","severity","danger",3,"click"],["disabled","",2,"visibility","hidden"],["colspan","8"]],template:function(a,o){1&a&&(t._UZ(0,"ngx-spinner",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),t._uU(5,"Abonos"),t.qZA()()()(),t.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"p-table",7),t.NdJ("onPage",function(c){return o.onPage(c)}),t.YNc(10,M,8,1,"ng-template",8),t.YNc(11,S,13,0,"ng-template",9),t.YNc(12,O,16,9,"ng-template",10),t.YNc(13,Q,3,0,"ng-template",11),t.qZA(),t._UZ(14,"br"),t.TgZ(15,"div",12)(16,"span",13)(17,"button",14),t.NdJ("click",function(){return o.leftTable()}),t.qZA(),t._UZ(18,"button",15),t.TgZ(19,"button",16),t.NdJ("click",function(){return o.rightTable()}),t.qZA()()()()()()),2&a&&(t.xp6(9),t.Q6J("value",o.installmentData)("tableStyle",t.DdM(9,G))("loading",o.loadingTable)("rows",8)("globalFilterFields",t.DdM(10,z))("rowHover",!0),t.xp6(8),t.Q6J("disabled",!o.disablePageLeft),t.xp6(1),t.Q6J("label",o.pageActual),t.xp6(1),t.Q6J("disabled",!o.disablePageRight))},dependencies:[h.O5,f.iA,L.jx,m.Hq,m.zx,s._Y,s.Fj,s.JJ,s.JL,v.H,b.o,s.sg,s.u,g.Ro]})}return n})();var V=i(2506);let X=(()=>{class n{static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[x.Bz.forChild([{path:"",component:K,canActivate:[V.a],data:{permissions:["administracion.abono"]}}]),x.Bz]})}return n})(),W=(()=>{class n{static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({providers:[{provide:u.TP,useClass:N.n,multi:!0},A],imports:[h.ez,X,f.U$,Z.O,s.u5,m.hJ,v.T,C.EV,I.V,y.Xt,b.j,P.A,U.kW,J.cc,F.L$,E.S,w.ii.forRoot(),s.UX,g.ef,B.U]})}return n})()}}]);