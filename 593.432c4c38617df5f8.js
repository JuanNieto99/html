"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[593],{593:(I,j,o)=>{o.r(j),o.d(j,{WalletsModule:()=>Tt});var u=o(177),s=o(4341),m=o(3386),_=o(5493),p=o(1141),f=o(563),C=o(9998),k=o(1830),y=o(4714),v=o(2242),S=o(1305),D=o(9883),P=o(494),x=o(981),$=o(1570),B=o(1626),A=o(635),N=o(4058),g=o(3091),Y=o(8032),d=o.n(Y),t=o(540),b=o(6554),F=o(4370),T=o(5779),W=o(7927);function M(i,c){if(1&i){const e=t.RV6();t.j41(0,"div",37),t.nrm(1,"span"),t.j41(2,"span",38)(3,"form",39)(4,"div",40)(5,"input",41),t.bIt("keyup.enter",function(a){t.eBV(e);const r=t.XpG();return t.Njj(r.buscarPorTecla(a))})("input",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.searchInput())}),t.k0s(),t.j41(6,"button",42),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.search())}),t.k0s()()()()()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("formGroup",e.formSearch)}}function X(i,c){1&i&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Hotel"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Caja"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Base"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Tipo Caja"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Usuario"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Descripci\xf3n"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Acciones"),t.k0s()())}function U(i,c){if(1&i){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.nI1(7,"currencyFormat"),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s(),t.j41(10,"td"),t.EFF(11),t.k0s(),t.j41(12,"td"),t.EFF(13),t.k0s(),t.j41(14,"td",43)(15,"p-button",44),t.bIt("click",function(){const r=t.eBV(e).$implicit,n=t.XpG();return t.Njj(n.editWallet(r.id))}),t.k0s(),t.nrm(16,"p-confirmDialog"),t.j41(17,"p-button",45),t.bIt("click",function(){const r=t.eBV(e).$implicit,n=t.XpG();return t.Njj(n.confirmDelete(r.id))}),t.k0s()()()}if(2&i){const e=c.$implicit;t.R7$(2),t.JRh(e.hotel.nombre),t.R7$(2),t.JRh(e.nombre),t.R7$(2),t.JRh(t.bMT(7,6,e.base)),t.R7$(3),t.JRh(e.tipo_cajas.nombre),t.R7$(2),t.JRh(e.usuario.usuario),t.R7$(2),t.JRh(e.descripcion)}}function L(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function J(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function V(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function O(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function q(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function H(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function z(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function K(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function Z(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function Q(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function tt(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}function et(i,c){1&i&&(t.j41(0,"div",46),t.EFF(1,"Campo requerido"),t.k0s())}const at=function(){return{"min-width":"50rem"}},it=function(){return["nombre","descripcion_secuencia","secuencia_incial","secuencia_actual","acciones"]},G=function(){return{width:"95vw"}};let lt=(()=>{class i{constructor(e,l,a){this.FB=e,this.spinner=l,this.WalletService=a,this.loadingTable=!1,this.visibleModalWallet=!1,this.visibleModalWalletEditar=!1,this.idEditando=0,this.pageCount=10,this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1,this.first=0,this.rows=8}ngOnInit(){this.buildForm(),this.getIndex(),this.visibleModalWallet=!1}getIndex(e="",l=this.pageCount,a=1){this.spinner.show(),this.loadingTable=!0,this.WalletService.getAll(l,e,a).subscribe(r=>{this.loadingTable=!1,this.walletData=r.data,this.ultimaPage=r.last_page,this.countRegisters=r.total,this.ultimaPage=r.last_page,r.total>l&&(this.disablePageRight=!0),this.validatePage(),this.spinner.hide()},r=>{console.log("Error: ",r),this.spinner.hide()})}buildForm(){this.formSearch=this.FB.group({search:["",[]]}),this.formCreateWallet=this.FB.group({hotel_id:["",[s.k0.required]],nombre:["",[s.k0.required]],descripcion:["",[]],base:["",[s.k0.required]],tipo:["",[s.k0.required]],usuario_id:["",[s.k0.required]]}),this.formEditWallet=this.FB.group({hotel_id:["",[s.k0.required]],nombre:["",[s.k0.required]],descripcion:["",[]],base:["",[s.k0.required]],tipo:["",[s.k0.required]],usuario_id:["",[s.k0.required]]})}openModal(){this.onCreate()}onCreate(){this.formCreateWallet.reset(),this.WalletService.getWallet(0).subscribe(e=>{this.hotel=e.hotel,this.nombre=e.nombre,this.descripcion=e.descripcion,this.base=e.base,this.tipoCaja=e.tipo_caja,this.usuarios=e.usuario,this.visibleModalWallet=!0},e=>{console.log("Error: ",e)})}submitCreate(){this.formCreateWallet.valid?this.newWallet():this.formCreateWallet.markAllAsTouched()}newWallet(){this.visibleModalWallet=!0,this.spinner.show();let e=this.formCreateWallet.value;e.hotel_id=e.hotel_id.id,e.usuario_id=e.usuario_id.id,e.tipo=e.tipo.id,e.estado=1,this.WalletService.createWallet(e).subscribe(l=>{this.spinner.hide(),this.visibleModalWallet=!1,"success"==l.code?(d().fire({title:"Exito",text:"Caja creada exitosamente.",icon:"success"}),this.getIndex()):"warning"==l.code?d().fire({title:"Advertencia",text:l.error,icon:"warning"}):d().fire({title:"Error",text:"Error al crear la caja.",icon:"error"})},l=>{console.log("Error: ",l)})}submitUpdate(){this.formEditWallet.valid&&this.updateWallet()}editWallet(e){this.idEditando=e,this.spinner.show(),this.WalletService.getWallet(e).subscribe(l=>{this.spinner.hide();const a=l.caja;this.hotel=l.hotel,this.nombre=a.nombre,this.descripcion=a.descripcion,this.base=a.base,this.tipoCaja=l.tipo_caja,this.usuarios=l.usuario,this.formEditWallet.setValue({hotel_id:this.hotel,tipo:this.tipoCaja,nombre:this.nombre,base:this.base,usuario_id:a.usuario_id,descripcion:this.descripcion}),setTimeout(()=>{this.visibleModalWalletEditar=!0},1)},l=>{console.log("Error: ",l)})}updateWallet(){this.spinner.show();let e=this.formEditWallet.value;e.tipo=e.tipo.id,e.usuario_id=e.usuario_id.id,e.hotel_id=e.hotel_id.id,e.id=this.idEditando,e.estado=1,this.WalletService.updateWallet(e).subscribe(l=>{this.spinner.hide(),this.visibleModalWalletEditar=!1,"success"==l.code?(d().fire({title:"\xc9xito",text:"Caja actualizada exitosamente.",icon:"success"}),this.getIndex()):d().fire({title:"Error",text:"Error al actualizar la caja.",icon:"error"})},l=>{console.log("Error: ",l)})}confirmDelete(e){d().fire({title:"\xbfEstas seguro que deseas eliminar esta caja?",text:"Ten cuidado esta acci\xf3n no se prodr\xe1 reversar",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(l=>{l.isConfirmed&&(this.spinner.show(),this.WalletService.deleteWallet({id:e}).subscribe(a=>{this.spinner.hide(),"success"==a.code?(d().fire({title:"Exito",text:"Caja eliminada exitosamente.",icon:"success"}),this.getIndex()):d().fire({title:"Error",text:"Error al eliminar la caja.",icon:"error"})},a=>{console.log("Error: ",a)}))})}searchInput(){let e=this.formSearch.get("search").value;this.pageActual=1,""==e&&this.getIndex(e)}search(){let e=this.formSearch.get("search").value;this.getIndex(e)}onPage(e){this.pageCount=e.rows,this.getIndex("",this.pageCount)}onPageChange(e){this.first=e.first,this.rows=e.rows}leftTable(){this.pageActual=this.pageActual-1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}buscarPorTecla(e){"Enter"==e.code&&this.search()}static{this.\u0275fac=function(l){return new(l||i)(t.rXU(s.ok),t.rXU(b.ex),t.rXU(F.F))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-permisssions"]],decls:96,vars:47,consts:[["type","ball-scale-multiple","size","large","bdColor","rgba(192,192,192,0.8)","template","<img src='assets/loading/cargando.gif' />"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Crear","icon","",1,"p-button-outlined","mr-2",3,"click"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],["header","Crear una Caja",3,"visible","modal","draggable","resizable","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-8"],["type","text","pInputText","","formControlName","nombre",1,"w-full","mb-3","border-round-3xl"],["style","color: red;",4,"ngIf"],[1,"field","col-12","md:col-4"],["formControlName","base","currency","COP","min","1","locale","es-CO","minFractionDigits","0","maxFractionDigits","0"],[1,"field","col-12","md:col-6"],["optionLabel","nombre","formControlName","hotel_id",3,"options"],["optionLabel","nombre","formControlName","tipo",3,"options"],["optionLabel","usuario","formControlName","usuario_id",3,"options"],["type","text","pInputText","","formControlName","descripcion",1,"w-full","mb-3","border-round-3xl"],[1,"field","col-12","md:col-12"],["pButton","","pRipple","","label","Crear Caja","icon","","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"disabled"],["header","Editar Caja",3,"visible","modal","draggable","resizable","visibleChange"],["pButton","","pRipple","","label","Editar Caja","icon","","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"disabled"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"keyup.enter","input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","info",3,"click"],["icon","pi pi-trash","severity","danger",3,"click"],[2,"color","red"]],template:function(l,a){1&l&&(t.nrm(0,"ngx-spinner",0),t.j41(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),t.EFF(5,"Cajas"),t.k0s(),t.j41(6,"div",4),t.nrm(7,"div",5),t.k0s()(),t.j41(8,"div",6)(9,"button",7),t.bIt("click",function(){return a.openModal()}),t.k0s()()()(),t.j41(10,"div",8)(11,"div",9)(12,"div",10)(13,"p-table",11),t.bIt("onPage",function(n){return a.onPage(n)}),t.DNE(14,M,7,1,"ng-template",12),t.DNE(15,X,15,0,"ng-template",13),t.DNE(16,U,18,8,"ng-template",14),t.k0s(),t.nrm(17,"br"),t.j41(18,"div",15)(19,"span",16)(20,"button",17),t.bIt("click",function(){return a.leftTable()}),t.k0s(),t.nrm(21,"button",18),t.j41(22,"button",19),t.bIt("click",function(){return a.rightTable()}),t.k0s()()()()()(),t.j41(23,"p-dialog",20),t.bIt("visibleChange",function(n){return a.visibleModalWallet=n}),t.j41(24,"div",9)(25,"form",21),t.bIt("ngSubmit",function(){return a.submitCreate()}),t.j41(26,"div",22)(27,"div",23)(28,"label"),t.EFF(29,"Nombre"),t.k0s(),t.nrm(30,"input",24),t.DNE(31,L,2,0,"div",25),t.k0s(),t.j41(32,"div",26)(33,"label"),t.EFF(34,"Base"),t.k0s(),t.nrm(35,"p-inputNumber",27),t.DNE(36,J,2,0,"div",25),t.k0s(),t.j41(37,"div",28)(38,"label"),t.EFF(39,"Hotel"),t.k0s(),t.nrm(40,"p-dropdown",29),t.DNE(41,V,2,0,"div",25),t.k0s(),t.j41(42,"div",28)(43,"label"),t.EFF(44,"Tipo de Caja"),t.k0s(),t.nrm(45,"p-dropdown",30),t.DNE(46,O,2,0,"div",25),t.k0s(),t.j41(47,"div",28)(48,"label"),t.EFF(49,"Usuario"),t.k0s(),t.nrm(50,"p-dropdown",31),t.DNE(51,q,2,0,"div",25),t.k0s(),t.j41(52,"div",28)(53,"label"),t.EFF(54,"Descripci\xf3n"),t.k0s(),t.nrm(55,"input",32),t.DNE(56,H,2,0,"div",25),t.k0s(),t.j41(57,"div",33),t.nrm(58,"button",34),t.k0s()()()()(),t.j41(59,"p-dialog",35),t.bIt("visibleChange",function(n){return a.visibleModalWalletEditar=n}),t.j41(60,"div",9)(61,"form",21),t.bIt("ngSubmit",function(){return a.submitUpdate()}),t.j41(62,"div",22)(63,"div",23)(64,"label"),t.EFF(65,"Nombre"),t.k0s(),t.nrm(66,"input",24),t.DNE(67,z,2,0,"div",25),t.k0s(),t.j41(68,"div",26)(69,"label"),t.EFF(70,"Base"),t.k0s(),t.nrm(71,"p-inputNumber",27),t.DNE(72,K,2,0,"div",25),t.k0s(),t.j41(73,"div",28)(74,"label"),t.EFF(75,"Hotel"),t.k0s(),t.nrm(76,"p-dropdown",29),t.DNE(77,Z,2,0,"div",25),t.k0s(),t.j41(78,"div",28)(79,"label"),t.EFF(80,"Tipo de Caja"),t.k0s(),t.nrm(81,"p-dropdown",30),t.DNE(82,Q,2,0,"div",25),t.k0s(),t.j41(83,"div",28)(84,"label"),t.EFF(85,"Usuario"),t.k0s(),t.nrm(86,"p-dropdown",31),t.DNE(87,tt,2,0,"div",25),t.k0s(),t.j41(88,"div",28)(89,"label"),t.EFF(90,"Descripci\xf3n"),t.k0s(),t.nrm(91,"input",32),t.DNE(92,et,2,0,"div",25),t.k0s(),t.j41(93,"div",33),t.nrm(94,"button",36),t.k0s()(),t.nrm(95,"br"),t.k0s()()()),2&l&&(t.R7$(13),t.Y8G("value",a.walletData)("tableStyle",t.lJ4(43,at))("loading",a.loadingTable)("rows",8)("globalFilterFields",t.lJ4(44,it))("rowHover",!0),t.R7$(7),t.Y8G("disabled",!a.disablePageLeft),t.R7$(1),t.Y8G("label",a.pageActual),t.R7$(1),t.Y8G("disabled",!a.disablePageRight),t.R7$(1),t.Aen(t.lJ4(45,G)),t.Y8G("visible",a.visibleModalWallet)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(2),t.Y8G("formGroup",a.formCreateWallet),t.R7$(6),t.Y8G("ngIf",a.formCreateWallet.get("nombre").hasError("required")),t.R7$(5),t.Y8G("ngIf",a.formCreateWallet.get("base").hasError("required")),t.R7$(4),t.Y8G("options",a.hotel),t.R7$(1),t.Y8G("ngIf",a.formCreateWallet.get("hotel_id").hasError("required")),t.R7$(4),t.Y8G("options",a.tipoCaja),t.R7$(1),t.Y8G("ngIf",a.formCreateWallet.get("tipo").hasError("required")),t.R7$(4),t.Y8G("options",a.usuarios),t.R7$(1),t.Y8G("ngIf",a.formCreateWallet.get("usuario_id").hasError("required")),t.R7$(5),t.Y8G("ngIf",a.formCreateWallet.get("descripcion").hasError("required")),t.R7$(2),t.Y8G("disabled",a.formCreateWallet.invalid),t.R7$(1),t.Aen(t.lJ4(46,G)),t.Y8G("visible",a.visibleModalWalletEditar)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(2),t.Y8G("formGroup",a.formEditWallet),t.R7$(6),t.Y8G("ngIf",a.formEditWallet.get("nombre").hasError("required")),t.R7$(5),t.Y8G("ngIf",a.formEditWallet.get("base").hasError("required")),t.R7$(4),t.Y8G("options",a.hotel),t.R7$(1),t.Y8G("ngIf",a.formEditWallet.get("hotel_id").hasError("required")),t.R7$(4),t.Y8G("options",a.tipoCaja),t.R7$(1),t.Y8G("ngIf",a.formEditWallet.get("tipo").hasError("required")),t.R7$(4),t.Y8G("options",a.usuarios),t.R7$(1),t.Y8G("ngIf",a.formEditWallet.get("usuario_id").hasError("required")),t.R7$(5),t.Y8G("ngIf",a.formEditWallet.get("descripcion").hasError("required")),t.R7$(2),t.Y8G("disabled",a.formEditWallet.invalid))},dependencies:[u.bT,m.XI,T.Ei,p._f,p.$n,s.qT,s.me,s.BC,s.cb,f.n,v.S,D.ms,x.YI,$.l,b.et,s.j4,s.JD,W.l],encapsulation:2})}}return i})();var R=o(7693);let rt=(()=>{class i{constructor(e,l,a,r,n,h,w){this.router=e,this.route=l,this.FB=a,this.datePipe=r,this.spinner=n,this.walletService=h,this.layoutService=w}ngOnInit(){this.spinner.hide(),this.usuarioId=parseInt(this.route.snapshot.paramMap.get("id")),this.buildForm(),this.getDataAbrirCaja()}buildForm(){this.hoy=this.datePipe.transform(new Date,"yyyy-MM-dd"),this.form=this.FB.group({base:[this.dataCaja?.base,[s.k0.required]],fecha:[this.hoy,[s.k0.required]],usuario:[this.dataCaja?.usuario.usuario,[s.k0.required]],nombreCaja:[this.dataCaja?.nombre,[s.k0.required]]}),this.form.disable()}abrirCaja(){this.walletService.abrirCaja({usuario_id:this.dataCaja?.usuario.id,caja_id:this.dataCaja?.id,saldo_base:this.dataCaja?.base}).subscribe(l=>{this.spinner.hide();let a=l;"success"==a.code?(this.layoutService.reloadComponent(),d().fire({title:"Exito",text:"Caja Abierta exitosamente.",icon:"success"}),this.router.navigate(["dashboard/admin/wallets/detail"])):"warning"==a.code?d().fire({title:"Advertencia",text:a.error,icon:"warning"}):d().fire({title:"Error",text:"Error al abrir caja.",icon:"error"})})}getDataAbrirCaja(){this.walletService.getAbrirCaja(this.usuarioId).subscribe(e=>{this.dataCaja=e.caja,this.buildForm()})}static{this.\u0275fac=function(l){return new(l||i)(t.rXU(g.Ix),t.rXU(g.nX),t.rXU(s.ok),t.rXU(u.vh),t.rXU(b.ex),t.rXU(F.F),t.rXU(R.Y))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-details-wallets"]],decls:28,vars:2,consts:[["type","ball-scale-multiple","size","large","bdColor","rgba(192,192,192,0.8)","template","<img src='assets/loading/cargando.gif' />"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-center","flex-column","lg:flex-row"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",1,"p-button-outlined","mr-4",3,"routerLink"],[1,"font-medium","text-3xl","text-900"],[1,"card","mt-3"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-4"],["type","text","pInputText","","formControlName","nombreCaja",1,"w-full","mb-3","border-round-3xl"],["type","text","pInputText","","formControlName","usuario",1,"w-full","mb-3","border-round-3xl"],["formControlName","base","currency","COP","min","1","locale","es-CO","minFractionDigits","0","maxFractionDigits","0"],[1,"field","col-12","md:col-6"],["type","text","pInputText","","formControlName","fecha",1,"w-full","mb-3","border-round-3xl"],[1,"field","col-12","md:col-12"],["pButton","","pRipple","","label","Abrir Caja","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"]],template:function(l,a){1&l&&(t.nrm(0,"ngx-spinner",0),t.j41(1,"div",1)(2,"div",2),t.nrm(3,"button",3),t.j41(4,"div",4),t.EFF(5,"Configurar caja"),t.k0s()()(),t.j41(6,"div",5)(7,"p-toolbar")(8,"form",6),t.bIt("ngSubmit",function(){return a.abrirCaja()}),t.j41(9,"div",7)(10,"div",8)(11,"label"),t.EFF(12,"Nombre caja abrir"),t.k0s(),t.nrm(13,"input",9),t.k0s(),t.j41(14,"div",8)(15,"label"),t.EFF(16,"Usuario"),t.k0s(),t.nrm(17,"input",10),t.k0s(),t.j41(18,"div",8)(19,"label"),t.EFF(20,"Base"),t.k0s(),t.nrm(21,"p-inputNumber",11),t.k0s(),t.j41(22,"div",12)(23,"label"),t.EFF(24,"Fecha apertura"),t.k0s(),t.nrm(25,"input",13),t.k0s(),t.j41(26,"div",14),t.nrm(27,"button",15),t.k0s()()()()()),2&l&&(t.R7$(3),t.Y8G("routerLink","/dashboard/admin/wallets/detail"),t.R7$(5),t.Y8G("formGroup",a.form))},dependencies:[g.Wk,p._f,s.qT,s.me,s.BC,s.cb,f.n,k.M,v.S,x.YI,b.et,s.j4,s.JD]})}}return i})();function st(i,c){if(1&i){const e=t.RV6();t.j41(0,"div",18),t.nrm(1,"h5",19),t.j41(2,"span",20)(3,"form",21)(4,"div",22)(5,"input",23),t.bIt("input",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.searchInput())})("keyup.enter",function(a){t.eBV(e);const r=t.XpG();return t.Njj(r.buscarPorTecla(a))})("input",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.searchInput())}),t.k0s(),t.j41(6,"button",24),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.search())}),t.k0s()()()()()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("formGroup",e.formSearch)}}function ot(i,c){1&i&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Nombre de caja"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Saldo inicial"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Saldo final"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Diferencia"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Tipo"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Descripci\xf3n"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Estado"),t.k0s(),t.j41(15,"th"),t.EFF(16,"Acciones"),t.k0s()())}function nt(i,c){1&i&&(t.j41(0,"td"),t.EFF(1),t.k0s()),2&i&&(t.R7$(1),t.JRh("Abierta"))}function ct(i,c){1&i&&(t.j41(0,"td"),t.EFF(1),t.k0s()),2&i&&(t.R7$(1),t.JRh("Cerrada"))}function dt(i,c){1&i&&(t.j41(0,"td"),t.EFF(1),t.k0s()),2&i&&(t.R7$(1),t.JRh("Anulada"))}function pt(i,c){if(1&i){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"currencyFormat"),t.k0s(),t.j41(6,"td"),t.EFF(7),t.nI1(8,"currencyFormat"),t.nI1(9,"currencyFormat"),t.k0s(),t.j41(10,"td"),t.EFF(11),t.nI1(12,"currencyFormat"),t.nI1(13,"currencyFormat"),t.k0s(),t.j41(14,"td"),t.EFF(15),t.k0s(),t.j41(16,"td"),t.EFF(17),t.k0s(),t.DNE(18,nt,2,1,"td",25),t.DNE(19,ct,2,1,"td",25),t.DNE(20,dt,2,1,"td",25),t.j41(21,"td",26)(22,"p-button",27),t.bIt("click",function(){const r=t.eBV(e).$implicit,n=t.XpG();return t.Njj(n.verDetalleCaja(r))}),t.k0s(),t.j41(23,"p-button",28),t.bIt("click",function(){const r=t.eBV(e).$implicit,n=t.XpG();return t.Njj(n.confirmDelete(r.id))}),t.k0s()()()}if(2&i){const e=c.$implicit;t.R7$(2),t.JRh(e.caja.nombre),t.R7$(2),t.SpI("$ ",t.bMT(5,9,e.abrir_saldo),""),t.R7$(3),t.SpI("$ ",e.cierre_saldo?t.bMT(8,11,e.cierre_saldo):t.bMT(9,13,0),""),t.R7$(4),t.SpI("$ ",e.diferencia?t.bMT(12,15,e.diferencia):t.bMT(13,17,0),""),t.R7$(4),t.SpI(" ",e.caja.tipo_cajas.nombre,""),t.R7$(2),t.SpI(" ",e.descripcion,""),t.R7$(1),t.Y8G("ngIf","1"==e.estado),t.R7$(1),t.Y8G("ngIf","2"==e.estado),t.R7$(1),t.Y8G("ngIf","0"==e.estado)}}const ut=function(){return{"min-width":"50rem"}},mt=function(){return["nombre","medida","precio","cantidad","inventario","acciones"]};let ht=(()=>{class i{constructor(e,l,a,r,n){this.walletService=e,this.spinner=l,this.router=a,this.FB=r,this.layoutService=n,this.loadingTable=!0,this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1,this.pageCount=30,this.items=[]}ngOnInit(){this.buildForm(),this.getIndex(),this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.usuario_id=this.currentUser.usuario.id,this.items=[{label:"Anular Caja",command:e=>this.opcionSelect(e,"anularCaja")},{label:"Cerrar Caja",command:e=>this.opcionSelect(e,"cerrarCaja")}]}buildForm(){this.formSearch=this.FB.group({search:["",[]]})}leftTable(){}search(){let e=this.formSearch.get("search").value;this.getIndex(e)}rightTable(){}onPage(e){}searchInput(){let e=this.formSearch.get("search").value;this.pageActual=1,""==e&&this.getIndex(e)}getIndex(e="",l=this.pageCount,a=1){this.spinner.show(),this.loadingTable=!0,this.walletService.getAllDetalleCaja(l,e,a).subscribe(r=>{this.loadingTable=!1,this.ultimaPage=r.last_page,this.detailWallets=r.data,r.total>l&&(this.disablePageRight=!0),this.spinner.hide()},r=>{console.log("Error: ",r),this.spinner.hide()})}opcionSelect(e,l){}confirmDelete(e){d().fire({title:"\xbfSeguro Deseas Anular?",text:"",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(l=>{l.isConfirmed&&this.sendAnularCaja(e)})}sendAnularCaja(e){let l={id:e};this.spinner.show(),this.walletService.anularCaja(l).subscribe(a=>{this.spinner.hide();let r=a;"success"==r.code?(this.layoutService.reloadComponent(),d().fire({title:"Exito",text:"Caja Anulada Exitosamente.",icon:"success"}),this.getIndex()):"warning"==r.code?d().fire({title:"Advertencia",text:r.error,icon:"warning"}):d().fire({title:"Error",text:"Error Al Anular.",icon:"error"})})}abrirCaja(){this.validarCajaByUsuario()}validarCajaByUsuario(){this.walletService.validarCajaAbiertaByUsuario(this.usuario_id).subscribe(e=>{e.usuario_tiene_caja?d().fire({title:"Advertencia",text:e.msm,icon:"warning"}):this.router.navigate(["dashboard/admin/wallets/"+this.usuario_id+"/abrirCaja"])})}generarPdf(){}verDetalleCaja(e){this.router.navigate(["dashboard/admin/wallets/"+e.id+"/showDetail"])}buscarPorTecla(e){"Enter"==e.code&&this.search()}static{this.\u0275fac=function(l){return new(l||i)(t.rXU(F.F),t.rXU(b.ex),t.rXU(g.Ix),t.rXU(s.ok),t.rXU(R.Y))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-details-wallets-list"]],decls:21,vars:11,consts:[[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Abrir Caja",1,"p-button-outlined","mr-2",3,"click"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"input","keyup.enter"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[4,"ngIf"],[1,"flex","gap-2"],["label","Ver","severity","danger",3,"click"],["icon","pi pi-trash","severity","danger",3,"click"]],template:function(l,a){1&l&&(t.j41(0,"div",0)(1,"div",1)(2,"div")(3,"div",2),t.EFF(4,"Abrir y cerrar cajas"),t.k0s(),t.nrm(5,"div",3),t.k0s(),t.j41(6,"div",4)(7,"button",5),t.bIt("click",function(){return a.abrirCaja()}),t.k0s()()()(),t.j41(8,"div",6)(9,"div",7)(10,"div",8)(11,"p-table",9),t.bIt("onPage",function(n){return a.onPage(n)}),t.DNE(12,st,7,1,"ng-template",10),t.DNE(13,ot,17,0,"ng-template",11),t.DNE(14,pt,24,19,"ng-template",12),t.k0s(),t.nrm(15,"br"),t.j41(16,"div",13)(17,"span",14)(18,"button",15),t.bIt("click",function(){return a.leftTable()}),t.k0s(),t.nrm(19,"button",16),t.j41(20,"button",17),t.bIt("click",function(){return a.rightTable()}),t.k0s()()()()()()),2&l&&(t.R7$(11),t.Y8G("value",a.detailWallets)("tableStyle",t.lJ4(9,ut))("loading",a.loadingTable)("rows",8)("globalFilterFields",t.lJ4(10,mt))("rowHover",!0),t.R7$(7),t.Y8G("disabled",!a.disablePageLeft),t.R7$(1),t.Y8G("label",a.pageActual),t.R7$(1),t.Y8G("disabled",!a.disablePageRight))},dependencies:[u.bT,m.XI,T.Ei,p._f,p.$n,s.qT,s.me,s.BC,s.cb,f.n,v.S,s.j4,s.JD,W.l]})}}return i})();var E=o(1765);function ft(i,c){if(1&i){const e=t.RV6();t.j41(0,"p-button",22),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.cerrarCaja())}),t.k0s()}}function gt(i,c){if(1&i){const e=t.RV6();t.j41(0,"div",23),t.nrm(1,"span"),t.j41(2,"span",24)(3,"form",25)(4,"div",26)(5,"input",27),t.bIt("keyup.enter",function(a){t.eBV(e);const r=t.XpG();return t.Njj(r.buscarPorTecla(a))})("input",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.searchInput())}),t.k0s(),t.j41(6,"button",28),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.search())}),t.k0s()()()()()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("formGroup",e.formSearch)}}function bt(i,c){1&i&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Concepto"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Valor"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Tipo"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Secuencia"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Fecha"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Operaci\xf3n"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Usuario"),t.k0s()())}function jt(i,c){if(1&i&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"currencyFormat"),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s(),t.j41(10,"td"),t.EFF(11),t.nI1(12,"date"),t.k0s(),t.j41(13,"td"),t.EFF(14),t.k0s(),t.j41(15,"td"),t.EFF(16),t.k0s()()),2&i){const e=c.$implicit;t.R7$(2),t.JRh(e.operacion.nombre),t.R7$(2),t.SpI("$ ",t.bMT(5,7,e.precio),""),t.R7$(3),t.JRh(1==e.tipo?"Ingreso":"Egreso"),t.R7$(2),t.JRh(e.secuencia),t.R7$(2),t.JRh(t.i5U(12,9,e.created_at,"dd/MM/yyyy HH:mm:ss")),t.R7$(3),t.JRh(e.operacion.nombre),t.R7$(2),t.JRh(e.usuario.usuario)}}const _t=function(){return{"min-width":"50rem"}},Ct=function(){return["nombre","medida","precio","cantidad","inventario","acciones"]};let vt=(()=>{class i{constructor(e,l,a,r,n,h){this.router=e,this.route=l,this.walletService=a,this.FB=r,this.spinner=n,this.layoutService=h,this.loadingTable=!0,this.estado="",this.caja_id=0,this.total=0,this.pageActualCajas=1,this.pageCountCajas=10,this.disablePageLeftCajas=!1,this.disablePageRightCajas=!1}ngOnInit(){this.detalle_id=parseInt(this.route.snapshot.paramMap.get("id")),this.buildForm(),this.getCajaDetail()}buildForm(){this.formSearch=this.FB.group({search:["",[]]}),this.form=this.FB.group({estado:[this.estado,[]],total:[this.total,[]]}),this.form.disable()}cerrarCaja(){d().fire({title:"Agrege una descripci\xf3n antes de cerrar la caja.",text:"",icon:"warning",showCancelButton:!0,confirmButtonText:"Cerrar",input:"text",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&this.sendCerrarCaja(this.detalle_id,this.caja_id,e.value)})}sendCerrarCaja(e,l,a){let r={caja_id:l,control_caja_id:e,justificacion:a};this.spinner.show(),this.walletService.cerrarCaja(r).subscribe(n=>{this.spinner.hide();let h=n;"success"==h.code?(d().fire({title:"Exito",text:"Caja Cerrada Exitosamente.",icon:"success"}),this.layoutService.reloadComponent(),this.router.navigate(["dashboard/admin/wallets/detail"])):"warning"==h.code?d().fire({title:"Advertencia",text:h.error,icon:"warning"}):d().fire({title:"Error",text:"Error Al Cerrar caja.",icon:"error"})})}getCajaDetail(e="",l=1,a=this.pageCountCajas){this.loadingTable=!0,this.walletService.getDetelleCaja(this.detalle_id,e,l,a).subscribe(n=>{if(n&&n.detalle_caja&&n.detalle_caja.data){this.detailWallets=n.detalle_caja.data,this.controlCaja=n.control_caja,this.total=0,this.detailWallets.forEach(w=>{this.total+=parseFloat(w.precio)}),this.caja_id=this.controlCaja?.caja_id;let h=this.controlCaja?.estado;1===h?this.estado="Abierta":2===h?this.estado="Cerrada":0===h&&(this.estado="Anulada"),this.pageActualCajas=n.detalle_caja.current_page,this.ultimaPageCajas=n.detalle_caja.last_page,this.validatePageCajas(),this.buildForm()}else this.detailWallets=[];this.loadingTable=!1},n=>{console.error(n),this.loadingTable=!1})}searchInput(){let e=this.formSearch.get("search").value;this.pageActualCajas=1,""==e&&this.getCajaDetail(e)}search(){let e=this.formSearch.get("search").value;this.getCajaDetail(e)}onPage(e){this.pageCountCajas=e.rows,this.getCajaDetail("",this.pageCountCajas)}buscarPorTecla(e){"Enter"==e.code&&this.search()}leftTableCajas(){this.pageActualCajas>1&&(this.pageActualCajas--,this.getCajaDetail("",this.pageActualCajas,this.pageCountCajas))}rightTableCajas(){this.pageActualCajas<this.ultimaPageCajas&&(this.pageActualCajas++,this.getCajaDetail("",this.pageActualCajas,this.pageCountCajas))}validatePageCajas(){this.disablePageLeftCajas=1!=this.pageActualCajas,this.disablePageRightCajas=!(this.pageActualCajas>=this.ultimaPageCajas)}static{this.\u0275fac=function(l){return new(l||i)(t.rXU(g.Ix),t.rXU(g.nX),t.rXU(F.F),t.rXU(s.ok),t.rXU(b.ex),t.rXU(R.Y))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-show-details-wallets"]],decls:34,vars:14,consts:[[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-center","flex-column","lg:flex-row"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",1,"p-button-outlined","mr-4",3,"routerLink"],[1,"font-medium","text-3xl","text-900"],[2,"width","100%",3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-3"],["type","text","formControlName","estado","pInputText","",1,"w-full","mb-3","border-round-3xl"],["type","text","formControlName","total","pInputText","",1,"w-full","mb-3","border-round-3xl"],["label","Cerrar Caja","icon","pi pi-dollar","severity","danger",3,"click",4,"ngIf"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],["label","Cerrar Caja","icon","pi pi-dollar","severity","danger",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"keyup.enter","input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"]],template:function(l,a){1&l&&(t.j41(0,"div",0)(1,"div",1)(2,"div"),t.nrm(3,"button",2),t.k0s(),t.j41(4,"div")(5,"div",3),t.EFF(6,"Detalle Caja"),t.k0s()()()(),t.j41(7,"p-toolbar")(8,"form",4)(9,"div",5)(10,"div",6)(11,"label"),t.EFF(12,"Estado"),t.k0s(),t.nrm(13,"input",7),t.k0s(),t.j41(14,"div",6)(15,"label"),t.EFF(16,"Total"),t.k0s(),t.nrm(17,"input",8),t.k0s(),t.nrm(18,"div",6),t.j41(19,"div",6),t.DNE(20,ft,1,0,"p-button",9),t.k0s()()()(),t.j41(21,"div",10)(22,"div",11)(23,"div",12)(24,"p-table",13),t.bIt("onPage",function(n){return a.onPage(n)}),t.DNE(25,gt,7,1,"ng-template",14),t.DNE(26,bt,15,0,"ng-template",15),t.DNE(27,jt,17,12,"ng-template",16),t.k0s(),t.nrm(28,"br"),t.j41(29,"div",17)(30,"span",18)(31,"button",19),t.bIt("click",function(){return a.leftTableCajas()}),t.k0s(),t.nrm(32,"button",20),t.j41(33,"button",21),t.bIt("click",function(){return a.rightTableCajas()}),t.k0s()()()()()()),2&l&&(t.R7$(3),t.Y8G("routerLink","/dashboard/admin/wallets/detail"),t.R7$(5),t.Y8G("formGroup",a.form),t.R7$(12),t.Y8G("ngIf",1==(null==a.controlCaja?null:a.controlCaja.estado)),t.R7$(4),t.Y8G("value",a.detailWallets)("tableStyle",t.lJ4(12,_t))("loading",a.loadingTable)("rows",8)("globalFilterFields",t.lJ4(13,Ct))("rowHover",!0),t.R7$(7),t.Y8G("disabled",!a.disablePageLeftCajas),t.R7$(1),t.Y8G("label",a.pageActualCajas),t.R7$(1),t.Y8G("disabled",!a.disablePageRightCajas))},dependencies:[u.bT,g.Wk,m.XI,T.Ei,p._f,p.$n,s.qT,s.me,s.BC,s.cb,f.n,k.M,v.S,s.j4,s.JD,u.vh,W.l]})}}return i})(),Ft=(()=>{class i{static{this.\u0275fac=function(l){return new(l||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[g.iI.forChild([{path:"",component:lt,canActivate:[E.q],data:{permissions:["gestionCajas"]}},{path:":id/abrirCaja",component:rt,canActivate:[E.q],data:{permissions:["gestionCajas.cajas.abrirCaja"]}},{path:"detail",component:ht,canActivate:[E.q],data:{permissions:["gestionCajas"]}},{path:":id/showDetail",component:vt,canActivate:[E.q],data:{permissions:["gestionCajas"]}}]),g.iI]})}}return i})();var kt=o(6627),Et=o(3192),xt=o(3887);let Tt=(()=>{class i{static{this.\u0275fac=function(l){return new(l||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({providers:[{provide:B.a7,useClass:A.R,multi:!0},Et.p,F.F,u.vh],imports:[u.MD,Ft,m.bG,_.e,s.YN,p.tm,f.Z,C.MB,k.m,y.wZ,v.u,S.f,D.kr,P.Ko,x.O3,$.P,N.RZ.forRoot(),b.PO,s.X1,b.PO,kt.I,xt.G]})}}return i})()},7927:(I,j,o)=>{o.d(j,{l:()=>s});var u=o(540);let s=(()=>{class m{transform(p){if(""===p)return"";const f=Number(p).toFixed(2),[C,k]=f.split(".");return C.replace(/\B(?=(\d{3})+(?!\d))/g,".")}static{this.\u0275fac=function(f){return new(f||m)}}static{this.\u0275pipe=u.EJ8({name:"currencyFormat",type:m,pure:!0})}}return m})()},3887:(I,j,o)=>{o.d(j,{G:()=>m});var u=o(177),s=o(540);let m=(()=>{class _{static{this.\u0275fac=function(C){return new(C||_)}}static{this.\u0275mod=s.$C({type:_})}static{this.\u0275inj=s.G2t({imports:[u.MD]})}}return _})()}}]);