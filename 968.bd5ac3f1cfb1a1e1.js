"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[968],{3968:(mt,w,r)=>{r.r(w),r.d(w,{RecipesModule:()=>ut});var p=r(6814),l=r(95),b=r(9664),Q=r(6068),m=r(707),h=r(4480),Y=r(4104),B=r(6340),G=r(6022),v=r(3714),R=r(6218),T=r(2160),F=r(1865),V=r(354),x=r(7213),C=r(9862),D=r(8712),O=r(5722),_=r(86),Z=r(2791),$=r(3519),d=r.n($),e=r(4946),H=r(4444);let I=(()=>{class n{constructor(t){this.httpClient=t,this.baseUrl=H.D.url,this.endpointListar="/recetaListar",this.endpointRecipesGet="/recetaEditar/",this.endpointRecipesUpdate="/recetaActualizar/",this.endpointRecipesCreate="/recetaCrear",this.endpointDelete="/recetaEliminar/",this.endpointProductsGet="/getRecetaProductos/",this.endpointProductsCreate="/agregarProductosReceta",this.endpointAllProductsGet="/getAllProductosByRecetas/",this.endpointTaxesGet="/getRecetaCrearImpuesto/",this.endpointTaxesByIdGet="/getImpuestoReceta/",this.endpointTaxesCreate="/agregarImpuestoReceta"}getAll(t,o="",i=1){const s={headers:new C.WM({"Content-Type":"application/json"})};return this.httpClient.post(`${this.baseUrl+this.endpointListar}?per_page=${t}&page=${i}&search=${o}`,s)}getRecipes(t){return this.httpClient.get(`${this.baseUrl+this.endpointRecipesGet+t}`)}createRecipes(t){return this.httpClient.post(`${this.baseUrl+this.endpointRecipesCreate}`,t)}updateRecipes(t){return this.httpClient.post(`${this.baseUrl+this.endpointRecipesUpdate}`,t)}deleteRecipes(t){return this.httpClient.post(`${this.baseUrl+this.endpointDelete}`,t)}getProducts(t){return this.httpClient.get(`${this.baseUrl+this.endpointProductsGet+t}`)}getProductsRecetas(t){return this.httpClient.get(`${this.baseUrl+this.endpointAllProductsGet+t}`)}createRecipesProducts(t){return this.httpClient.post(`${this.baseUrl+this.endpointProductsCreate}`,t)}getTaxes(t){return this.httpClient.get(`${this.baseUrl+this.endpointTaxesGet+t}`)}getRecipeTaxes(t){return this.httpClient.get(`${this.baseUrl+this.endpointTaxesByIdGet+t}`)}createTaxes(t){return this.httpClient.post(`${this.baseUrl+this.endpointTaxesCreate}`,t)}static#e=this.\u0275fac=function(o){return new(o||n)(e.LFG(C.eN))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var f=r(8672),g=r(5219);function L(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.openModal())}),e.qZA()}}function z(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",36)(1,"h5",37),e._uU(2,"Recetas"),e.qZA(),e.TgZ(3,"span",38)(4,"form",39)(5,"div",40)(6,"input",41),e.NdJ("input",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.searchInput())}),e.qZA(),e.TgZ(7,"button",42),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.search(i.dt))}),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("formGroup",t.formSearch)}}function j(n,a){1&n&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Hotel"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Precio"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Descripci\xf3n"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Acciones"),e.qZA()())}function K(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",47),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw();return e.KtG(s.editRecipes(i.id))}),e.qZA()}}function W(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",48),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw();return e.KtG(s.redirectToRecipesProducts(i.id))}),e.qZA()}}function X(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw();return e.KtG(s.confirmDelete(i.id))}),e.qZA()}}function ee(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td",43),e.YNc(11,K,1,0,"p-button",44),e.YNc(12,W,1,0,"p-button",45),e.YNc(13,X,1,0,"p-button",46),e.qZA()()),2&n){const t=a.$implicit,o=e.oxw();e.xp6(2),e.Oqu(t.hotel.nombre),e.xp6(2),e.hij("",t.nombre," "),e.xp6(2),e.Oqu(e.gM2(7,7,t.precio,"COP","","1.0-0")),e.xp6(3),e.Oqu(t.descripcion),e.xp6(2),e.Q6J("ngIf",o.permisoActualizar),e.xp6(1),e.Q6J("ngIf",o.permisoActualizar),e.xp6(1),e.Q6J("ngIf",o.permisoEliminar)}}function te(n,a){1&n&&(e.TgZ(0,"tr")(1,"td",50),e._uU(2,"Cargando informacion porfavor espere ..."),e.qZA()())}function ie(n,a){1&n&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function oe(n,a){1&n&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function ne(n,a){1&n&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function se(n,a){1&n&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function ae(n,a){1&n&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function re(n,a){1&n&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function le(n,a){1&n&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function ce(n,a){1&n&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}const pe=function(){return{"min-width":"50rem"}},de=function(){return["nombre","Hotel","acciones"]},A=function(){return{width:"50vw"}};let ue=(()=>{class n{constructor(t,o,i,s){this.recipesService=t,this.FB=o,this.spinner=i,this.router=s,this.permisoCrear=Z.e.hasPermission(["gestionInventario.recetas.crear"]),this.permisoActualizar=Z.e.hasPermission(["gestionInventario.recetas.actualizar"]),this.permisoEliminar=Z.e.hasPermission(["gestionInventario.recetas.eliminar"]),this.loadingTable=!1,this.visibleModalRecipes=!0,this.visibleModalRecipesEditar=!1,this.imagen=null,this.idEditando=0,this.pageCount=10,this.first=0,this.rows=8,this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1}ngOnInit(){this.buildForm(),this.getIndex(),this.visibleModalRecipes=!1}redirectToRecipesProducts(t){this.router.navigate(["/dashboard/admin/recipes/"+t+"/recipes-products"])}openModal(){this.onCreate()}onCreate(){this.formCreateRecipes.reset(),this.recipesService.getRecipes(0).subscribe(t=>{this.hotel=t.hotel,this.nombre=t.nombre,this.recipesDescripcion=t.descripcion,this.precio=t.precio,this.visibleModalRecipes=!0},t=>{console.log("Error: ",t)})}newRecipes(){this.spinner.show();let t=this.formCreateRecipes.value;console.log(t),t.hotel_id=t.hotel_id.id,t.estado=1,this.recipesService.createRecipes(t).subscribe(o=>{this.spinner.hide(),this.imagen=null,this.visibleModalRecipes=!1,"success"==o.code?(d().fire({title:"\xc9xito",text:"Receta creada exitosamente.",icon:"success"}),this.getIndex()):d().fire({title:"Error",text:"Error al crear la receta.",icon:"error"})},o=>{console.log("Error: ",o)})}submitCreate(){this.formCreateRecipes.valid?this.newRecipes():this.formCreateRecipes.markAllAsTouched()}editRecipes(t){this.idEditando=t,this.spinner.show(),this.recipesService.getRecipes(t).subscribe(o=>{console.log(o),this.spinner.hide(),this.hotel=o.hotel;const i=o.receta;i&&(this.nombre=i.nombre,this.recipesDescripcion=i.descripcion,this.precio=parseFloat(i.precio),this.formEditRecipes.setValue({hotel_id:this.hotel,precio:this.precio,descripcion:this.recipesDescripcion,nombre:this.nombre})),setTimeout(()=>{this.visibleModalRecipesEditar=!0},1)},o=>{console.log("Error: ",o)})}updateRecipe(){this.spinner.show();let t=this.formEditRecipes.value;t.hotel_id=t.hotel_id.id,t.nombre=t.nombre,t.descripcion=t.descripcion,t.precio=t.precio,t.id=this.idEditando,t.estado=1,console.log(t),this.recipesService.updateRecipes(t).subscribe(o=>{this.spinner.hide(),this.imagen=null,this.visibleModalRecipesEditar=!1,"success"==o.code?(d().fire({title:"\xc9xito",text:"Receta actualizado exitosamente.",icon:"success"}),this.getIndex()):d().fire({title:"Error",text:"Error al actualizar la receta.",icon:"error"})},o=>{console.log("Error: ",o)})}submitUpdate(){this.formEditRecipes.valid&&this.updateRecipe()}confirmDelete(t){d().fire({title:"\xbfEstas seguro que deseas eliminar esta receta?",text:"Ten cuidado esta acci\xf3n no se prodr\xe1 reversar",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(o=>{o.isConfirmed&&(this.spinner.show(),this.recipesService.deleteRecipes({id:t}).subscribe(i=>{this.spinner.hide(),"success"==i.code?(d().fire({title:"Exito",text:"Receta eliminada exitosamente.",icon:"success"}),this.getIndex()):d().fire({title:"Error",text:"Error al eliminar la receta.",icon:"error"})},i=>{console.log("Error: ",i)}))})}buildForm(){this.formSearch=this.FB.group({search:["",[]]}),this.formCreateRecipes=this.FB.group({hotel_id:["",[l.kI.required]],nombre:["",[l.kI.required]],precio:["",[l.kI.required]],descripcion:["",[l.kI.required]]}),this.formEditRecipes=this.FB.group({hotel_id:["",[l.kI.required]],nombre:["",[l.kI.required]],precio:["",[l.kI.required]],descripcion:["",[l.kI.required]]})}getIndex(t="",o=this.pageCount,i=1){this.spinner.show(),this.loadingTable=!0,this.recipesService.getAll(o,t,i).subscribe(s=>{this.loadingTable=!1,this.recipesData=s.data,this.ultimaPage=s.last_page,this.countRegisters=s.total,this.ultimaPage=s.last_page,s.total>o&&(this.disablePageRight=!0),this.validatePage(),this.spinner.hide()},s=>{console.log("Error: ",s)})}onRemove(t){this.imagen=null}onSelect(t){this.imagen=t.currentFiles[0]}onPage(t){this.pageCount=t.rows,this.getIndex("",this.pageCount)}searchInput(){let t=this.formSearch.get("search").value;""==t&&this.getIndex(t)}search(t){let o=this.formSearch.get("search").value;this.getIndex(o)}onPageChange(t){this.first=t.first,this.rows=t.rows}leftTable(){this.pageActual=this.pageActual-1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(I),e.Y36(l.qu),e.Y36(f.t2),e.Y36(_.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-recipes"]],decls:79,vars:38,consts:[["type","ball-scale-multiple"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"pi","pi-users","mr-2"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Crear","class","p-button-outlined mr-2","icon","",3,"click",4,"ngIf"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],["header","Crear Receta",3,"visible","modal","draggable","resizable","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6"],["optionLabel","nombre","formControlName","hotel_id",3,"options"],["style","color: red;",4,"ngIf"],["type","text","pInputText","","formControlName","nombre",1,"w-full","mb-3","border-round-3xl"],["type","number","pInputText","","formControlName","precio",1,"w-full","mb-3","border-round-3xl"],[1,"field","col-12","md:col-12"],["type","text","pInputText","","formControlName","descripcion",1,"w-full","mb-3","border-round-3xl"],["pButton","","pRipple","","label","Crear Receta","icon","","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],["header","Editar Recetas",3,"visible","modal","draggable","resizable","visibleChange"],["pButton","","pRipple","","label","Editar Receta","icon","","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],["pButton","","pRipple","","label","Crear","icon","",1,"p-button-outlined","mr-2",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[1,"flex","gap-2"],["icon","pi pi-user-edit","severity","info",3,"click",4,"ngIf"],["icon","pi pi-cog","severity","info",3,"click",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"click",4,"ngIf"],["icon","pi pi-user-edit","severity","info",3,"click"],["icon","pi pi-cog","severity","info",3,"click"],["icon","pi pi-trash","severity","danger",3,"click"],["colspan","8"],[2,"color","red"]],template:function(o,i){1&o&&(e._UZ(0,"ngx-spinner",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),e._uU(5,"Recetas"),e.qZA(),e.TgZ(6,"div",4)(7,"div",5),e._UZ(8,"i",6),e.qZA()()(),e.TgZ(9,"div",7),e.YNc(10,L,1,0,"button",8),e.qZA()()(),e.TgZ(11,"div",9)(12,"div",10)(13,"div",11)(14,"p-table",12),e.NdJ("onPage",function(c){return i.onPage(c)}),e.YNc(15,z,8,1,"ng-template",13),e.YNc(16,j,11,0,"ng-template",14),e.YNc(17,ee,14,12,"ng-template",15),e.YNc(18,te,3,0,"ng-template",16),e.qZA(),e._UZ(19,"br"),e.TgZ(20,"div",17)(21,"span",18)(22,"button",19),e.NdJ("click",function(){return i.leftTable()}),e.qZA(),e._UZ(23,"button",20),e.TgZ(24,"button",21),e.NdJ("click",function(){return i.rightTable()}),e.qZA()()()()()(),e.TgZ(25,"p-dialog",22),e.NdJ("visibleChange",function(c){return i.visibleModalRecipes=c}),e.TgZ(26,"div",10)(27,"form",23),e.NdJ("ngSubmit",function(){return i.submitCreate()}),e.TgZ(28,"div",24)(29,"div",25)(30,"label"),e._uU(31,"Hotel"),e.qZA(),e._UZ(32,"p-dropdown",26),e.YNc(33,ie,2,0,"div",27),e.qZA(),e.TgZ(34,"div",25)(35,"label"),e._uU(36,"Nombre"),e.qZA(),e._UZ(37,"input",28),e.YNc(38,oe,2,0,"div",27),e.qZA(),e.TgZ(39,"div",25)(40,"label"),e._uU(41,"Precio"),e.qZA(),e._UZ(42,"input",29),e.YNc(43,ne,2,0,"div",27),e.qZA(),e.TgZ(44,"div",30)(45,"label"),e._uU(46,"Descripcion"),e.qZA(),e._UZ(47,"input",31),e.YNc(48,se,2,0,"div",27),e.qZA(),e.TgZ(49,"div",30),e._UZ(50,"button",32),e.qZA()(),e._UZ(51,"br"),e.qZA()()(),e.TgZ(52,"p-dialog",33),e.NdJ("visibleChange",function(c){return i.visibleModalRecipesEditar=c}),e.TgZ(53,"div",10)(54,"form",23),e.NdJ("ngSubmit",function(){return i.submitUpdate()}),e.TgZ(55,"div",24)(56,"div",25)(57,"label"),e._uU(58,"Hotel"),e.qZA(),e._UZ(59,"p-dropdown",26),e.YNc(60,ae,2,0,"div",27),e.qZA(),e.TgZ(61,"div",25)(62,"label"),e._uU(63,"Nombre"),e.qZA(),e._UZ(64,"input",28),e.YNc(65,re,2,0,"div",27),e.qZA(),e.TgZ(66,"div",25)(67,"label"),e._uU(68,"Precio"),e.qZA(),e._UZ(69,"input",29),e.YNc(70,le,2,0,"div",27),e.qZA(),e.TgZ(71,"div",30)(72,"label"),e._uU(73,"Descripcion"),e.qZA(),e._UZ(74,"input",31),e.YNc(75,ce,2,0,"div",27),e.qZA(),e.TgZ(76,"div",30),e._UZ(77,"button",34),e.qZA()(),e._UZ(78,"br"),e.qZA()()()),2&o&&(e.xp6(10),e.Q6J("ngIf",i.permisoCrear),e.xp6(4),e.Q6J("value",i.recipesData)("tableStyle",e.DdM(34,pe))("loading",i.loadingTable)("rows",8)("globalFilterFields",e.DdM(35,de))("rowHover",!0),e.xp6(8),e.Q6J("disabled",!i.disablePageLeft),e.xp6(1),e.Q6J("label",i.pageActual),e.xp6(1),e.Q6J("disabled",!i.disablePageRight),e.xp6(1),e.Akn(e.DdM(36,A)),e.Q6J("visible",i.visibleModalRecipes)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(2),e.Q6J("formGroup",i.formCreateRecipes),e.xp6(5),e.Q6J("options",i.hotel),e.xp6(1),e.Q6J("ngIf",i.formCreateRecipes.get("hotel_id").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formCreateRecipes.get("nombre").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formCreateRecipes.get("precio").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formCreateRecipes.get("descripcion").hasError("required")),e.xp6(4),e.Akn(e.DdM(37,A)),e.Q6J("visible",i.visibleModalRecipesEditar)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(2),e.Q6J("formGroup",i.formEditRecipes),e.xp6(5),e.Q6J("options",i.hotel),e.xp6(1),e.Q6J("ngIf",i.formEditRecipes.get("hotel_id").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formEditRecipes.get("nombre").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formEditRecipes.get("precio").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formEditRecipes.get("descripcion").hasError("required")))},dependencies:[p.O5,b.iA,g.jx,m.Hq,m.zx,l._Y,l.Fj,l.wV,l.JJ,l.JL,h.H,v.o,T.Lt,x.V,l.sg,l.u,f.Ro,p.H9],styles:["svg[_ngcontent-%COMP%]{width:45%}"]})}return n})();var u=r(2076),P=r(2537),y=r(4562),q=r(7778),S=r(3259);function ge(n,a){1&n&&e.GkF(0)}function me(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ge,1,0,"ng-container",3),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngTemplateOutlet",t.contentTemplate)}}function he(n,a){if(1&n&&(e.TgZ(0,"div",1),e.Hsn(1),e.YNc(2,me,2,1,"ng-container",2),e.qZA()),2&n){const t=e.oxw();e.Q6J("hidden",!t.selected),e.uIk("id",t.id)("aria-hidden",!t.selected)("aria-labelledby",t.id+"-label"),e.xp6(2),e.Q6J("ngIf",t.contentTemplate&&(t.cache?t.loaded:t.selected))}}const N=["*"],_e=["content"],fe=["navbar"],be=["prevBtn"],ve=["nextBtn"],Te=["inkbar"];function xe(n,a){1&n&&e._UZ(0,"ChevronLeftIcon")}function Ce(n,a){}function Ze(n,a){1&n&&e.YNc(0,Ce,0,0,"ng-template")}function Ie(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",12,13),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.navBackward())}),e.YNc(2,xe,1,0,"ChevronLeftIcon",14),e.YNc(3,Ze,1,0,null,15),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.previousIconTemplate),e.xp6(1),e.Q6J("ngTemplateOutlet",t.previousIconTemplate)}}function we(n,a){if(1&n&&e._UZ(0,"span",24),2&n){const t=e.oxw(3).$implicit;e.Q6J("ngClass",t.leftIcon)}}function Re(n,a){}function Ae(n,a){1&n&&e.YNc(0,Re,0,0,"ng-template")}function Pe(n,a){if(1&n&&(e.TgZ(0,"span",25),e.YNc(1,Ae,1,0,null,15),e.qZA()),2&n){const t=e.oxw(3).$implicit;e.xp6(1),e.Q6J("ngTemplateOutlet",t.leftIconTemplate)}}function ye(n,a){if(1&n&&e._UZ(0,"span",26),2&n){const t=e.oxw(3).$implicit;e.Q6J("ngClass",t.rightIcon)}}function qe(n,a){}function Se(n,a){1&n&&e.YNc(0,qe,0,0,"ng-template")}function Ne(n,a){if(1&n&&(e.TgZ(0,"span",27),e.YNc(1,Se,1,0,null,15),e.qZA()),2&n){const t=e.oxw(3).$implicit;e.xp6(1),e.Q6J("ngTemplateOutlet",t.rightIconTemplate)}}function Ue(n,a){if(1&n&&(e.ynx(0),e.YNc(1,we,1,1,"span",19),e.YNc(2,Pe,2,1,"span",20),e.TgZ(3,"span",21),e._uU(4),e.qZA(),e.YNc(5,ye,1,1,"span",22),e.YNc(6,Ne,2,1,"span",23),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",t.leftIcon&&!t.leftIconTemplate),e.xp6(1),e.Q6J("ngIf",t.leftIconTemplate),e.xp6(2),e.Oqu(t.header),e.xp6(1),e.Q6J("ngIf",t.rightIcon&&!t.rightIconTemplate),e.xp6(1),e.Q6J("ngIf",t.rightIconTemplate)}}function ke(n,a){1&n&&e.GkF(0)}function Je(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"TimesIcon",30),e.NdJ("click",function(i){e.CHM(t);const s=e.oxw(3).$implicit,c=e.oxw();return e.KtG(c.close(i,s))}),e.qZA()}2&n&&e.Q6J("styleClass","p-tabview-close")}function Me(n,a){1&n&&e._UZ(0,"span",31)}function Ee(n,a){}function Qe(n,a){1&n&&e.YNc(0,Ee,0,0,"ng-template")}function Ye(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Je,1,1,"TimesIcon",28),e.YNc(2,Me,1,0,"span",29),e.YNc(3,Qe,1,0,null,15),e.BQk()),2&n){const t=e.oxw(2).$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.closeIconTemplate),e.xp6(1),e.Q6J("ngIf",o.p-o.tabview-o.close),e.xp6(1),e.Q6J("ngTemplateOutlet",t.closeIconTemplate)}}const Be=function(n,a){return{"p-highlight":n,"p-disabled":a}};function Ge(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"li",17)(1,"a",18),e.NdJ("click",function(i){e.CHM(t);const s=e.oxw().$implicit,c=e.oxw();return e.KtG(c.open(i,s))})("keydown.enter",function(i){e.CHM(t);const s=e.oxw().$implicit,c=e.oxw();return e.KtG(c.open(i,s))}),e.YNc(2,Ue,7,5,"ng-container",14),e.YNc(3,ke,1,0,"ng-container",15),e.YNc(4,Ye,4,3,"ng-container",14),e.qZA()()}if(2&n){const t=e.oxw().$implicit;e.Tol(t.headerStyleClass),e.Q6J("ngClass",e.WLB(16,Be,t.selected,t.disabled))("ngStyle",t.headerStyle),e.xp6(1),e.Q6J("pTooltip",t.tooltip)("tooltipPosition",t.tooltipPosition)("positionStyle",t.tooltipPositionStyle)("tooltipStyleClass",t.tooltipStyleClass),e.uIk("id",t.id+"-label")("aria-selected",t.selected)("aria-controls",t.id)("aria-selected",t.selected)("tabindex",t.disabled?null:"0"),e.xp6(1),e.Q6J("ngIf",!t.headerTemplate),e.xp6(1),e.Q6J("ngTemplateOutlet",t.headerTemplate),e.xp6(1),e.Q6J("ngIf",t.closable)}}function Fe(n,a){1&n&&e.YNc(0,Ge,5,19,"li",16),2&n&&e.Q6J("ngIf",!a.$implicit.closed)}function Ve(n,a){1&n&&e._UZ(0,"ChevronRightIcon")}function De(n,a){}function Oe(n,a){1&n&&e.YNc(0,De,0,0,"ng-template")}function $e(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",32,33),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.navForward())}),e.YNc(2,Ve,1,0,"ChevronRightIcon",14),e.YNc(3,Oe,1,0,null,15),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.nextIconTemplate),e.xp6(1),e.Q6J("ngTemplateOutlet",t.nextIconTemplate)}}const He=function(n){return{"p-tabview p-component":!0,"p-tabview-scrollable":n}};let Le=0,U=(()=>{class n{viewContainer;cd;closable=!1;headerStyle;headerStyleClass;cache=!0;tooltip;tooltipPosition="top";tooltipPositionStyle="absolute";tooltipStyleClass;get selected(){return!!this._selected}set selected(t){this._selected=t,this.loaded||this.cd.detectChanges(),t&&(this.loaded=!0)}get disabled(){return!!this._disabled}set disabled(t){this._disabled=t,this.tabView.cd.markForCheck()}get header(){return this._header}set header(t){this._header=t,Promise.resolve().then(()=>{this.tabView.updateInkBar(),this.tabView.cd.markForCheck()})}get leftIcon(){return this._leftIcon}set leftIcon(t){this._leftIcon=t,this.tabView.cd.markForCheck()}get rightIcon(){return this._rightIcon}set rightIcon(t){this._rightIcon=t,this.tabView.cd.markForCheck()}templates;closed=!1;view=null;_selected;_disabled;_header;_leftIcon;_rightIcon=void 0;loaded=!1;id="p-tabpanel-"+Le++;contentTemplate;headerTemplate;leftIconTemplate;rightIconTemplate;closeIconTemplate;tabView;constructor(t,o,i){this.viewContainer=o,this.cd=i,this.tabView=t}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"content":default:this.contentTemplate=t.template;break;case"righticon":this.rightIconTemplate=t.template;break;case"lefticon":this.leftIconTemplate=t.template;break;case"closeicon":this.closeIconTemplate=t.template}})}ngOnDestroy(){this.view=null}static \u0275fac=function(o){return new(o||n)(e.Y36((0,e.Gpc)(()=>k)),e.Y36(e.s_b),e.Y36(e.sBO))};static \u0275cmp=e.Xpm({type:n,selectors:[["p-tabPanel"]],contentQueries:function(o,i,s){if(1&o&&e.Suo(s,g.jx,4),2&o){let c;e.iGM(c=e.CRH())&&(i.templates=c)}},hostAttrs:[1,"p-element"],inputs:{closable:"closable",headerStyle:"headerStyle",headerStyleClass:"headerStyleClass",cache:"cache",tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",selected:"selected",disabled:"disabled",header:"header",leftIcon:"leftIcon",rightIcon:"rightIcon"},ngContentSelectors:N,decls:1,vars:1,consts:[["class","p-tabview-panel","role","tabpanel",3,"hidden",4,"ngIf"],["role","tabpanel",1,"p-tabview-panel",3,"hidden"],[4,"ngIf"],[4,"ngTemplateOutlet"]],template:function(o,i){1&o&&(e.F$t(),e.YNc(0,he,3,5,"div",0)),2&o&&e.Q6J("ngIf",!i.closed)},dependencies:[p.O5,p.tP],encapsulation:2})}return n})(),k=(()=>{class n{platformId;el;cd;style;styleClass;controlClose;scrollable;get activeIndex(){return this._activeIndex}set activeIndex(t){this._activeIndex=t,this.preventActiveIndexPropagation?this.preventActiveIndexPropagation=!1:this.tabs&&this.tabs.length&&null!=this._activeIndex&&this.tabs.length>this._activeIndex&&(this.findSelectedTab().selected=!1,this.tabs[this._activeIndex].selected=!0,this.tabChanged=!0,this.updateScrollBar(t))}onChange=new e.vpe;onClose=new e.vpe;activeIndexChange=new e.vpe;content;navbar;prevBtn;nextBtn;inkbar;tabPanels;templates;initialized;tabs;_activeIndex;preventActiveIndexPropagation;tabChanged;backwardIsDisabled=!0;forwardIsDisabled=!1;tabChangesSubscription;nextIconTemplate;previousIconTemplate;constructor(t,o,i){this.platformId=t,this.el=o,this.cd=i}ngAfterContentInit(){this.initTabs(),this.tabChangesSubscription=this.tabPanels.changes.subscribe(t=>{this.initTabs()}),this.templates.forEach(t=>{switch(t.getType()){case"previousicon":this.previousIconTemplate=t.template;break;case"nexticon":this.nextIconTemplate=t.template}})}ngAfterViewChecked(){(0,p.NF)(this.platformId)&&this.tabChanged&&(this.updateInkBar(),this.tabChanged=!1)}ngOnDestroy(){this.tabChangesSubscription&&this.tabChangesSubscription.unsubscribe()}initTabs(){this.tabs=this.tabPanels.toArray(),!this.findSelectedTab()&&this.tabs.length&&(null!=this.activeIndex&&this.tabs.length>this.activeIndex?this.tabs[this.activeIndex].selected=!0:this.tabs[0].selected=!0,this.tabChanged=!0),this.cd.markForCheck()}open(t,o){if(o.disabled)t&&t.preventDefault();else{if(!o.selected){let i=this.findSelectedTab();i&&(i.selected=!1),this.tabChanged=!0,o.selected=!0;let s=this.findTabIndex(o);this.preventActiveIndexPropagation=!0,this.activeIndexChange.emit(s),this.onChange.emit({originalEvent:t,index:s}),this.updateScrollBar(s)}t&&t.preventDefault()}}close(t,o){this.controlClose?this.onClose.emit({originalEvent:t,index:this.findTabIndex(o),close:()=>{this.closeTab(o)}}):(this.closeTab(o),this.onClose.emit({originalEvent:t,index:this.findTabIndex(o)}))}closeTab(t){if(!t.disabled){if(t.selected){this.tabChanged=!0,t.selected=!1;for(let o=0;o<this.tabs.length;o++){let i=this.tabs[o];if(!i.closed&&!t.disabled){i.selected=!0;break}}}t.closed=!0}}findSelectedTab(){for(let t=0;t<this.tabs.length;t++)if(this.tabs[t].selected)return this.tabs[t];return null}findTabIndex(t){let o=-1;for(let i=0;i<this.tabs.length;i++)if(this.tabs[i]==t){o=i;break}return o}getBlockableElement(){return this.el.nativeElement.children[0]}updateInkBar(){if(this.navbar){const t=u.p.findSingle(this.navbar.nativeElement,"li.p-highlight");if(!t)return;this.inkbar.nativeElement.style.width=u.p.getWidth(t)+"px",this.inkbar.nativeElement.style.left=u.p.getOffset(t).left-u.p.getOffset(this.navbar.nativeElement).left+"px"}}updateScrollBar(t){this.navbar.nativeElement.children[t].scrollIntoView({block:"nearest"})}updateButtonState(){const t=this.content.nativeElement,{scrollLeft:o,scrollWidth:i}=t,s=u.p.getWidth(t);this.backwardIsDisabled=0===o,this.forwardIsDisabled=o===i-s}onScroll(t){this.scrollable&&this.updateButtonState(),t.preventDefault()}getVisibleButtonWidths(){return[this.prevBtn?.nativeElement,this.nextBtn?.nativeElement].reduce((t,o)=>o?t+u.p.getWidth(o):t,0)}navBackward(){const t=this.content.nativeElement,o=u.p.getWidth(t)-this.getVisibleButtonWidths(),i=t.scrollLeft-o;t.scrollLeft=i<=0?0:i}navForward(){const t=this.content.nativeElement,o=u.p.getWidth(t)-this.getVisibleButtonWidths(),i=t.scrollLeft+o,s=t.scrollWidth-o;t.scrollLeft=i>=s?s:i}static \u0275fac=function(o){return new(o||n)(e.Y36(e.Lbi),e.Y36(e.SBq),e.Y36(e.sBO))};static \u0275cmp=e.Xpm({type:n,selectors:[["p-tabView"]],contentQueries:function(o,i,s){if(1&o&&(e.Suo(s,U,4),e.Suo(s,g.jx,4)),2&o){let c;e.iGM(c=e.CRH())&&(i.tabPanels=c),e.iGM(c=e.CRH())&&(i.templates=c)}},viewQuery:function(o,i){if(1&o&&(e.Gf(_e,5),e.Gf(fe,5),e.Gf(be,5),e.Gf(ve,5),e.Gf(Te,5)),2&o){let s;e.iGM(s=e.CRH())&&(i.content=s.first),e.iGM(s=e.CRH())&&(i.navbar=s.first),e.iGM(s=e.CRH())&&(i.prevBtn=s.first),e.iGM(s=e.CRH())&&(i.nextBtn=s.first),e.iGM(s=e.CRH())&&(i.inkbar=s.first)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",controlClose:"controlClose",scrollable:"scrollable",activeIndex:"activeIndex"},outputs:{onChange:"onChange",onClose:"onClose",activeIndexChange:"activeIndexChange"},ngContentSelectors:N,decls:13,vars:9,consts:[[3,"ngClass","ngStyle"],[1,"p-tabview-nav-container"],["class","p-tabview-nav-prev p-tabview-nav-btn p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-tabview-nav-content",3,"scroll"],["content",""],["role","tablist",1,"p-tabview-nav"],["navbar",""],["ngFor","",3,"ngForOf"],[1,"p-tabview-ink-bar"],["inkbar",""],["class","p-tabview-nav-next p-tabview-nav-btn p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-tabview-panels"],["type","button","pRipple","",1,"p-tabview-nav-prev","p-tabview-nav-btn","p-link",3,"click"],["prevBtn",""],[4,"ngIf"],[4,"ngTemplateOutlet"],["role","presentation",3,"ngClass","ngStyle","class",4,"ngIf"],["role","presentation",3,"ngClass","ngStyle"],["role","tab","pRipple","",1,"p-tabview-nav-link",3,"pTooltip","tooltipPosition","positionStyle","tooltipStyleClass","click","keydown.enter"],["class","p-tabview-left-icon",3,"ngClass",4,"ngIf"],["class","p-tabview-left-icon",4,"ngIf"],[1,"p-tabview-title"],["class","p-tabview-right-icon",3,"ngClass",4,"ngIf"],["class","p-tabview-right-icon",4,"ngIf"],[1,"p-tabview-left-icon",3,"ngClass"],[1,"p-tabview-left-icon"],[1,"p-tabview-right-icon",3,"ngClass"],[1,"p-tabview-right-icon"],[3,"styleClass","click",4,"ngIf"],["class","tab.closeIconTemplate",4,"ngIf"],[3,"styleClass","click"],[1,"tab.closeIconTemplate"],["type","button","pRipple","",1,"p-tabview-nav-next","p-tabview-nav-btn","p-link",3,"click"],["nextBtn",""]],template:function(o,i){1&o&&(e.F$t(),e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Ie,4,2,"button",2),e.TgZ(3,"div",3,4),e.NdJ("scroll",function(c){return i.onScroll(c)}),e.TgZ(5,"ul",5,6),e.YNc(7,Fe,1,1,"ng-template",7),e._UZ(8,"li",8,9),e.qZA()(),e.YNc(10,$e,4,2,"button",10),e.qZA(),e.TgZ(11,"div",11),e.Hsn(12),e.qZA()()),2&o&&(e.Tol(i.styleClass),e.Q6J("ngClass",e.VKq(7,He,i.scrollable))("ngStyle",i.style),e.xp6(2),e.Q6J("ngIf",i.scrollable&&!i.backwardIsDisabled),e.xp6(5),e.Q6J("ngForOf",i.tabs),e.xp6(3),e.Q6J("ngIf",i.scrollable&&!i.forwardIsDisabled))},dependencies:function(){return[p.mk,p.sg,p.O5,p.tP,p.PC,S.u,h.H,q.q,P.w,y.X]},styles:[".p-tabview-nav-container{position:relative}.p-tabview-scrollable .p-tabview-nav-container{overflow:hidden}.p-tabview-nav-content{overflow-x:auto;overflow-y:hidden;scroll-behavior:smooth;scrollbar-width:none;overscroll-behavior:contain auto}.p-tabview-nav{display:flex;margin:0;padding:0;list-style-type:none;flex:1 1 auto}.p-tabview-nav-link{cursor:pointer;-webkit-user-select:none;user-select:none;display:flex;align-items:center;position:relative;text-decoration:none;overflow:hidden}.p-tabview-ink-bar{display:none;z-index:1}.p-tabview-nav-link:focus{z-index:1}.p-tabview-title{line-height:1;white-space:nowrap}.p-tabview-nav-btn{position:absolute;top:0;z-index:2;height:100%;display:flex;align-items:center;justify-content:center}.p-tabview-nav-prev{left:0}.p-tabview-nav-next{right:0}.p-tabview-nav-content::-webkit-scrollbar{display:none}.p-tabview-close{z-index:1}\n"],encapsulation:2,changeDetection:0})}return n})(),ze=(()=>{class n{static \u0275fac=function(o){return new(o||n)};static \u0275mod=e.oAB({type:n});static \u0275inj=e.cJS({imports:[p.ez,g.m8,S.z,h.T,q.q,P.w,y.X,g.m8]})}return n})();function je(n,a){1&n&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Nombre del Producto"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Medida"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Cantidad"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Descripci\xf3n"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Acciones"),e.qZA()())}function Ke(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"p-button",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.quitarProducto(s))}),e.qZA()()()}if(2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.nombre),e.xp6(2),e.Oqu(null==t?null:t.medida),e.xp6(2),e.Oqu(t.cantidad),e.xp6(2),e.Oqu(t.descripcion)}}function We(n,a){1&n&&(e.TgZ(0,"tr")(1,"td",38),e._uU(2,"Cargando informacion porfavor espere ..."),e.qZA()())}function Xe(n,a){1&n&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Nombre"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Porcentaje"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Acciones"),e.qZA()())}function et(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"p-button",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.quitarTaxes(s))}),e.qZA()()()}if(2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.nombre),e.xp6(2),e.Oqu(t.porcentaje)}}function tt(n,a){1&n&&(e.TgZ(0,"tr")(1,"td",38),e._uU(2,"Cargando informacion porfavor espere ..."),e.qZA()())}function it(n,a){if(1&n&&(e.TgZ(0,"div",39)(1,"span",40),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.nombre)}}function ot(n,a){1&n&&(e.TgZ(0,"div",41),e._uU(1,"Campo requerido"),e.qZA())}function nt(n,a){1&n&&(e.TgZ(0,"div",41),e._uU(1,"Campo requerido "),e.qZA())}function st(n,a){1&n&&(e.TgZ(0,"div",41),e._uU(1,"La cantidad debe ser al menos 1."),e.qZA())}function at(n,a){if(1&n&&(e.TgZ(0,"div",39)(1,"span",40),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.nombre)}}function rt(n,a){1&n&&(e.TgZ(0,"div",41),e._uU(1,"Campo requerido"),e.qZA())}const J=function(){return{"min-width":"50rem"}},M=function(){return{width:"50vw"}};let lt=(()=>{class n{constructor(t,o,i,s,c,gt){this.recipesService=t,this.FB=o,this.spinner=i,this.router=s,this.route=c,this.cdr=gt,this.productsData=[],this.loadingTable=!1,this.productoVisible=!1,this.productosSeleccionados=[],this.displayModalProducts=!1,this.displayModalTaxes=!1,this.taxesData=[],this.impuestosSeleccionados=[],this.pageCount=10,this.first=0,this.rows=8,this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1}ngOnInit(){this.spinner.hide(),this.dataRecipesDetail=[],this.buildForm(),this.recetaId=parseFloat(this.route.snapshot.paramMap.get("id")),this.getProductsAndRecipesList(this.recetaId),this.getProductsForRecipe(this.recetaId),this.getTaxesAndRecipesList(this.recetaId),this.getTaxesById(this.recetaId)}buildForm(){this.form=this.FB.group({nombreReceta:[this.dataRecipesDetail?.detalleRecipes?.recipes?.nombre,[]],descripcion:[this.dataRecipesDetail?.detalleRecipes?.descripcion,[]],precio:[this.dataRecipesDetail?.detalleRecipes?.precio,[]]}),this.formImpuesto=this.FB.group({impuesto_id:[null,l.kI.required],nombre:[""],porcentaje:["",l.kI.required]}),this.form.get("nombreReceta").disable(),this.form.get("descripcion").disable(),this.form.get("precio").disable(),this.formProducto=this.FB.group({producto_id:[null,[l.kI.required]],cantidad:[1,[l.kI.required,l.kI.min(1)]]}),this.formTaxes=this.FB.group({impuesto_id:[null,[l.kI.required]]})}openModal(){this.displayModalProducts=!0}closeModal(){this.displayModalProducts=!1}getProductsAndRecipesList(t){this.loadingTable=!0,this.recipesService.getProducts(t).subscribe(o=>{this.productsData=o.productos,this.loadingTable=!1;const i=Number(o.receta.precio).toLocaleString("es-CO");this.form.get("nombreReceta").setValue(o.receta.nombre),this.form.get("precio").setValue(`$${i}`),this.form.get("descripcion").setValue(o.receta.descripcion)},o=>{console.error(o),this.loadingTable=!1})}onCantidadChange(t){this.formProducto.controls.cantidad.setValue(t.target.value)}agregarProductos(){const t=this.formProducto.get("producto_id").value,o=this.formProducto.get("cantidad").value;t?(this.productosGuardados=this.productosGuardados||[],this.productosSeleccionados=this.productosSeleccionados||[],t.cantidad=Number(o),this.productosSeleccionados.push({producto_id:t.id,nombre:t.nombre,descripcion:t.descripcion,cantidad:Number(o),medida:t.medida.nombre}),console.log("Producto agregado:",{producto_id:t.id,cantidad:Number(o)}),this.productosParaMostrar=[...this.productosGuardados,...this.productosSeleccionados],this.cdr.detectChanges(),this.formProducto.get("producto_id").setValue(null),this.formProducto.get("cantidad").setValue(0),this.closeModal()):console.error("Por favor, selecciona un producto antes de agregar.")}getProductsForRecipe(t){this.loadingTable=!0,this.recipesService.getProductsRecetas(t).subscribe(o=>{o&&o.receta&&o.receta.length>0?(console.log(o),this.productosGuardados=o.receta.map(i=>({id:i.productos.id,nombre:i.productos.nombre,cantidad:i.cantidad,descripcion:i.productos.descripcion,medida:i.productos.medida.nombre}))):(console.log("No se encontraron productos asociados a esta receta."),this.productosGuardados=[]),this.productosParaMostrar=[...this.productosGuardados,...this.productosSeleccionados],this.loadingTable=!1},o=>{console.error(o),this.loadingTable=!1})}sendProducts(){console.log("this.productosSeleccionados:",this.productosSeleccionados),console.log("this.productosSeleccionados.length:",this.productosSeleccionados?this.productosSeleccionados.length:"undefined");const t=[...this.productosGuardados,...this.productosSeleccionados];if(Array.isArray(t)){let o={receta_id:this.recetaId,producto:t.map(i=>({producto_id:i.producto_id?i.producto_id:i.id,cantidad:String(i.cantidad)}))};this.recipesService.createRecipesProducts(o).subscribe(i=>{i.val&&this.getProductsForRecipe(this.recetaId)},i=>{console.error(i),d().fire({title:"Error",text:"Hubo un error al guardar los productos.",icon:"error"})})}else d().fire({title:"Error",text:"Hubo un error al guardar los productos.",icon:"error"});d().fire({title:"Exito",text:"Los productos se han guardado correctamente.",icon:"success"})}quitarProducto(t){let o=this.productosSeleccionados.findIndex(i=>i===t);-1!==o?this.productosSeleccionados.splice(o,1):(o=this.productosGuardados.findIndex(i=>i===t),-1!==o&&this.productosGuardados.splice(o,1)),this.productosParaMostrar=[...this.productosGuardados,...this.productosSeleccionados],this.cdr.detectChanges()}openModalTaxes(){this.displayModalTaxes=!0}closeModalTaxes(){this.displayModalTaxes=!1}getTaxesAndRecipesList(t){this.loadingTable=!0,this.recipesService.getTaxes(t).subscribe(o=>{this.taxesData=o.impuesto,this.loadingTable=!1},o=>{console.error(o),this.loadingTable=!1})}agregarImpuestos(){const t=this.formImpuesto.get("impuesto_id").value.id,o=this.taxesData.find(i=>i.id===t);o?(this.impuestosGuardados=this.impuestosGuardados||[],this.impuestosSeleccionados=this.impuestosSeleccionados||[],this.impuestosSeleccionados.push({impuesto_id:o.id,nombre:o.nombre,porcentaje:Number(o.porcentaje)}),this.impuestosParaMostrar=[...this.impuestosGuardados,...this.impuestosSeleccionados],this.cdr.detectChanges(),this.formImpuesto.get("impuesto_id").setValue(null),this.closeModalTaxes()):console.error("Por favor, selecciona un impuesto antes de agregar.")}getTaxesById(t){this.loadingTable=!0,this.recipesService.getRecipeTaxes(t).subscribe(o=>{o&&o.receta_impuesto&&o.receta_impuesto.length>0?this.impuestosGuardados=o.receta_impuesto.map(i=>({id:i.impuesto.id,nombre:i.impuesto.nombre,porcentaje:i.impuesto.porcentaje})):(console.log("No se encontraron impuestos asociados a esta receta."),this.impuestosGuardados=[]),this.impuestosParaMostrar=[...this.impuestosGuardados,...this.impuestosSeleccionados],this.loadingTable=!1},o=>{console.error(o),this.loadingTable=!1})}sendTaxes(){if(console.log("this.impuestosSeleccionados:",this.impuestosSeleccionados),console.log("this.impuestosSeleccionados.length:",this.impuestosSeleccionados?this.impuestosSeleccionados.length:"undefined"),Array.isArray(this.impuestosSeleccionados)){let t={receta_id:this.recetaId,impuestos:Array.isArray(this.impuestosSeleccionados)?this.impuestosSeleccionados.map(o=>({impuesto_id:o.impuesto_id})):[]};console.log("datos:",t),this.recipesService.createTaxes(t).subscribe(o=>{console.log("response:",o),o.val&&this.getTaxesById(this.recetaId)},o=>{console.error(o),d().fire({title:"Error",text:"Hubo un error al guardar los impuestos.",icon:"error"})})}else d().fire({title:"Error",text:"Por favor, agrega al menos un impuesto a la receta antes de guardar.",icon:"error"});d().fire({title:"Exito",text:"Los impuestos se han guardado correctamente.",icon:"success"})}quitarTaxes(t){let o=this.impuestosSeleccionados.findIndex(i=>i===t);-1!==o?this.impuestosSeleccionados.splice(o,1):(o=this.impuestosGuardados.findIndex(i=>i===t),-1!==o&&this.impuestosGuardados.splice(o,1)),this.impuestosParaMostrar=[...this.impuestosGuardados,...this.impuestosSeleccionados],this.cdr.detectChanges()}onPage(t){this.pageCount=t.rows}onPageChange(t){this.first=t.first,this.rows=t.rows}leftTable(){this.pageActual=this.pageActual-1,this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(I),e.Y36(l.qu),e.Y36(f.t2),e.Y36(_.F0),e.Y36(_.gz),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-recipes-products"]],decls:89,vars:37,consts:[["type","ball-scale-multiple",3,"fullScreen"],[1,"card","m-1"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6"],["type","text","formControlName","nombreReceta","pInputText","",1,"w-full","mb-3","border-round-3xl"],[1,"field","col-12","md:col-3"],["type","text","formControlName","precio","pInputText","",1,"w-full","mb-3","border-round-3xl"],[1,"field","col-12","md:col-12"],["formControlName","descripcion","pInputTextarea","","required","","rows","3","cols","20"],["orientation","left"],["header","Agregar Producto",1,"line-height-3","m-0"],["pButton","","pRipple","","type","button","icon","pi pi-plus",1,"p-button-rounded","p-button-text",3,"click"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Guardar","icon","",1,"p-button-outlined","mr-2",3,"click"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll",3,"value","tableStyle","loading","rows"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],["header","Agregar Impuesto",1,"line-height-3","m-0"],["pButton","","pRipple","","label","Guardar",1,"p-button-outlined","mr-2",3,"click"],["header","Agregar Productos",3,"visible","modal","draggable","resizable","visibleChange"],[3,"formGroup","ngSubmit"],["formControlName","producto_id","optionLabel","nombre","placeholder","Buscar Producto",1,"dropdown-custom",3,"options","autoDisplayFirst"],["pTemplate","item"],["style","color: red;",4,"ngIf"],["type","number","formControlName","cantidad","placeholder","Cantidad","pInputText","","min","1",1,"w-full","mb-3","border-round-3xl",3,"change"],["pButton","","pRipple","","label","Agregar Producto","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],["header","Agregar Impuesto",3,"visible","modal","draggable","resizable","visibleChange"],["formControlName","impuesto_id","optionLabel","nombre","placeholder","Buscar Impuesto",1,"dropdown-custom",3,"options","autoDisplayFirst"],["pButton","","pRipple","","label","Agregar Impuesto","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],["icon","pi pi-trash","severity","danger",3,"click"],["colspan","3"],[1,"flex","align-items-center"],[1,"ml-2"],[2,"color","red"]],template:function(o,i){1&o&&(e._UZ(0,"ngx-spinner",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"div",4),e._uU(6," Detalle de Receta "),e.qZA(),e.TgZ(7,"form",5),e._UZ(8,"br"),e.TgZ(9,"div",6)(10,"div",7)(11,"label"),e._uU(12,"Nombre de Receta"),e.qZA(),e._UZ(13,"input",8),e.qZA(),e.TgZ(14,"div",9)(15,"label"),e._uU(16," Precio "),e.qZA(),e._UZ(17,"input",10),e.qZA(),e.TgZ(18,"div",11)(19,"label"),e._uU(20,"Descripcion"),e.qZA(),e._UZ(21,"textarea",12),e.qZA()()()()()()(),e.TgZ(22,"div",1)(23,"p-tabView",13)(24,"p-tabPanel",14)(25,"div",2)(26,"div",3)(27,"div")(28,"div",4)(29,"button",15),e.NdJ("click",function(){return i.openModal()}),e.qZA(),e._uU(30," Agregar Producto "),e.qZA()(),e.TgZ(31,"div",16)(32,"button",17),e.NdJ("click",function(){return i.sendProducts()}),e.qZA()()()(),e.TgZ(33,"div",18)(34,"div",19)(35,"div",20)(36,"p-table",21),e.YNc(37,je,11,0,"ng-template",22),e.YNc(38,Ke,11,4,"ng-template",23),e.YNc(39,We,3,0,"ng-template",24),e.qZA()()()()(),e.TgZ(40,"p-tabPanel",25),e._UZ(41,"ngx-spinner",0),e.TgZ(42,"div",2)(43,"div",3)(44,"div")(45,"div",4)(46,"button",15),e.NdJ("click",function(){return i.openModalTaxes()}),e.qZA(),e._uU(47," Agregar Impuesto "),e.qZA()(),e.TgZ(48,"div",16)(49,"button",26),e.NdJ("click",function(){return i.sendTaxes()}),e.qZA()()()(),e.TgZ(50,"div",18)(51,"div",19)(52,"div",20)(53,"p-table",21),e.YNc(54,Xe,7,0,"ng-template",22),e.YNc(55,et,7,2,"ng-template",23),e.YNc(56,tt,3,0,"ng-template",24),e.qZA()()()()()()(),e.TgZ(57,"p-dialog",27),e.NdJ("visibleChange",function(c){return i.displayModalProducts=c}),e.TgZ(58,"div",19)(59,"form",28),e.NdJ("ngSubmit",function(){return i.agregarProductos()}),e.TgZ(60,"div",6)(61,"div",11)(62,"label"),e._uU(63,"Producto"),e.qZA(),e.TgZ(64,"p-dropdown",29),e.YNc(65,it,3,1,"ng-template",30),e.qZA(),e.YNc(66,ot,2,0,"div",31),e.qZA(),e.TgZ(67,"div",11)(68,"label"),e._uU(69,"Cantidad"),e.qZA(),e.TgZ(70,"input",32),e.NdJ("change",function(c){return i.onCantidadChange(c)}),e.qZA(),e.YNc(71,nt,2,0,"div",31),e.YNc(72,st,2,0,"div",31),e.qZA(),e.TgZ(73,"div",11),e._UZ(74,"button",33),e.qZA()(),e._UZ(75,"br"),e.qZA()()(),e.TgZ(76,"p-dialog",34),e.NdJ("visibleChange",function(c){return i.displayModalTaxes=c}),e.TgZ(77,"div",19)(78,"form",28),e.NdJ("ngSubmit",function(){return i.agregarImpuestos()}),e.TgZ(79,"div",6)(80,"div",11)(81,"label"),e._uU(82,"Impuesto"),e.qZA(),e.TgZ(83,"p-dropdown",35),e.YNc(84,at,3,1,"ng-template",30),e.qZA(),e.YNc(85,rt,2,0,"div",31),e.qZA(),e.TgZ(86,"div",11),e._UZ(87,"button",36),e.qZA()(),e._UZ(88,"br"),e.qZA()()()),2&o&&(e.Q6J("fullScreen",!0),e.xp6(7),e.Q6J("formGroup",i.form),e.xp6(29),e.Q6J("value",i.productosParaMostrar)("tableStyle",e.DdM(33,J))("loading",i.loadingTable)("rows",8),e.xp6(5),e.Q6J("fullScreen",!0),e.xp6(12),e.Q6J("value",i.impuestosParaMostrar)("tableStyle",e.DdM(34,J))("loading",i.loadingTable)("rows",8),e.xp6(4),e.Akn(e.DdM(35,M)),e.Q6J("visible",i.displayModalProducts)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(2),e.Q6J("formGroup",i.formProducto),e.xp6(5),e.Q6J("options",i.productsData)("autoDisplayFirst",!1),e.xp6(2),e.Q6J("ngIf",i.formProducto.get("producto_id").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formProducto.get("cantidad").hasError("required")),e.xp6(1),e.Q6J("ngIf",null==i.formProducto.get("cantidad").errors?null:i.formProducto.get("cantidad").errors.min),e.xp6(4),e.Akn(e.DdM(36,M)),e.Q6J("visible",i.displayModalTaxes)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(2),e.Q6J("formGroup",i.formImpuesto),e.xp6(5),e.Q6J("options",i.taxesData)("autoDisplayFirst",!1),e.xp6(2),e.Q6J("ngIf",i.formImpuesto.get("impuesto_id").hasError("required")))},dependencies:[p.O5,b.iA,g.jx,m.Hq,m.zx,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.Q7,l.qQ,h.H,v.o,R.g,T.Lt,x.V,l.sg,l.u,f.Ro,k,U],styles:["svg[_ngcontent-%COMP%]{width:45%}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #dddddd;text-align:left;padding:8px}th[_ngcontent-%COMP%]{background-color:#f2f2f2}"]})}return n})();var E=r(2506);let ct=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.oAB({type:n});static#i=this.\u0275inj=e.cJS({imports:[_.Bz.forChild([{path:"",component:ue,canActivate:[E.a],data:{permissions:["gestionInventario.recetas"]}},{path:":id/recipes-products",component:lt,canActivate:[E.a],data:{permissions:["gestionInventario.recetas"]}}]),_.Bz]})}return n})();var pt=r(1712),dt=r(4055);let ut=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.oAB({type:n});static#i=this.\u0275inj=e.cJS({providers:[{provide:C.TP,useClass:D.n,multi:!0},I],imports:[p.ez,ct,b.U$,Q.O,l.u5,m.hJ,h.T,Y.EV,B.V,G.Xt,v.j,R.A,T.kW,F.cc,V.L$,x.S,O.ii.forRoot(),l.UX,f.ef,pt.U,dt.q4,ze]})}return n})()}}]);