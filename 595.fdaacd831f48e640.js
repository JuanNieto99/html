"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[595],{5595:(lt,Z,n)=>{n.r(Z),n.d(Z,{SaleModule:()=>nt});var u=n(6814),l=n(95),g=n(9664),S=n(6068),p=n(707),m=n(4480),q=n(4104),y=n(6340),P=n(6022),h=n(3714),U=n(6218),_=n(2160),D=n(1865),R=n(354),T=n(7213),f=n(9862),J=n(8712),N=n(5722),c=n(8672),F=n(1712),I=n(3514),M=n(4444),t=n(4946);let v=(()=>{class i{constructor(e){this.httpClient=e,this.baseUrl=M.D.url,this.endpointListar="/ventasListar",this.endpointProductsGet="/getproductosVentasCrear",this.endpointRecipesGet="/getrecetasVentasCrear"}getAll(e,o="",a=1){const r={headers:new f.WM({"Content-Type":"application/json"})};return this.httpClient.post(`${this.baseUrl+this.endpointListar}?per_page=${e}&page=${a}&search=${o}`,r)}getProducts(){return this.httpClient.get(`${this.baseUrl+this.endpointProductsGet}`)}getRecipes(){return this.httpClient.get(`${this.baseUrl+this.endpointRecipesGet}`)}static#t=this.\u0275fac=function(o){return new(o||i)(t.LFG(f.eN))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var b=n(86),A=n(5219);function w(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",16)(1,"h5",17),t._uU(2,"Lista de Ventas"),t.qZA(),t.TgZ(3,"span",18)(4,"form",19)(5,"div",20)(6,"input",21),t.NdJ("input",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.searchInput())}),t.qZA(),t.TgZ(7,"button",22),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.search(a.dt))}),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(4),t.Q6J("formGroup",e.formSearch)}}function Y(i,s){1&i&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Hotel"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Usuario"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Total"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Subtotal"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Total Impuestos"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Acciones"),t.qZA()())}function B(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"p-button",25),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.confirmDelete(a.id))}),t.qZA()}}function L(i,s){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td",23),t._UZ(12,"p-confirmDialog"),t.YNc(13,B,1,0,"p-button",24),t.qZA()()),2&i){const e=s.$implicit,o=t.oxw();t.xp6(2),t.Oqu(e.hotel.nombre),t.xp6(2),t.Oqu(e.usuario.usuario),t.xp6(2),t.Oqu(e.total),t.xp6(2),t.Oqu(e.subtotal),t.xp6(2),t.Oqu(e.total_impuestos),t.xp6(3),t.Q6J("ngIf",o.permisoEliminar)}}function Q(i,s){1&i&&(t.TgZ(0,"tr")(1,"td",26),t._uU(2,"Cargando informacion porfavor espere ..."),t.qZA()())}const O=function(){return{"min-width":"50rem"}},$=function(){return["nombre","Hotel","acciones"]};let G=(()=>{class i{constructor(e,o,a,r){this.FB=e,this.spinner=o,this.SaleService=a,this.router=r,this.loadingTable=!1,this.pageCount=10,this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1,this.first=0,this.rows=8}ngOnInit(){this.buildForm(),this.getIndex()}buildForm(){this.formSearch=this.FB.group({search:["",[]]})}redirectToCrearVenta(){this.router.navigate(["dashboard/dashboardSell/sale-detail"])}getIndex(e="",o=this.pageCount,a=1){this.spinner.show(),this.loadingTable=!0,this.SaleService.getAll(o,e,a).subscribe(r=>{this.loadingTable=!1,this.salesData=r.data,this.countRegisters=r.total,this.ultimaPage=r.last_page,r.total>o&&(this.disablePageRight=!0),this.validatePage(),this.spinner.hide()},r=>{console.log("Error: ",r),this.spinner.hide()})}onPage(e){this.pageCount=e.rows,this.getIndex("",this.pageCount)}onPageChange(e){this.first=e.first,this.rows=e.rows}leftTable(){this.pageActual=this.pageActual-1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(l.qu),t.Y36(c.t2),t.Y36(v),t.Y36(b.F0))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-sale"]],decls:19,vars:8,consts:[["type","ball-scale-multiple"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Crear","icon","",1,"p-button-outlined","mr-2",3,"click"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[1,"flex","gap-2"],["icon","pi pi-trash","severity","danger",3,"click",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"click"],["colspan","8"]],template:function(o,a){1&o&&(t._UZ(0,"ngx-spinner",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),t._uU(5,"Ventas"),t.qZA(),t.TgZ(6,"div",4),t._UZ(7,"div",5),t.qZA()(),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return a.redirectToCrearVenta()}),t.qZA()()()(),t.TgZ(10,"div",8)(11,"div",9)(12,"div",10)(13,"p-table",11),t.NdJ("onPage",function(d){return a.onPage(d)}),t.YNc(14,w,8,1,"ng-template",12),t.YNc(15,Y,13,0,"ng-template",13),t.YNc(16,L,14,6,"ng-template",14),t.YNc(17,Q,3,0,"ng-template",15),t.qZA(),t._UZ(18,"br"),t.qZA()()()),2&o&&(t.xp6(13),t.Q6J("value",a.salesData)("tableStyle",t.DdM(6,O))("loading",a.loadingTable)("rows",8)("globalFilterFields",t.DdM(7,$))("rowHover",!0))},dependencies:[u.O5,g.iA,A.jx,p.Hq,p.zx,l._Y,l.Fj,l.JJ,l.JL,m.H,h.o,l.sg,l.u,c.Ro]})}return i})();var C=n(2506);function H(i,s){1&i&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Nombre"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Cantidad"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Acciones"),t.qZA()())}function V(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td")(6,"p-button",29),t.NdJ("click",function(){const r=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.eliminarProducto(r))}),t.qZA()()()}if(2&i){const e=s.$implicit;t.xp6(2),t.Oqu(e.nombre),t.xp6(2),t.Oqu(e.cantidad)}}function j(i,s){1&i&&(t.TgZ(0,"tr")(1,"td",30),t._uU(2,"Cargando informacion porfavor espere ..."),t.qZA()())}function z(i,s){if(1&i&&(t.TgZ(0,"div",31)(1,"span",32),t._uU(2),t.qZA()()),2&i){const e=s.$implicit;t.xp6(2),t.Oqu(e.nombre)}}function E(i,s){1&i&&(t.TgZ(0,"div",33),t._uU(1,"Campo requerido"),t.qZA())}function k(i,s){1&i&&(t.TgZ(0,"div",33),t._uU(1,"Campo requerido "),t.qZA())}function K(i,s){1&i&&(t.TgZ(0,"div",33),t._uU(1,"La cantidad debe ser al menos 1."),t.qZA())}function X(i,s){if(1&i&&(t.TgZ(0,"div",31)(1,"span",32),t._uU(2),t.qZA()()),2&i){const e=s.$implicit;t.xp6(2),t.Oqu(e.nombre)}}function W(i,s){1&i&&(t.TgZ(0,"div",33),t._uU(1,"Campo requerido"),t.qZA())}function tt(i,s){1&i&&(t.TgZ(0,"div",33),t._uU(1,"Campo requerido "),t.qZA())}function et(i,s){1&i&&(t.TgZ(0,"div",33),t._uU(1,"La cantidad debe ser al menos 1."),t.qZA())}const it=function(){return{"min-width":"50rem"}},x=function(){return{width:"50vw"}};let at=(()=>{class i{constructor(e,o,a){this.FB=e,this.spinner=o,this.saleService=a,this.loadingTable=!1,this.productosAgregados=[],this.recetasData=[],this.displayModalRecipes=!1,this.productsData=[],this.displayModalProducts=!1}ngOnInit(){this.spinner.hide(),this.buildForm(),this.loadProducts(),this.loadRecipes()}buildForm(){this.formProducto=this.FB.group({producto_id:[null,l.kI.required],cantidad:[1,[l.kI.required,l.kI.min(1)]]}),this.formReceta=this.FB.group({receta_id:[null,l.kI.required],cantidad:[1,[l.kI.required,l.kI.min(1)]]})}openModalProducts(){this.displayModalProducts=!0}openModalRecipes(){this.displayModalRecipes=!0}loadProducts(){this.loadingTable=!0,this.saleService.getProducts().subscribe(e=>{this.loadingTable=!1,this.productsData=e},e=>{this.loadingTable=!1,console.error(e)})}agregarProductos(){const e=this.formProducto.get("producto_id").value,o=this.formProducto.get("cantidad").value;if(e){const a={...e,cantidad:o};this.productosAgregados.push(a)}else console.error(`No se encontr\xf3 el producto con id ${e.id} en productsData`);this.displayModalProducts=!1}eliminarProducto(e){const o=this.productosAgregados.indexOf(e);o>-1&&this.productosAgregados.splice(o,1)}onCantidadChange(e){this.formProducto.controls.cantidad.setValue(e.target.value)}loadRecipes(){this.saleService.getRecipes().subscribe(e=>{this.recetasData=e},e=>{console.error(e)})}agregarRecipes(){const e=this.formReceta.get("receta_id").value,o=this.formReceta.get("cantidad").value;if(e){const a={...e,cantidad:o};this.productosAgregados.push(a)}else console.error(`No se encontr\xf3 la receta con id ${e.id} en recetasData`);this.displayModalRecipes=!1}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(l.qu),t.Y36(c.t2),t.Y36(v))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-sale-detail"]],decls:59,vars:31,consts:[["type","ball-scale-multiple"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Agregar Producto/Servicio","icon","",1,"p-button-outlined","mr-2",3,"click"],["pButton","","pRipple","","label","Agregar Receta","icon","",1,"p-button-outlined","mr-2",3,"click"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll",3,"value","tableStyle","loading","rows"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],["header","Agregar Producto/Servicio",3,"visible","modal","draggable","resizable","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-12"],["formControlName","producto_id","optionLabel","nombre","placeholder","Buscar Producto o Servicio",1,"dropdown-custom",3,"options","autoDisplayFirst"],["pTemplate","item"],["style","color: red;",4,"ngIf"],["type","number","formControlName","cantidad","placeholder","Cantidad","pInputText","","min","1",1,"w-full","mb-3","border-round-3xl",3,"change"],["pButton","","pRipple","","label","Agregar Producto","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],["header","Agregar Receta",3,"visible","modal","draggable","resizable","visibleChange"],["formControlName","receta_id","optionLabel","nombre","placeholder","Buscar Receta",1,"dropdown-custom",3,"options","autoDisplayFirst"],["type","number","formControlName","cantidad","placeholder","Cantidad","pInputText","","min","1",1,"w-full","mb-3","border-round-3xl"],["pButton","","pRipple","","label","Agregar Receta","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],["icon","pi pi-trash","severity","danger",3,"click"],["colspan","3"],[1,"flex","align-items-center"],[1,"ml-2"],[2,"color","red"]],template:function(o,a){1&o&&(t._UZ(0,"ngx-spinner",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),t._uU(5,"Crear Venta"),t.qZA(),t.TgZ(6,"div",4),t._UZ(7,"div",5),t.qZA()()(),t.TgZ(8,"div",1)(9,"div",2)(10,"div",6)(11,"button",7),t.NdJ("click",function(){return a.openModalProducts()}),t.qZA()(),t.TgZ(12,"div",6)(13,"button",8),t.NdJ("click",function(){return a.openModalRecipes()}),t.qZA()()()()(),t.TgZ(14,"div",9)(15,"div",10)(16,"div",11)(17,"p-table",12),t.YNc(18,H,7,0,"ng-template",13),t.YNc(19,V,7,2,"ng-template",14),t.YNc(20,j,3,0,"ng-template",15),t.qZA()()()(),t.TgZ(21,"p-dialog",16),t.NdJ("visibleChange",function(d){return a.displayModalProducts=d}),t.TgZ(22,"div",10)(23,"form",17),t.NdJ("ngSubmit",function(){return a.agregarProductos()}),t.TgZ(24,"div",18)(25,"div",19)(26,"label"),t._uU(27,"Producto/Servicio"),t.qZA(),t.TgZ(28,"p-dropdown",20),t.YNc(29,z,3,1,"ng-template",21),t.qZA(),t.YNc(30,E,2,0,"div",22),t.qZA(),t.TgZ(31,"div",19)(32,"label"),t._uU(33,"Cantidad"),t.qZA(),t.TgZ(34,"input",23),t.NdJ("change",function(d){return a.onCantidadChange(d)}),t.qZA(),t.YNc(35,k,2,0,"div",22),t.YNc(36,K,2,0,"div",22),t.qZA(),t.TgZ(37,"div",19),t._UZ(38,"button",24),t.qZA()(),t._UZ(39,"br"),t.qZA()()(),t.TgZ(40,"p-dialog",25),t.NdJ("visibleChange",function(d){return a.displayModalRecipes=d}),t.TgZ(41,"div",10)(42,"form",17),t.NdJ("ngSubmit",function(){return a.agregarRecipes()}),t.TgZ(43,"div",18)(44,"div",19)(45,"label"),t._uU(46,"Receta"),t.qZA(),t.TgZ(47,"p-dropdown",26),t.YNc(48,X,3,1,"ng-template",21),t.qZA(),t.YNc(49,W,2,0,"div",22),t.qZA(),t.TgZ(50,"div",19)(51,"label"),t._uU(52,"Cantidad"),t.qZA(),t._UZ(53,"input",27),t.YNc(54,tt,2,0,"div",22),t.YNc(55,et,2,0,"div",22),t.qZA(),t.TgZ(56,"div",19),t._UZ(57,"button",28),t.qZA()(),t._UZ(58,"br"),t.qZA()()()),2&o&&(t.xp6(17),t.Q6J("value",a.productosAgregados)("tableStyle",t.DdM(28,it))("loading",a.loadingTable)("rows",8),t.xp6(4),t.Akn(t.DdM(29,x)),t.Q6J("visible",a.displayModalProducts)("modal",!0)("draggable",!1)("resizable",!1),t.xp6(2),t.Q6J("formGroup",a.formProducto),t.xp6(5),t.Q6J("options",a.productsData)("autoDisplayFirst",!1),t.xp6(2),t.Q6J("ngIf",a.formProducto.get("producto_id").hasError("required")),t.xp6(5),t.Q6J("ngIf",a.formProducto.get("cantidad").hasError("required")),t.xp6(1),t.Q6J("ngIf",null==a.formProducto.get("cantidad").errors?null:a.formProducto.get("cantidad").errors.min),t.xp6(4),t.Akn(t.DdM(30,x)),t.Q6J("visible",a.displayModalRecipes)("modal",!0)("draggable",!1)("resizable",!1),t.xp6(2),t.Q6J("formGroup",a.formReceta),t.xp6(5),t.Q6J("options",a.recetasData)("autoDisplayFirst",!1),t.xp6(2),t.Q6J("ngIf",a.formReceta.get("receta_id").hasError("required")),t.xp6(5),t.Q6J("ngIf",a.formReceta.get("cantidad").hasError("required")),t.xp6(1),t.Q6J("ngIf",null==a.formReceta.get("cantidad").errors?null:a.formReceta.get("cantidad").errors.min))},dependencies:[u.O5,g.iA,A.jx,p.Hq,p.zx,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.qQ,m.H,h.o,_.Lt,T.V,l.sg,l.u,c.Ro]})}return i})(),ot=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[b.Bz.forChild([{path:"",component:G,canActivate:[C.a],data:{permissions:["dashboard.venta"]}},{path:"sale-detail",component:at,canActivate:[C.a],data:{permissions:["dashboard.venta"]}}]),b.Bz]})}return i})(),nt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({providers:[{provide:f.TP,useClass:J.n,multi:!0},v],imports:[u.ez,ot,g.U$,S.O,l.u5,p.hJ,m.T,q.EV,y.V,P.Xt,h.j,U.A,_.kW,D.cc,R.L$,T.S,N.ii.forRoot(),l.UX,c.ef,F.U,I.dp]})}return i})()}}]);