"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[14],{9014:(k,g,o)=>{o.r(g),o.d(g,{InvoiceModule:()=>R});var r=o(6814),h=o(9862),c=o(8672),p=o(707),m=o(9664),b=o(6068),d=o(3714),T=o(8712),f=o(4444),t=o(4946);let v=(()=>{class i{constructor(e){this.httpClient=e,this.baseUrl=f.D.url,this.endPointAnular="/facturaAnular",this.endPointListar="/facturaListar"}getAll(e,n=1,a=""){return this.httpClient.post(`${this.baseUrl+this.endPointListar}?page=${n}&per_page=${e}&search=${a}`,{})}anular(e){return this.httpClient.post(`${this.baseUrl+this.endPointAnular}?=${e.id}`,e)}static#t=this.\u0275fac=function(n){return new(n||i)(t.LFG(h.eN))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var A=o(3519),u=o.n(A),x=o(2791),_=o(6401),C=o(5219);function I(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",20)(1,"h5",21),t._uU(2,"Facturas"),t.qZA(),t.TgZ(3,"span",22)(4,"form",23)(5,"div",24)(6,"input",25),t.NdJ("input",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.searchInput())}),t.qZA(),t.TgZ(7,"button",26),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.search(a.dt))}),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(4),t.Q6J("formGroup",e.formSearch)}}function U(i,s){1&i&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Concepto"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Secuencia interna"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Secuencia externa"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Total"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Subtotal"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Nombre del hotel"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Cliente"),t.qZA()())}function P(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"p-button",30),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.confirmDelete(a.id))}),t.qZA()}}function y(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"number"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t._UZ(17,"t"),t.TgZ(18,"td",27),t._UZ(19,"p-confirmDialog"),t.YNc(20,P,1,0,"p-button",28),t.TgZ(21,"p-button",29),t.NdJ("click",function(){const l=t.CHM(e).$implicit,B=t.oxw();return t.KtG(B.confirmAbrirPdf(l.id))}),t.qZA()()()}if(2&i){const e=s.$implicit,n=t.oxw();t.xp6(2),t.Oqu(e.concepto),t.xp6(2),t.Oqu(e.secuencia_factura_interna),t.xp6(2),t.Oqu(e.secuencia_factura_externa||"No hay secuencia externa"),t.xp6(2),t.Oqu(t.lcZ(9,8,e.total)),t.xp6(3),t.Oqu(t.lcZ(12,10,e.sub_total)),t.xp6(3),t.Oqu(e.hotel.nombre),t.xp6(2),t.Oqu(e.cliente.nombres+" "+e.cliente.apellidos),t.xp6(4),t.Q6J("ngIf",n.permisoEliminar)}}function w(i,s){1&i&&(t.TgZ(0,"tr")(1,"td",31),t._uU(2," Cargando informaci\xf3n, por favor espere... "),t.qZA()())}const F=function(){return{"min-width":"50rem"}},J=function(){return["concepto","secuencia_factura_interna","total","sub_total","hotel","cliente","apellidos"]};let q=(()=>{class i{constructor(e,n,a){this.invoiceService=e,this.spinner=n,this.appComponent=a,this.permisoCrear=x.e.hasPermission(["administracion.facturacion.crear"]),this.permisoEliminar=x.e.hasPermission(["administracion.facturacion.eliminar"]),this.loadingTable=!1,this.pageCount=10,this.ultimaPage=1,this.disablePageRight=!1,this.pageActual=1,this.disablePageLeft=!1}ngOnInit(){this.getIndex(),this.baseUrl=f.D.url,this.token=this.appComponent.getToken()}getIndex(e="",n=this.pageCount,a=1){this.spinner.show(),this.loadingTable=!0,this.invoiceService.getAll(n,a,e).subscribe(l=>{this.loadingTable=!1,this.roomsData=l.data,this.countRegisters=l.total,this.ultimaPage=l.last_page,l.total>n&&(this.disablePageRight=!0),this.validatePage(),this.spinner.hide()},l=>{console.log("Error",l),this.spinner.hide()})}searchInput(){let e=this.formSearch.get("search").value;""==e&&this.getIndex(e)}search(e){let n=this.formSearch.get("search").value;this.getIndex(n)}confirmDelete(e){u().fire({title:"Quieres anular esta factura?",text:"Ten cuidado, esta acci\xf3n no se puede revertir",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(n=>{n.isConfirmed&&(this.spinner.show(),this.invoiceService.anular({id:e}).subscribe(a=>{this.spinner.hide(),"success"==a.code?(u().fire({title:"Exito",text:"Factura anulada exitosamente",icon:"success"}),this.getIndex()):u().fire({title:"Error",text:"Error al anular la factura",icon:"error"})},a=>{console.log("Error: ",a)}))})}leftTable(){this.pageActual=this.pageActual-1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}confirmAbrirPdf(e){window.open(this.baseUrl+"/facturaRemisionPdf/"+e+"?token="+this.token,"_blank")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(v),t.Y36(c.t2),t.Y36(_.y))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-invoice"]],decls:23,vars:11,consts:[["type","ball-scale-multiple"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"mt-3","lg:mt-0"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","hotel",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[1,"flex","gap-2"],["icon","pi pi-trash","severity","danger",3,"click",4,"ngIf"],["icon","pi pi-file-pdf","severity","danger",3,"click"],["icon","pi pi-trash","severity","danger",3,"click"],["colspan","8"]],template:function(n,a){1&n&&(t._UZ(0,"ngx-spinner",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),t._uU(5,"Facturaci\xf3n"),t.qZA(),t.TgZ(6,"div",4),t._UZ(7,"div",5),t.qZA()(),t._UZ(8,"div",6),t.qZA()(),t.TgZ(9,"div",7)(10,"div",8)(11,"div",9)(12,"p-table",10),t.YNc(13,I,8,1,"ng-template",11),t.YNc(14,U,15,0,"ng-template",12),t.YNc(15,y,22,12,"ng-template",13),t.YNc(16,w,3,0,"ng-template",14),t.qZA(),t._UZ(17,"br"),t.TgZ(18,"div",15)(19,"span",16)(20,"button",17),t.NdJ("click",function(){return a.leftTable()}),t.qZA(),t._UZ(21,"button",18),t.TgZ(22,"button",19),t.NdJ("click",function(){return a.rightTable()}),t.qZA()()()()()()),2&n&&(t.xp6(12),t.Q6J("value",a.roomsData)("tableStyle",t.DdM(9,F))("loading",a.loadingTable)("rows",8)("globalFilterFields",t.DdM(10,J))("rowHover",!0),t.xp6(8),t.Q6J("disabled",!a.disablePageLeft),t.xp6(1),t.Q6J("label",a.pageActual),t.xp6(1),t.Q6J("disabled",!a.disablePageRight))},dependencies:[r.O5,c.Ro,p.Hq,p.zx,C.jx,m.iA,d.o,r.JJ]})}return i})();var Z=o(86),N=o(2506);let S=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[Z.Bz.forChild([{path:"",component:q,canActivate:[N.a],data:{permissions:["administracion.facturacion"]}}]),Z.Bz]})}return i})(),R=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({providers:[{provide:h.TP,useClass:T.n,multi:!0},v],imports:[S,r.ez,c.ef,p.hJ,m.U$,b.O,d.j]})}return i})()}}]);