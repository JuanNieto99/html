"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[640],{7640:(N,R,s)=>{s.r(R),s.d(R,{SaleModule:()=>Kt});var _=s(177),n=s(4341),b=s(3386),k=s(5493),E=s(1141),F=s(563),D=s(9998),j=s(1830),G=s(4714),M=s(2242),A=s(1305),u=s(9883),P=s(494),I=s(981),y=s(1570),x=s(1626),w=s(635),m=s(4058),T=s(6554),d=s(6627),h=s(2011),c=s(306),t=s(540);let C=(()=>{class o{constructor(e){this.httpClient=e,this.baseUrl=c.T.url,this.endpointListar="/ventasListar",this.endpointProductsGet="/getDatosVentasCrear",this.endpointVentasCrear="/crearVenta",this.endpointVentasDelete="/eliminarVenta",this.endpointHabitaciones="/ventas/habitaciones-ocupadas",this.endpointCargarItems="/cargarItemsAHabitacion"}getAll(e,a="",i=1){const r={headers:new x.Lr({"Content-Type":"application/json"})};return this.httpClient.post(`${this.baseUrl+this.endpointListar}?per_page=${e}&page=${i}&search=${a}`,r)}deleteSale(e){return this.httpClient.post(`${this.baseUrl+this.endpointVentasDelete}`,e)}getDatosVentasCrear(){return this.httpClient.get(`${this.baseUrl+this.endpointProductsGet}`)}createVentas(e){return this.httpClient.post(`${this.baseUrl+this.endpointVentasCrear}`,e)}getHabitacionesOcupadas(e){return this.httpClient.get(`${this.baseUrl+this.endpointHabitaciones}?cliente_id=${e}`)}cargarItemsAHabitacion(e){return this.httpClient.post(`${this.baseUrl}${this.endpointCargarItems}`,e)}static{this.\u0275fac=function(a){return new(a||o)(t.KVO(x.Qq))}}static{this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var v=s(3091),V=s(8032),S=s.n(V),U=s(7693),Z=s(92),X=s(5779),H=s(7927);function q(o,p){if(1&o){const e=t.RV6();t.j41(0,"div",21),t.nrm(1,"span"),t.j41(2,"span",22)(3,"form",23)(4,"div",24)(5,"input",25),t.bIt("keyup.enter",function(i){t.eBV(e);const r=t.XpG();return t.Njj(r.buscarPorTecla(i))})("input",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.searchInput())}),t.k0s(),t.j41(6,"button",26),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.search())}),t.k0s()()()()()}if(2&o){const e=t.XpG();t.R7$(3),t.Y8G("formGroup",e.formSearch)}}function tt(o,p){1&o&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Hotel"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Recibo interno"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Usuario"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Total"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Subtotal"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Estado"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Acciones"),t.k0s()())}function et(o,p){if(1&o){const e=t.RV6();t.j41(0,"p-button",31),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,r=t.XpG();return t.Njj(r.confirmAbrirPdf(i.id))}),t.k0s()}}function it(o,p){if(1&o){const e=t.RV6();t.j41(0,"p-button",32),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,r=t.XpG();return t.Njj(r.confirmDelete(i.id))}),t.k0s()}}function nt(o,p){if(1&o&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.nI1(9,"currencyFormat"),t.k0s(),t.j41(10,"td"),t.EFF(11),t.nI1(12,"currencyFormat"),t.k0s(),t.j41(13,"td"),t.EFF(14),t.k0s(),t.j41(15,"td",27),t.DNE(16,et,1,0,"p-button",28),t.DNE(17,it,1,0,"p-button",29),t.j41(18,"button",30),t.EFF(19,"."),t.k0s()()()),2&o){const e=p.$implicit,a=t.XpG();t.R7$(2),t.JRh(e.hotel.nombre),t.R7$(2),t.JRh(e.secuencia_interna),t.R7$(2),t.JRh(e.usuario.usuario),t.R7$(2),t.JRh(t.bMT(9,8,e.total)),t.R7$(3),t.JRh(t.bMT(12,10,e.subtotal)),t.R7$(3),t.JRh(a.getEstado(e.estado_id)),t.R7$(2),t.Y8G("ngIf",0!==e.estado_id),t.R7$(1),t.Y8G("ngIf",0!==e.estado_id||a.permisoEliminar)}}function ot(o,p){1&o&&(t.j41(0,"tr")(1,"td",33),t.EFF(2,"Cargando informacion porfavor espere ..."),t.k0s()())}const at=function(){return{"min-width":"50rem"}},st=function(){return["nombre","Hotel","acciones"]};let rt=(()=>{class o{constructor(e,a,i,r,l,f){this.FB=e,this.spinner=a,this.SaleService=i,this.router=r,this.layoutService=l,this.appComponent=f,this.loadingTable=!1,this.pageCount=10,this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1,this.first=0,this.rows=8}ngOnInit(){this.buildForm(),this.getIndex(),this.baseUrl=c.T.url,this.token=this.appComponent.getToken()}buildForm(){this.formSearch=this.FB.group({search:["",[]]})}redirectToCrearVenta(){this.router.navigate(["dashboard/dashboardSell/sale-detail"])}getEstado(e){switch(e){case 1:return"Activa";case 0:return"Anulada";default:return"Desconocido"}}getIndex(e="",a=this.pageCount,i=1){this.spinner.show(),this.loadingTable=!0,this.SaleService.getAll(a,e,i).subscribe(r=>{this.loadingTable=!1,this.salesData=r.data,this.countRegisters=r.total,this.ultimaPage=r.last_page,r.total>a&&(this.disablePageRight=!0),this.validatePage(),this.spinner.hide()},r=>{console.log("Error: ",r),this.spinner.hide()})}confirmDelete(e){S().fire({title:"\xbfEstas seguro que deseas anular esta venta?",text:"Ten cuidado esta acci\xf3n no se prodr\xe1 reversar",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(a=>{a.isConfirmed&&(this.spinner.show(),this.SaleService.deleteSale({id:e}).subscribe(i=>{this.spinner.hide(),"success"==i.code?(S().fire({title:"Exito",text:"Venta anulada exitosamente.",icon:"success"}),this.getIndex(),this.layoutService.reloadComponent()):S().fire({title:"Error",text:"Error al anular la venta.",icon:"error"})},i=>{console.log("Error: ",i)}))})}onPage(e){this.pageCount=e.rows,this.getIndex("",this.pageCount)}searchInput(){let e=this.formSearch.get("search").value;this.pageActual=1,""==e&&this.getIndex(e)}buscarPorTecla(e){"Enter"==e.code&&this.search()}search(){let e=this.formSearch.get("search").value;this.getIndex(e)}onPageChange(e){this.first=e.first,this.rows=e.rows}leftTable(){this.pageActual=this.pageActual-1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}confirmAbrirPdf(e){console.log(e),window.open(this.baseUrl+"/ventasPdf/"+e+"?token="+this.token,"_blank")}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(n.ok),t.rXU(T.ex),t.rXU(C),t.rXU(v.Ix),t.rXU(U.Y),t.rXU(Z.Z))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-sale"]],decls:24,vars:11,consts:[["type","ball-scale-multiple","size","large","bdColor","rgba(192,192,192,0.8)","template","<img src='assets/loading/cargando.gif' />"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Crear","icon","",1,"p-button-outlined","mr-2",3,"click"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"keyup.enter","input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[1,"flex","gap-1"],["icon","pi pi-file-pdf","severity","danger",3,"click",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"click",4,"ngIf"],["disabled","",2,"visibility","hidden"],["icon","pi pi-file-pdf","severity","danger",3,"click"],["icon","pi pi-trash","severity","danger",3,"click"],["colspan","8"]],template:function(a,i){1&a&&(t.nrm(0,"ngx-spinner",0),t.j41(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),t.EFF(5,"Ventas"),t.k0s(),t.j41(6,"div",4),t.nrm(7,"div",5),t.k0s()(),t.j41(8,"div",6)(9,"button",7),t.bIt("click",function(){return i.redirectToCrearVenta()}),t.k0s()()()(),t.j41(10,"div",8)(11,"div",9)(12,"div",10)(13,"p-table",11),t.bIt("onPage",function(l){return i.onPage(l)}),t.DNE(14,q,7,1,"ng-template",12),t.DNE(15,tt,15,0,"ng-template",13),t.DNE(16,nt,20,12,"ng-template",14),t.DNE(17,ot,3,0,"ng-template",15),t.k0s(),t.nrm(18,"br"),t.j41(19,"div",16)(20,"span",17)(21,"button",18),t.bIt("click",function(){return i.leftTable()}),t.k0s(),t.nrm(22,"button",19),t.j41(23,"button",20),t.bIt("click",function(){return i.rightTable()}),t.k0s()()()()()()),2&a&&(t.R7$(13),t.Y8G("value",i.salesData)("tableStyle",t.lJ4(9,at))("loading",i.loadingTable)("rows",8)("globalFilterFields",t.lJ4(10,st))("rowHover",!0),t.R7$(8),t.Y8G("disabled",!i.disablePageLeft),t.R7$(1),t.Y8G("label",i.pageActual),t.R7$(1),t.Y8G("disabled",!i.disablePageRight))},dependencies:[_.bT,b.XI,X.Ei,E._f,E.$n,n.qT,n.me,n.BC,n.cb,F.n,M.S,n.j4,n.JD,T.et,H.l]})}}return o})();var L=s(1765),J=s(6296),K=s(935),lt=s(2435),W=s(5114),z=s(1631);function ct(o,p){if(1&o&&(t.j41(0,"div",64)(1,"span",65),t.EFF(2),t.k0s()()),2&o){const e=p.$implicit;t.R7$(2),t.E5c(" ",e.numero_documento," ",e.nombres," ",e.apellidos,"")}}function dt(o,p){if(1&o){const e=t.RV6();t.j41(0,"button",66),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.crearCliente())}),t.k0s()}}function pt(o,p){1&o&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Categor\xeda"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Total"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Acci\xf3n"),t.k0s()())}function mt(o,p){if(1&o){const e=t.RV6();t.j41(0,"td")(1,"button",69),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,r=t.XpG();return t.Njj(r.modals(i.nombre))}),t.k0s()()}}function ut(o,p){1&o&&t.nrm(0,"td")}function gt(o,p){if(1&o&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"currencyFormat"),t.k0s(),t.DNE(6,mt,2,0,"td",67),t.DNE(7,ut,1,0,"ng-template",null,68,t.C5r),t.k0s()),2&o){const e=p.$implicit,a=t.sdS(8);t.R7$(2),t.JRh(e.nombre),t.R7$(2),t.SpI("$",t.bMT(5,4,e.total),""),t.R7$(2),t.Y8G("ngIf",e.accion)("ngIfElse",a)}}function _t(o,p){1&o&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Nombre"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Precio"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Impuesto"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Cantidad"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Total"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Acciones"),t.k0s()())}function ht(o,p){1&o&&(t.j41(0,"span",72),t.EFF(1,"*"),t.k0s())}function ft(o,p){if(1&o){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.nI1(3,"titlecase"),t.k0s(),t.j41(4,"td"),t.EFF(5),t.nI1(6,"currencyFormat"),t.k0s(),t.j41(7,"td"),t.EFF(8),t.nI1(9,"currencyFormat"),t.k0s(),t.j41(10,"td"),t.EFF(11),t.DNE(12,ht,2,0,"span",70),t.k0s(),t.j41(13,"td"),t.EFF(14),t.nI1(15,"currencyFormat"),t.k0s(),t.j41(16,"td")(17,"p-button",71),t.bIt("click",function(){const r=t.eBV(e).$implicit,l=t.XpG();return t.Njj(l.eliminarProducto(r))}),t.k0s()()()}if(2&o){const e=p.$implicit;t.R7$(2),t.JRh(t.bMT(3,6,e.nombre)),t.R7$(3),t.SpI("$",t.bMT(6,8,e.subtotal),""),t.R7$(3),t.SpI("$",t.bMT(9,10,e.impuestos),""),t.R7$(3),t.JRh(e.cantidad),t.R7$(1),t.Y8G("ngIf",e.stockModificado),t.R7$(2),t.SpI("$",t.bMT(15,12,e.total),"")}}function bt(o,p){1&o&&(t.j41(0,"tr")(1,"td",76)(2,"span"),t.EFF(3,"*"),t.k0s(),t.EFF(4," El stock de estos productos ha sido actualizado. "),t.k0s()())}function vt(o,p){if(1&o&&(t.j41(0,"tr")(1,"td",73),t.EFF(2,"Totales:"),t.k0s(),t.j41(3,"td",73),t.EFF(4),t.nI1(5,"currencyFormat"),t.k0s(),t.j41(6,"td",74),t.EFF(7),t.nI1(8,"currencyFormat"),t.k0s(),t.j41(9,"td",74),t.EFF(10),t.nI1(11,"currencyFormat"),t.k0s()(),t.DNE(12,bt,5,0,"tr",75)),2&o){const e=t.XpG();t.R7$(4),t.SpI(" $",t.bMT(5,4,e.totalProductos-e.totalProductosImpuestos),""),t.R7$(3),t.SpI(" $",t.bMT(8,6,e.totalProductosImpuestos),""),t.R7$(3),t.SpI(" $",t.bMT(11,8,e.totalProductos),""),t.R7$(2),t.Y8G("ngIf",e.stockProductoModificado&&e.productosAgregados.length>0)}}function Ct(o,p){1&o&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Nombre"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Precio"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Impuesto"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Cantidad"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Total"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Acciones"),t.k0s()())}function It(o,p){if(1&o){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.nI1(3,"titlecase"),t.k0s(),t.j41(4,"td"),t.EFF(5),t.nI1(6,"currencyFormat"),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.nI1(13,"currencyFormat"),t.k0s(),t.j41(14,"td")(15,"p-button",71),t.bIt("click",function(){const r=t.eBV(e).$implicit,l=t.XpG();return t.Njj(l.eliminarReceta(r))}),t.k0s()()()}if(2&o){const e=p.$implicit;t.R7$(2),t.JRh(t.bMT(3,5,e.nombre)),t.R7$(3),t.SpI("$",t.bMT(6,7,e.subtotal),""),t.R7$(3),t.SpI("$",e.impuestos,""),t.R7$(2),t.JRh(e.cantidad),t.R7$(2),t.SpI("$",t.bMT(13,9,e.total),"")}}function Tt(o,p){if(1&o&&(t.j41(0,"tr")(1,"td",73),t.EFF(2,"Totales:"),t.k0s(),t.j41(3,"td",73),t.EFF(4),t.nI1(5,"currencyFormat"),t.k0s(),t.j41(6,"td",74),t.EFF(7),t.nI1(8,"currencyFormat"),t.k0s(),t.j41(9,"td",73),t.EFF(10),t.nI1(11,"currencyFormat"),t.k0s(),t.j41(12,"td"),t.EFF(13,"\xa0"),t.k0s()()),2&o){const e=t.XpG();t.R7$(4),t.SpI(" $",t.bMT(5,3,e.totalRecetas-e.totalRecetasImpuestos),""),t.R7$(3),t.SpI(" $",t.bMT(8,5,e.totalRecetasImpuestos),""),t.R7$(3),t.SpI(" $",t.bMT(11,7,e.totalRecetas),"")}}function Et(o,p){if(1&o&&(t.j41(0,"div",77)(1,"span",65),t.EFF(2),t.nI1(3,"titlecase"),t.k0s(),t.j41(4,"div"),t.nrm(5,"p-tag",78),t.nI1(6,"currencyFormat"),t.nrm(7,"p-tag",78),t.k0s()()),2&o){const e=p.$implicit;t.R7$(2),t.JRh(t.bMT(3,3,e.nombre)),t.R7$(3),t.Mz_("value","$",t.bMT(6,5,e.precioTotal),""),t.R7$(2),t.Mz_("value","Stock: ",1==e.sin_limite_cantidad?e.stockActual:"Ilimitado","")}}function yt(o,p){1&o&&(t.j41(0,"span",80),t.EFF(1,"Producto es requerido."),t.k0s())}function Ft(o,p){if(1&o&&(t.j41(0,"div",79),t.DNE(1,yt,2,0,"span",36),t.k0s()),2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formProducto.get("producto_id").hasError("required"))}}function xt(o,p){1&o&&(t.j41(0,"div",80),t.EFF(1,"Campo requerido"),t.k0s())}function kt(o,p){1&o&&(t.j41(0,"div",81),t.EFF(1,"La cantidad excede el stock disponible."),t.k0s())}function Rt(o,p){if(1&o&&(t.j41(0,"div",77)(1,"span",65),t.EFF(2),t.k0s(),t.nrm(3,"p-tag",78),t.nI1(4,"currencyFormat"),t.k0s()),2&o){const e=p.$implicit;t.R7$(2),t.JRh(e.nombre),t.R7$(1),t.Mz_("value","$",t.bMT(4,2,e.precioTotal),"")}}function St(o,p){1&o&&(t.j41(0,"span",80),t.EFF(1,"Receta es requerida."),t.k0s())}function Dt(o,p){if(1&o&&(t.j41(0,"div",79),t.DNE(1,St,2,0,"span",36),t.k0s()),2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formReceta.get("receta_id").hasError("required"))}}function Pt(o,p){1&o&&(t.j41(0,"div",80),t.EFF(1,"Campo requerido"),t.k0s())}function jt(o,p){1&o&&(t.j41(0,"div",82),t.EFF(1,"La cantidad excede el stock disponible."),t.k0s())}function Mt(o,p){if(1&o&&(t.j41(0,"div",64)(1,"span",65),t.EFF(2),t.k0s()()),2&o){const e=p.$implicit;t.R7$(2),t.JRh(e.nombre)}}function $t(o,p){1&o&&(t.j41(0,"div",80),t.EFF(1,"Campo requerido"),t.k0s())}function Gt(o,p){if(1&o){const e=t.RV6();t.j41(0,"div",89)(1,"p-button",90),t.bIt("click",function(){t.eBV(e);const i=t.XpG().index,r=t.XpG();return t.Njj(r.eliminarMetodoPago(i))}),t.k0s()()}}function At(o,p){if(1&o){const e=t.RV6();t.j41(0,"div",83)(1,"div",84)(2,"label"),t.EFF(3,"M\xe9todo de Pago"),t.k0s(),t.nrm(4,"input",85),t.k0s(),t.j41(5,"div",86)(6,"label"),t.EFF(7,"Valor"),t.k0s(),t.j41(8,"input",87),t.bIt("blur",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.calcularTotalMetodosPago())}),t.k0s(),t.DNE(9,$t,2,0,"div",36),t.k0s(),t.DNE(10,Gt,2,0,"div",88),t.k0s()}if(2&o){const e=p.$implicit,a=p.index,i=t.XpG();t.Y8G("formGroupName",a),t.R7$(9),t.Y8G("ngIf",e.get("valor").hasError("required")),t.R7$(1),t.Y8G("ngIf",i.metodosPago.controls.length>1)}}function wt(o,p){1&o&&(t.j41(0,"div",91),t.nrm(1,"p-message",92),t.k0s())}const Nt=function(o){return{"selected-card":o}};function Bt(o,p){if(1&o){const e=t.RV6();t.j41(0,"div",93)(1,"div",94),t.bIt("click",function(){const r=t.eBV(e).$implicit,l=t.XpG();return t.Njj(l.seleccionarHabitacion(r.id))}),t.j41(2,"div",95)(3,"h4"),t.EFF(4),t.k0s()()()()}if(2&o){const e=p.$implicit,a=t.XpG();t.R7$(1),t.Y8G("ngClass",t.eq3(2,Nt,a.habitacionSeleccionada===e.id)),t.R7$(3),t.JRh(e.nombre)}}function Ot(o,p){if(1&o){const e=t.RV6();t.j41(0,"app-clientes",96,97),t.bIt("clienteCreado",function(i){t.eBV(e);const r=t.XpG();return t.Njj(r.handleClienteCreado(i))}),t.k0s()}if(2&o){const e=t.XpG();t.Y8G("vieneDeHabitaciones",e.creandoCliente)}}const Yt=function(){return{"min-width":"20rem"}},Q=function(){return{"min-width":"35rem"}},O=function(){return{width:"60vw"}},Vt=function(){return{width:"50vw"}};let Ut=(()=>{class o{constructor(e,a,i,r,l){this.FB=e,this.spinner=a,this.saleService=i,this.router=r,this.layoutService=l,this.loadingTable=!1,this.clienteData=[],this.validacionStock=!1,this.habitacionesOcupadas=[],this.selectedClienteId=null,this.mostrarModal=!1,this.habitacionSeleccionada=null,this.unaHabitacion=!1,this.productosAgregados=[],this.recetasAgregadas=[],this.totalProductos=0,this.totalProductosImpuestos=0,this.totalRecetas=0,this.totalRecetasImpuestos=0,this.totalImpuestos=0,this.subtotal=0,this.total=0,this.totales=[{nombre:"Productos/Servicios",total:this.totalProductos-this.totalProductosImpuestos,accion:!0},{nombre:"Recetas",total:this.totalRecetas-this.totalRecetasImpuestos,accion:!0},{nombre:"Impuestos",total:this.totalImpuestos},{nombre:"Subtotal",total:this.subtotal},{nombre:"Total",total:this.total}],this.recetasData=[],this.displayModalRecipes=!1,this.productsData=[],this.displayModalProducts=!1,this.dataMetodosPago=[],this.displayModalMetodosPago=!1,this.montoSinRedondear=0,this.excedente=0,this.activarRedondear=!1,this.stockProductoModificado=!1,this.creandoCliente=!1,this.totalMetodosPago=0,this.buildForm()}ngOnInit(){this.spinner.hide(),this.buildForm(),this.loadData()}buildForm(){this.formCliente=this.FB.group({cliente_id:[null,[]]}),this.formHabitaciones=this.FB.group({habitacion_id:[null,[]]}),this.formProducto=this.FB.group({producto_id:[null,n.k0.required],cantidad:[1,[n.k0.required,n.k0.min(1)]]}),this.formReceta=this.FB.group({receta_id:[null,n.k0.required],cantidad:[1,[n.k0.required,n.k0.min(1)]]}),this.formMetodoPago=this.FB.group({metodos_pago:this.FB.array([]),cambio:[0,n.k0.required]}),this.agregarMetodoPago({value:{id:1,nombre:"Efectivo"}}),this.formFacturar=this.FB.group({isFacturaElectronica:[""]})}crearCliente(){this.creandoCliente=!0}handleClienteCreado(e){this.creandoCliente=!1,e&&this.loadData()}get metodosPago(){return this.formMetodoPago.get("metodos_pago")}agregarMetodoPago(e){if(this.metodosPago.controls.find(i=>i.get("metodo_pago_id").value===e.value.id))return;const a=this.FB.group({metodo_pago_id:[e.value.id,n.k0.required],valor:[null,[n.k0.required,n.k0.min(1)]],nombre:[e.value.nombre]});a.get("nombre").disable(),this.metodosPago.push(a)}eliminarMetodoPago(e){this.metodosPago.removeAt(e)}calcularTotalMetodosPago(){this.totalMetodosPago=0,this.metodosPago.controls.forEach(e=>{let a=e.get("valor").value;isNaN(a)&&(a=0),this.totalMetodosPago+=a})}submitFactura(){this.formMetodoPago.valid&&(this.displayModalMetodosPago=!1,this.calcularTotales())}loadData(){this.spinner.show(),this.saleService.getDatosVentasCrear().subscribe(e=>{function a(i){const r=parseFloat(i.precio);let l=0;return i.impuestos.forEach(f=>{const g=r*(Number(f.impuesto.porcentaje)/100);l+=g}),r+l}this.spinner.hide(),this.productsData=e.productos.map(i=>({...i,precioTotal:a(i),tipo_servicio_id:1===i.tipo_producto?1:2,stockModificado:!1})),this.recetasData=e.recetas.map(i=>({...i,precioTotal:a(i),tipo_servicio_id:4})),this.clienteData=e.clientes,this.habitacionesOcupadas=e.habitaciones,this.dataMetodosPago=e.metodosPago},e=>{console.error(e)})}agregarProductos(){const e=this.formProducto.get("producto_id").value,a=this.formProducto.get("cantidad").value,i=parseFloat(e.precio),r=i*e.impuestos_total/100,l=(i+r)*a,f={...e,cantidad:Number(a),subtotal:i,total:l,stockModificado:!1,impuestos:r};if(this.productosAgregados.some(g=>g.id===f.id)){const g=this.productosAgregados.findIndex($=>$.id===f.id);this.productosAgregados[g].cantidad+=f.cantidad,this.productosAgregados[g].total+=f.total}else this.productosAgregados.push(f);this.productsData.find(g=>g.id===f.id).stockActual-=a,this.stockProductoModificado=this.productosAgregados.some(g=>1==g.stockModificado),this.calcularTotales(),this.displayModalProducts=!1,this.formProducto.reset()}validarStock(e){if("producto"==e&&this.formProducto.valid){const a=this.formProducto.get("producto_id").value,i=this.formProducto.get("cantidad").value;this.validacionStock=a.stockActual<i&&1==a.sin_limite_cantidad}}eliminarProducto(e){const a=this.productosAgregados.indexOf(e);a>-1&&(this.productosAgregados.splice(a,1),this.productsData.find(i=>i.id===e.id).stockActual+=e.cantidad),this.stockProductoModificado=this.productosAgregados.some(i=>1==i.stockModificado),this.calcularTotales()}agregarRecetas(){const e=this.formReceta.get("receta_id").value,a=this.formReceta.get("cantidad").value,i=parseFloat(e.precio),r=i*e.impuestos_total/100,l=(i+r)*a,f={...e,cantidad:a,subtotal:i,total:l,impuestos:r};if(this.recetasAgregadas.some(g=>g.id===f.id)){const g=this.recetasAgregadas.findIndex($=>$.id===f.id);this.recetasAgregadas[g].total+=f.total,this.recetasAgregadas[g].cantidad+=f.cantidad}else this.recetasAgregadas.push(f);this.calcularTotales(),this.displayModalRecipes=!1,this.formReceta.reset()}eliminarReceta(e){const a=this.recetasAgregadas.findIndex(i=>i.id===e.id);-1!==a?this.recetasAgregadas.splice(a,1):console.error(`No se encontr\xf3 la receta con id ${e.id} en recetasAgregadas`),this.calcularTotales()}calcularTotales(){this.totalProductos=this.productosAgregados.reduce((a,i)=>a+i.total,0),this.totalProductosImpuestos=this.productosAgregados.reduce((a,i)=>a+i.impuestos*i.cantidad,0),this.totalRecetas=this.recetasAgregadas.reduce((a,i)=>a+i.total,0),this.totalRecetasImpuestos=this.recetasAgregadas.reduce((a,i)=>a+i.impuestos*i.cantidad,0),this.totalImpuestos=this.totalProductosImpuestos+this.totalRecetasImpuestos,this.subtotal=this.totalProductos-this.totalProductosImpuestos+(this.totalRecetas-this.totalRecetasImpuestos),this.total=this.subtotal+this.totalImpuestos,this.totales=[{nombre:"Productos/Servicios",total:this.totalProductos-this.totalProductosImpuestos,accion:!0},{nombre:"Recetas",total:this.totalRecetas-this.totalRecetasImpuestos,accion:!0},{nombre:"Impuestos",total:this.totalImpuestos},{nombre:"Subtotal",total:this.subtotal},{nombre:"Total",total:this.total}],this.activarRedondear?(this.montoSinRedondear=this.total,this.total=function e(a){let i=a%50,r=0;return i>0&&(r=50-i),a+r}(this.total),this.excedente=this.total-this.montoSinRedondear,this.totales[4]={nombre:"Total sin redondear",total:this.montoSinRedondear},this.totales.push({nombre:"Excedente",total:this.excedente}),this.totales.push({nombre:"Total",total:this.total})):(this.excedente=0,this.totales=this.totales.filter(a=>"Total sin redondear"!==a.nombre||"Excedente"!==a.nombre))}modals(e){switch(e){case"Productos/Servicios":this.formProducto.reset(),this.displayModalProducts=!0,this.validacionStock=!1;break;case"Recetas":this.formReceta.reset(),this.displayModalRecipes=!0,this.validacionStock=!1;break;case"Pagar":this.displayModalMetodosPago=!0}}submitFacturaElectronica(){}crearVenta(){this.spinner.show();const e=[...this.productosAgregados,...this.recetasAgregadas];if(!Array.isArray(e))return this.spinner.hide(),void S().fire({title:"Error",text:"Hubo un error al preparar los detalles de la venta.",icon:"error"});let a={cliente_id:this.formCliente.get("cliente_id").value?parseInt(this.formCliente.get("cliente_id").value[0].id):null,total:this.total,subtotal:this.subtotal,excedente:this.excedente,total_impuestos:this.totalImpuestos,estado_id:1};const i=new FormData;for(const l in a)a.hasOwnProperty(l)&&i.append(l,a[l]);e.forEach((l,f)=>{l.consumo_id=l.id,l.valor_consumo=l.subtotal,l.tipo_consumo=l.tipo_servicio_id,l.valor_impuesto=l.impuestos||0;for(const g in l)l.hasOwnProperty(g)&&i.append(`detalles_venta[${f}][${g}]`,l[g])}),this.formMetodoPago.get("metodos_pago").value.forEach((l,f)=>{for(const g in l)l.hasOwnProperty(g)&&i.append(`metodos_pago[${f}][${g}]`,l[g])}),this.saleService.createVentas(i).subscribe(l=>{this.spinner.hide(),l.venta?(this.formCliente.reset(),this.productosAgregados=[],this.recetasAgregadas=[],this.calcularTotales(),S().fire({title:"Exito",text:"Venta creada exitosamente.",icon:"success"}).then(()=>{this.router.navigate(["/dashboard/dashboardSell"])}),this.layoutService.reloadComponent()):"warning"===l.code?S().fire({title:"Advertencia",text:l.msm,icon:"warning"}):S().fire({title:"Error",text:"Error al crear la venta.",icon:"error"})},l=>{if(400===l.status&&l.error.error.startsWith("Stock insuficiente")){this.spinner.hide(),S().fire({title:"Advertencia",text:l.error.error,icon:"warning"});const f=l.error.productos_sin_stock;this.stockProductoModificado=!0,f.forEach(g=>{const $=this.productsData.find(Y=>Y.id===g.id),B=this.productosAgregados.find(Y=>Y.consumo_id===g.id);$&&($.stockActual=0),B&&(B.cantidad=g.stockActual,B.total=$.precioTotal*B.cantidad,B.stockModificado=!0),this.calcularTotales()})}else this.spinner.hide(),console.error("Error:",l)})}obtenerHabitacionesOcupadas(e){this.saleService.getHabitacionesOcupadas(e).subscribe(a=>{this.habitacionesOcupadas=a,this.habitacionesOcupadas.length>1?(this.unaHabitacion=!1,this.mostrarModal=!1):1===this.habitacionesOcupadas.length?(this.habitacionSeleccionada=this.habitacionesOcupadas[0].id,this.unaHabitacion=!0,this.mostrarModal=!1):(this.unaHabitacion=!1,this.mostrarModal=!1)},a=>{console.error(a)})}onClienteSeleccionado(e){e&&e.length>0?this.obtenerHabitacionesOcupadas(e[0].id):this.resetHabitaciones()}resetHabitaciones(){this.habitacionesOcupadas=[],this.unaHabitacion=!1,this.habitacionSeleccionada=null,this.mostrarModal=!1}seleccionarHabitacion(e){this.habitacionSeleccionada=e,this.mostrarModal=!0,this.unaHabitacion=!0}cargarAHabitacion(){if(this.habitacionSeleccionada&&(this.productosAgregados.length>0||this.recetasAgregadas.length>0)){const e={habitacion_id:this.habitacionSeleccionada,items:[...this.productosAgregados.map(a=>({id:a.id,cantidad:a.cantidad,tipo:this.getTipoId(a.tipo_servicio_id),valor:a.total})),...this.recetasAgregadas.map(a=>({id:a.id,cantidad:a.cantidad,tipo:this.getTipoId(a.tipo_servicio_id),valor:a.total}))]};this.saleService.cargarItemsAHabitacion(e).subscribe(a=>{this.mostrarModal=!1,S().fire("\xc9xito","Items cargados exitosamente a la habitaci\xf3n","success").then(()=>{this.resetHabitaciones(),this.productosAgregados=[],this.recetasAgregadas=[],this.total=0,this.router.navigate(["/dashboard/dashboardSell"])})},a=>{S().fire("Error","Hubo un error al cargar los items a la habitaci\xf3n","error")})}}getTipoId(e){switch(e){case 1:return 1;case 2:return 2;case 4:return 4;default:throw new Error("Tipo desconocido")}}onHabitacionSeleccionada(e){e&&e.length>0?(this.habitacionSeleccionada=e[0].id,this.unaHabitacion=!0):(this.habitacionSeleccionada=null,this.unaHabitacion=!1)}validarSeleccion(){0===this.productosAgregados.length&&0===this.recetasAgregadas.length?S().fire({title:"Atenci\xf3n",text:"Primero deben agregarse productos o recetas.",icon:"warning",confirmButtonText:"OK"}):0===this.habitacionesOcupadas.length?S().fire({title:"Atenci\xf3n",text:"No hay habitaciones disponibles.",icon:"warning",confirmButtonText:"OK"}):this.mostrarModal=!0}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(n.ok),t.rXU(T.ex),t.rXU(C),t.rXU(v.Ix),t.rXU(U.Y))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-sale-detail"]],decls:131,vars:80,consts:[["type","ball-scale-multiple","size","large","bdColor","rgba(192,192,192,0.8)","template","<img src='assets/loading/cargando.gif' />"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-center","flex-column","lg:flex-row"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",1,"p-button-outlined","mr-4",3,"routerLink"],[1,"font-medium","text-3xl","text-900"],[1,"card","mt-3",2,"margin-bottom","14px"],[1,"p-fluid"],[1,"col-12",2,"display","flex","justify-content","space-between","align-items","center","width","100%"],[1,"col-4",2,"display","flex","flex-direction","column",3,"formGroup"],["for","cliente",2,"font-size","large","margin-bottom","15px"],["formControlName","cliente_id","selectionLimit","1","optionLabel","nombres","placeholder","Buscar hu\xe9sped","display","chip","emptyMessage","Cargando hu\xe9spedes...",1,"multiselect-custom",3,"options","onChange"],["pTemplate","item"],["pTemplate","footer"],[1,"col-4",2,"display","flex","flex-direction","column","align-items","center","justify-content","center"],[1,"flex-grow-1","text-right",2,"margin-top","40px"],["pButton","","pRipple","","label","Cargar a habitaci\xf3n",1,"p-button","mr-2",3,"click"],[1,"col-4",2,"display","flex","flex-direction","column","align-items","flex-end","justify-content","flex-end"],[2,"display","flex","flex-direction","column","gap","10px"],[1,"font-medium","text-3xl","text-500"],["pButton","","pRipple","","label","Pagar",1,"p-button","mr-2",2,"width","100%",3,"click"],[1,"grid"],[1,"col-12"],[1,"card",2,"padding","30px","margin-top","0"],[1,"col-12","lg:col-5"],["responsiveLayout","scroll",3,"value","tableStyle","rows"],["pTemplate","header"],["pTemplate","body"],[1,"col-7"],[2,"padding","10px"],["header","Agregar Producto/Servicio",3,"visible","modal","draggable","resizable","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-6","md:col-6"],["formControlName","producto_id","placeholder","Buscar Producto/Servicio","optionLabel","nombre","emptyMessage","Cargando productos...",1,"dropdown-custom",3,"options","onChange"],["style","margin-top: 14px;",4,"ngIf"],["type","number","min","1","formControlName","cantidad","placeholder","Cantidad","pInputText","",1,"w-full","mb-3","border-round-3xl",3,"input"],["style","color: red;",4,"ngIf"],["style","color: orangered;",4,"ngIf"],[1,"field","col-12","md:col-12"],["pButton","","pRipple","","label","Agregar Producto","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"disabled"],["header","Agregar Receta",3,"visible","modal","draggable","resizable","visibleChange"],["formControlName","receta_id","placeholder","Buscar Receta","optionLabel","nombre","emptyMessage","Cargando recetas...",1,"dropdown-custom",3,"options"],["type","number","min","1","formControlName","cantidad","placeholder","Cantidad","pInputText","",1,"w-full","mb-3","border-round-3xl"],["class","field col-12","style","color: red;",4,"ngIf"],["pButton","","pRipple","","label","Agregar Receta","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"disabled"],["header","Facturar",3,"visible","modal","draggable","resizable","visibleChange"],["formArrayName","metodos_pago",1,"p-fluid","p-formgrid","grid"],[1,"field","col-12"],[1,"font-medium","text-2xl","text-500","text-center"],["optionLabel","nombre","emptyMessage","Cargando m\xe9todos de pago...","placeholder","Buscar M\xe9todo de Pago",1,"dropdown-custom",3,"options","autoDisplayFirst","onChange"],["class","grid",3,"formGroupName",4,"ngFor","ngForOf"],["class","col-6","style","padding: 0; margin-top: 15px;",4,"ngIf"],[1,"flex",2,"justify-content","space-between"],[1,"flex","align-items-center",2,"gap","10px"],["severity","info","text","Generar Factura electronica"],["formControlName","isFacturaElectronica"],[1,"flex","flex-column","justify-end",2,"justify-content","end","align-items","end"],[1,"font-medium","text-2xl","text-500","text-right"],["pButton","","pRipple","","icon","",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"label","disabled","click"],["header","Seleccione una habitaci\xf3n",3,"visible","modal","draggable","resizable","visibleChange"],["class","col-6","style","margin-bottom: 10px;",4,"ngFor","ngForOf"],[1,"modal-footer"],["pButton","","pRipple","",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"label","click"],[3,"vieneDeHabitaciones","clienteCreado",4,"ngIf"],[1,"flex","align-items-center"],[1,"ml-2"],["pButton","","pRipple","","label","Registrar nuevo hu\xe9sped","type","button","icon","pi pi-plus",1,"w-full","bg-blue","boder-blue","mb-5","border-round-3xl",3,"click"],[4,"ngIf","ngIfElse"],["emptyTd",""],["pButton","","pRipple","","icon","pi pi-plus",1,"p-button",3,"click"],["style","color: orangered; font-size: xx-large;",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"click"],[2,"color","orangered","font-size","xx-large"],["colspan","1"],["colspan","2"],[4,"ngIf"],["colspan","6",2,"color","orangered"],[1,"flex","align-items-center",2,"display","flex","justify-content","space-between"],[1,"padding",3,"value"],[2,"margin-top","14px"],[2,"color","red"],[2,"color","orangered"],[1,"field","col-12",2,"color","red"],[1,"grid",3,"formGroupName"],[1,"col-6","md:col-5"],["type","text","min","1","formControlName","nombre","placeholder","Metodo de pago","pInputText","","disabled","",1,"w-full","mb-3","border-round-3xl"],[1,"col-4","md:col-5"],["type","number","min","1","formControlName","valor","placeholder","Valor","pInputText","",1,"w-full","mb-3","border-round-3xl",3,"blur"],["class","col-2 mt-4 eliminar-metodo-pago",4,"ngIf"],[1,"col-2","mt-4","eliminar-metodo-pago"],["pRipple","","type","button","icon","pi pi-trash","severity","danger",3,"click"],[1,"col-6",2,"padding","0","margin-top","15px"],["severity","error","text","El total ingresado no es igual al total a pagar"],[1,"col-6",2,"margin-bottom","10px"],[1,"p-card",2,"cursor","pointer",3,"ngClass","click"],[1,"p-card-body"],[3,"vieneDeHabitaciones","clienteCreado"],["clientes",""]],template:function(a,i){1&a&&(t.nrm(0,"ngx-spinner",0),t.j41(1,"div",1)(2,"div",2)(3,"div"),t.nrm(4,"button",3),t.k0s(),t.j41(5,"div")(6,"div",4),t.EFF(7,"Crear venta"),t.k0s()()()(),t.j41(8,"div",5)(9,"p-toolbar",6)(10,"div",7)(11,"div",8)(12,"label",9),t.EFF(13,"Hu\xe9sped"),t.k0s(),t.j41(14,"p-multiSelect",10),t.bIt("onChange",function(l){return i.onClienteSeleccionado(l.value)}),t.DNE(15,ct,3,3,"ng-template",11),t.DNE(16,dt,1,0,"ng-template",12),t.k0s()(),t.j41(17,"div",13)(18,"div",14)(19,"button",15),t.bIt("click",function(){return i.validarSeleccion()}),t.k0s()()(),t.j41(20,"div",16)(21,"div",17)(22,"div",18),t.EFF(23),t.nI1(24,"currencyFormat"),t.k0s(),t.j41(25,"button",19),t.bIt("click",function(){return i.modals("Pagar")}),t.k0s()()()()()(),t.j41(26,"div",20)(27,"div",21)(28,"div",22)(29,"h3"),t.EFF(30,"Detalles de venta"),t.k0s(),t.j41(31,"div",20)(32,"div",23)(33,"p-table",24),t.DNE(34,pt,7,0,"ng-template",25),t.DNE(35,gt,9,6,"ng-template",26),t.k0s()(),t.j41(36,"div",27)(37,"div",28)(38,"h5"),t.EFF(39,"Productos/Servicios"),t.k0s(),t.j41(40,"p-table",24),t.DNE(41,_t,13,0,"ng-template",25),t.DNE(42,ft,18,14,"ng-template",26),t.DNE(43,vt,13,10,"ng-template",12),t.k0s()(),t.nrm(44,"hr"),t.j41(45,"div",28)(46,"h5"),t.EFF(47,"Recetas"),t.k0s(),t.j41(48,"p-table",24),t.DNE(49,Ct,13,0,"ng-template",25),t.DNE(50,It,16,11,"ng-template",26),t.DNE(51,Tt,14,9,"ng-template",12),t.k0s()()()()()()(),t.j41(52,"p-dialog",29),t.bIt("visibleChange",function(l){return i.displayModalProducts=l}),t.j41(53,"div",21)(54,"form",30),t.bIt("ngSubmit",function(){return i.agregarProductos()}),t.j41(55,"div",31)(56,"div",32)(57,"label"),t.EFF(58,"Producto/Servicio"),t.k0s(),t.j41(59,"p-dropdown",33),t.bIt("onChange",function(){return i.validarStock("producto")}),t.DNE(60,Et,8,7,"ng-template",11),t.k0s(),t.DNE(61,Ft,2,1,"div",34),t.k0s(),t.j41(62,"div",32)(63,"label"),t.EFF(64,"Cantidad"),t.k0s(),t.j41(65,"input",35),t.bIt("input",function(){return i.validarStock("producto")}),t.k0s(),t.DNE(66,xt,2,0,"div",36),t.DNE(67,kt,2,0,"div",37),t.k0s(),t.j41(68,"div",38),t.nrm(69,"button",39),t.k0s()(),t.nrm(70,"br"),t.k0s()()(),t.j41(71,"p-dialog",40),t.bIt("visibleChange",function(l){return i.displayModalRecipes=l}),t.j41(72,"div",21)(73,"form",30),t.bIt("ngSubmit",function(){return i.agregarRecetas()}),t.j41(74,"div",31)(75,"div",32)(76,"label"),t.EFF(77,"Receta"),t.k0s(),t.j41(78,"p-dropdown",41),t.DNE(79,Rt,5,4,"ng-template",11),t.k0s(),t.DNE(80,Dt,2,1,"div",34),t.k0s(),t.j41(81,"div",32)(82,"label"),t.EFF(83,"Cantidad"),t.k0s(),t.nrm(84,"input",42),t.DNE(85,Pt,2,0,"div",36),t.DNE(86,jt,2,0,"div",43),t.k0s(),t.j41(87,"div",38),t.nrm(88,"button",44),t.k0s()(),t.nrm(89,"br"),t.k0s()()(),t.j41(90,"p-dialog",45),t.bIt("visibleChange",function(l){return i.displayModalMetodosPago=l}),t.j41(91,"div",21)(92,"form",30),t.bIt("ngSubmit",function(){return i.submitFactura()}),t.j41(93,"div",46)(94,"div",47)(95,"div",48),t.EFF(96),t.nI1(97,"currencyFormat"),t.k0s()(),t.j41(98,"div",47)(99,"label"),t.EFF(100,"Agregar m\xe9todo de pago"),t.k0s(),t.j41(101,"p-dropdown",49),t.bIt("onChange",function(l){return i.agregarMetodoPago(l)}),t.DNE(102,Mt,3,1,"ng-template",11),t.k0s()(),t.j41(103,"div",47),t.DNE(104,At,11,3,"div",50),t.DNE(105,wt,2,0,"div",51),t.nrm(106,"hr"),t.j41(107,"div",52)(108,"div",53),t.nrm(109,"p-message",54),t.j41(110,"form",30),t.bIt("ngSubmit",function(){return i.submitFacturaElectronica()}),t.nrm(111,"p-inputSwitch",55),t.k0s()(),t.j41(112,"div",56)(113,"div",57),t.EFF(114),t.nI1(115,"currencyFormat"),t.k0s(),t.j41(116,"div",57),t.EFF(117),t.nI1(118,"currencyFormat"),t.nI1(119,"currencyFormat"),t.k0s()()()()(),t.j41(120,"div",47)(121,"button",58),t.bIt("click",function(){return i.crearVenta()}),t.k0s()()()()(),t.j41(122,"p-dialog",59),t.bIt("visibleChange",function(l){return i.mostrarModal=l}),t.j41(123,"div",21)(124,"div",31)(125,"div",38)(126,"div",20),t.DNE(127,Bt,5,4,"div",60),t.k0s()()()(),t.j41(128,"div",61)(129,"button",62),t.bIt("click",function(){return i.cargarAHabitacion()}),t.k0s()()(),t.DNE(130,Ot,2,1,"app-clientes",63)),2&a&&(t.R7$(4),t.Y8G("routerLink","/dashboard/dashboardSell"),t.R7$(7),t.Y8G("formGroup",i.formCliente),t.R7$(3),t.Y8G("options",i.clienteData),t.R7$(9),t.SpI("Total: $",t.bMT(24,63,i.total),""),t.R7$(10),t.Y8G("value",i.totales)("tableStyle",t.lJ4(73,Yt))("rows",8),t.R7$(7),t.Y8G("value",i.productosAgregados)("tableStyle",t.lJ4(74,Q))("rows",5),t.R7$(8),t.Y8G("value",i.recetasAgregadas)("tableStyle",t.lJ4(75,Q))("rows",5),t.R7$(4),t.Aen(t.lJ4(76,O)),t.Y8G("visible",i.displayModalProducts)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(2),t.Y8G("formGroup",i.formProducto),t.R7$(5),t.Y8G("options",i.productsData),t.R7$(2),t.Y8G("ngIf",i.formProducto.get("producto_id").errors&&(i.formProducto.get("producto_id").dirty||i.formProducto.get("producto_id").touched)),t.R7$(5),t.Y8G("ngIf",i.formProducto.get("cantidad").hasError("required")),t.R7$(1),t.Y8G("ngIf",i.validacionStock),t.R7$(2),t.Y8G("disabled",i.formProducto.invalid||i.validacionStock),t.R7$(2),t.Aen(t.lJ4(77,O)),t.Y8G("visible",i.displayModalRecipes)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(2),t.Y8G("formGroup",i.formReceta),t.R7$(5),t.Y8G("options",i.recetasData),t.R7$(2),t.Y8G("ngIf",i.formReceta.get("receta_id").errors&&(i.formReceta.get("receta_id").dirty||i.formReceta.get("receta_id").touched)),t.R7$(5),t.Y8G("ngIf",i.formReceta.get("cantidad").hasError("required")),t.R7$(1),t.Y8G("ngIf",i.validacionStock),t.R7$(2),t.Y8G("disabled",i.formReceta.invalid),t.R7$(2),t.Aen(t.lJ4(78,Vt)),t.Y8G("visible",i.displayModalMetodosPago)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(2),t.Y8G("formGroup",i.formMetodoPago),t.R7$(4),t.SpI("Total a pagar: $",t.bMT(97,65,i.total),""),t.R7$(5),t.Y8G("options",i.dataMetodosPago)("autoDisplayFirst",!1),t.R7$(3),t.Y8G("ngForOf",i.metodosPago.controls),t.R7$(1),t.Y8G("ngIf",i.totalMetodosPago!=i.total),t.R7$(5),t.Y8G("formGroup",i.formFacturar),t.R7$(4),t.SpI("Total ingresado: $",t.bMT(115,67,i.totalMetodosPago),""),t.R7$(3),t.SpI("Pendiente: $",i.total-i.totalMetodosPago>0?t.bMT(118,69,i.total-i.totalMetodosPago):t.bMT(119,71,0),""),t.R7$(4),t.Y8G("label","Pagar")("disabled",i.totalMetodosPago!=i.total||0===i.total||i.formMetodoPago.invalid),t.R7$(1),t.Aen(t.lJ4(79,O)),t.Y8G("visible",i.mostrarModal)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(5),t.Y8G("ngForOf",i.habitacionesOcupadas),t.R7$(2),t.Y8G("label","Cargar a habitaci\xf3n"),t.R7$(1),t.Y8G("ngIf",i.creandoCliente))},dependencies:[_.YU,_.Sq,_.bT,v.Wk,b.XI,X.Ei,E._f,E.$n,n.qT,n.me,n.Q0,n.BC,n.cb,n.VZ,F.n,j.M,M.S,u.ms,y.l,n.j4,n.JD,n.$R,n.v8,T.et,J.KF,K.v,lt.$,W.C,z.HW,_.PV,H.l],styles:['@charset "UTF-8";.flex[_ngcontent-%COMP%]{display:flex;align-items:center}.flex-grow-1[_ngcontent-%COMP%]{flex-grow:1}.text-right[_ngcontent-%COMP%]{text-align:right}.mr-2[_ngcontent-%COMP%]{margin-right:2rem}.multiselect-custom[_ngcontent-%COMP%]{width:100%!important}.padding[_ngcontent-%COMP%]{padding:1%}.selected-card[_ngcontent-%COMP%]{background-color:#5e5f601a}']})}}return o})(),Xt=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[v.iI.forChild([{path:"",component:rt,canActivate:[L.q],data:{permissions:["dashboard.venta"]}},{path:"sale-detail",component:Ut,canActivate:[L.q],data:{permissions:["dashboard.venta"]}}]),v.iI]})}}return o})();var Ht=s(4827),Lt=s(3794),Jt=s(3887);let Kt=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({providers:[{provide:x.a7,useClass:w.R,multi:!0},C],imports:[_.MD,Xt,b.bG,k.e,n.YN,E.tm,F.Z,D.MB,j.m,G.wZ,M.u,A.f,u.kr,P.Ko,I.O3,y.P,m.RZ.forRoot(),n.X1,T.PO,d.I,h.dL,J.iV,Ht.P,K.$,Lt.ClientesModule,W.u,Jt.G,z.H_]})}}return o})()},7927:(N,R,s)=>{s.d(R,{l:()=>n});var _=s(540);let n=(()=>{class b{transform(E){if(""===E)return"";const F=Number(E).toFixed(2),[D,j]=F.split(".");return D.replace(/\B(?=(\d{3})+(?!\d))/g,".")}static{this.\u0275fac=function(F){return new(F||b)}}static{this.\u0275pipe=_.EJ8({name:"currencyFormat",type:b,pure:!0})}}return b})()},3887:(N,R,s)=>{s.d(R,{G:()=>b});var _=s(177),n=s(540);let b=(()=>{class k{static{this.\u0275fac=function(D){return new(D||k)}}static{this.\u0275mod=n.$C({type:k})}static{this.\u0275inj=n.G2t({imports:[_.MD]})}}return k})()},4827:(N,R,s)=>{s.d(R,{P:()=>T});var _=s(177),n=s(540),b=s(5779),k=s(2816);let T=(()=>{class d{static \u0275fac=function(t){return new(t||d)};static \u0275mod=n.$C({type:d});static \u0275inj=n.G2t({imports:[_.MD,k.I,b.Gg,b.Gg]})}return d})()},5114:(N,R,s)=>{s.d(R,{C:()=>x,u:()=>w});var _=s(177),n=s(540),b=s(3306),k=s(9329),E=s(9581),F=s(2816);function D(m,T){1&m&&n.nrm(0,"CheckIcon",4),2&m&&n.Y8G("styleClass","p-inline-message-icon")}function j(m,T){1&m&&n.nrm(0,"InfoCircleIcon",4),2&m&&n.Y8G("styleClass","p-inline-message-icon")}function G(m,T){1&m&&n.nrm(0,"TimesCircleIcon",4),2&m&&n.Y8G("styleClass","p-inline-message-icon")}function M(m,T){1&m&&n.nrm(0,"ExclamationTriangleIcon",4),2&m&&n.Y8G("styleClass","p-inline-message-icon")}function A(m,T){if(1&m&&n.nrm(0,"span",6),2&m){const d=n.XpG(2);n.Y8G("innerHTML",d.text,n.npT)}}function u(m,T){if(1&m&&(n.j41(0,"div"),n.DNE(1,A,1,1,"span",5),n.k0s()),2&m){const d=n.XpG();n.R7$(1),n.Y8G("ngIf",!d.escape)}}function P(m,T){if(1&m&&(n.j41(0,"span",8),n.EFF(1),n.k0s()),2&m){const d=n.XpG(2);n.R7$(1),n.JRh(d.text)}}function I(m,T){if(1&m&&n.DNE(0,P,2,1,"span",7),2&m){const d=n.XpG();n.Y8G("ngIf",d.escape)}}const y=function(m,T,d,h,c){return{"p-inline-message-info":m,"p-inline-message-warn":T,"p-inline-message-error":d,"p-inline-message-success":h,"p-inline-message-icon-only":c}};let x=(()=>{class m{severity;text;escape=!0;style;styleClass;get icon(){return this.severity&&this.severity.trim()?this.severity:"info"}static \u0275fac=function(h){return new(h||m)};static \u0275cmp=n.VBU({type:m,selectors:[["p-message"]],hostAttrs:[1,"p-element"],inputs:{severity:"severity",text:"text",escape:"escape",style:"style",styleClass:"styleClass"},decls:8,vars:16,consts:[["aria-live","polite",1,"p-inline-message","p-component","p-inline-message",3,"ngStyle","ngClass"],[3,"styleClass",4,"ngIf"],[4,"ngIf","ngIfElse"],["escapeOut",""],[3,"styleClass"],["class","p-inline-message-text",3,"innerHTML",4,"ngIf"],[1,"p-inline-message-text",3,"innerHTML"],["class","p-inline-message-text",4,"ngIf"],[1,"p-inline-message-text"]],template:function(h,c){if(1&h&&(n.j41(0,"div",0),n.DNE(1,D,1,1,"CheckIcon",1),n.DNE(2,j,1,1,"InfoCircleIcon",1),n.DNE(3,G,1,1,"TimesCircleIcon",1),n.DNE(4,M,1,1,"ExclamationTriangleIcon",1),n.DNE(5,u,2,1,"div",2),n.DNE(6,I,1,1,"ng-template",null,3,n.C5r),n.k0s()),2&h){const t=n.sdS(7);n.HbH(c.styleClass),n.Y8G("ngStyle",c.style)("ngClass",n.s1E(10,y,"info"===c.severity,"warn"===c.severity,"error"===c.severity,"success"===c.severity,null==c.text)),n.R7$(1),n.Y8G("ngIf","success"===c.icon),n.R7$(1),n.Y8G("ngIf","info"===c.icon),n.R7$(1),n.Y8G("ngIf","error"===c.icon),n.R7$(1),n.Y8G("ngIf","warn"===c.icon),n.R7$(1),n.Y8G("ngIf",!c.escape)("ngIfElse",t)}},dependencies:function(){return[_.YU,_.bT,_.B3,b.S,E.e,F.I,k.P]},styles:[".p-inline-message{display:inline-flex;align-items:center;justify-content:center;vertical-align:top}.p-inline-message-icon-only .p-inline-message-text{visibility:hidden;width:0}.p-fluid .p-inline-message{display:flex}\n"],encapsulation:2,changeDetection:0})}return m})(),w=(()=>{class m{static \u0275fac=function(h){return new(h||m)};static \u0275mod=n.$C({type:m});static \u0275inj=n.G2t({imports:[_.MD,b.S,E.e,F.I,k.P]})}return m})()},935:(N,R,s)=>{s.d(R,{$:()=>A,v:()=>M});var _=s(177),n=s(540),b=s(5779);function k(u,P){if(1&u&&n.nrm(0,"span",5),2&u){const I=n.XpG(2);n.Y8G("ngClass",I.icon)}}function E(u,P){if(1&u&&(n.qex(0),n.DNE(1,k,1,1,"span",4),n.bVm()),2&u){const I=n.XpG();n.R7$(1),n.Y8G("ngIf",I.icon)}}function F(u,P){}function D(u,P){1&u&&n.DNE(0,F,0,0,"ng-template")}function j(u,P){if(1&u&&(n.j41(0,"span",6),n.DNE(1,D,1,0,null,7),n.k0s()),2&u){const I=n.XpG();n.R7$(1),n.Y8G("ngTemplateOutlet",I.iconTemplate)}}const G=["*"];let M=(()=>{class u{style;styleClass;severity;value;icon;rounded;templates;iconTemplate;ngAfterContentInit(){this.templates?.forEach(I=>{"icon"===I.getType()&&(this.iconTemplate=I.template)})}containerClass(){return{"p-tag p-component":!0,"p-tag-info":"info"===this.severity,"p-tag-success":"success"===this.severity,"p-tag-warning":"warning"===this.severity,"p-tag-danger":"danger"===this.severity,"p-tag-rounded":this.rounded}}static \u0275fac=function(y){return new(y||u)};static \u0275cmp=n.VBU({type:u,selectors:[["p-tag"]],contentQueries:function(y,x,w){if(1&y&&n.wni(w,b.Ei,4),2&y){let m;n.mGM(m=n.lsd())&&(x.templates=m)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",severity:"severity",value:"value",icon:"icon",rounded:"rounded"},ngContentSelectors:G,decls:6,vars:7,consts:[[3,"ngClass","ngStyle"],[4,"ngIf"],["class","p-tag-icon",4,"ngIf"],[1,"p-tag-value"],["class","p-tag-icon",3,"ngClass",4,"ngIf"],[1,"p-tag-icon",3,"ngClass"],[1,"p-tag-icon"],[4,"ngTemplateOutlet"]],template:function(y,x){1&y&&(n.NAR(),n.j41(0,"span",0),n.SdG(1),n.DNE(2,E,2,1,"ng-container",1),n.DNE(3,j,2,1,"span",2),n.j41(4,"span",3),n.EFF(5),n.k0s()()),2&y&&(n.HbH(x.styleClass),n.Y8G("ngClass",x.containerClass())("ngStyle",x.style),n.R7$(2),n.Y8G("ngIf",!x.iconTemplate),n.R7$(1),n.Y8G("ngIf",x.iconTemplate),n.R7$(2),n.JRh(x.value))},dependencies:[_.YU,_.bT,_.T3,_.B3],styles:[".p-tag{display:inline-flex;align-items:center;justify-content:center}.p-tag-icon,.p-tag-value,.p-tag-icon.pi{line-height:1.5}.p-tag.p-tag-rounded{border-radius:10rem}\n"],encapsulation:2,changeDetection:0})}return u})(),A=(()=>{class u{static \u0275fac=function(y){return new(y||u)};static \u0275mod=n.$C({type:u});static \u0275inj=n.G2t({imports:[_.MD,b.Gg,b.Gg]})}return u})()}}]);