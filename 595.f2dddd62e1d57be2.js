"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[595],{5595:(R,P,s)=>{s.r(P),s.d(P,{SaleModule:()=>Gt});var _=s(6814),o=s(95),v=s(9664),S=s(6068),Z=s(707),y=s(4480),M=s(4104),E=s(6340),J=s(6022),q=s(3714),k=s(6218),g=s(2160),D=s(1865),x=s(354),A=s(7213),I=s(9862),N=s(8712),u=s(5722),C=s(8672),p=s(1712),h=s(3514),c=s(4444),t=s(4946);let T=(()=>{class a{constructor(e){this.httpClient=e,this.baseUrl=c.D.url,this.endpointListar="/ventasListar",this.endpointProductsGet="/getDatosVentasCrear",this.endpointVentasCrear="/crearVenta",this.endpointVentasDelete="/eliminarVenta",this.endpointHabitaciones="/ventas/habitaciones-ocupadas",this.endpointCargarItems="/cargarItemsAHabitacion"}getAll(e,n="",i=1){const r={headers:new I.WM({"Content-Type":"application/json"})};return this.httpClient.post(`${this.baseUrl+this.endpointListar}?per_page=${e}&page=${i}&search=${n}`,r)}deleteSale(e){return this.httpClient.post(`${this.baseUrl+this.endpointVentasDelete}`,e)}getDatosVentasCrear(){return this.httpClient.get(`${this.baseUrl+this.endpointProductsGet}`)}createVentas(e){return this.httpClient.post(`${this.baseUrl+this.endpointVentasCrear}`,e)}getHabitacionesOcupadas(e){return this.httpClient.get(`${this.baseUrl+this.endpointHabitaciones}?cliente_id=${e}`)}cargarItemsAHabitacion(e){return this.httpClient.post(`${this.baseUrl}${this.endpointCargarItems}`,e)}static#t=this.\u0275fac=function(n){return new(n||a)(t.LFG(I.eN))};static#e=this.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var b=s(228),L=s(3519),U=s.n(L),Y=s(3859),W=s(6401),B=s(5219),H=s(9326);function X(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"div",21),t._UZ(1,"span"),t.TgZ(2,"span",22)(3,"form",23)(4,"div",24)(5,"input",25),t.NdJ("keyup.enter",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.buscarPorTecla(i))})("input",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.searchInput())}),t.qZA(),t.TgZ(6,"button",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.search())}),t.qZA()()()()()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("formGroup",e.formSearch)}}function tt(a,d){1&a&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Hotel"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Recibo interno"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Usuario"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Total"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Subtotal"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Estado"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Acciones"),t.qZA()())}function et(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"p-button",31),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,r=t.oxw();return t.KtG(r.confirmAbrirPdf(i.id))}),t.qZA()}}function it(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"p-button",32),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,r=t.oxw();return t.KtG(r.confirmDelete(i.id))}),t.qZA()}}function ot(a,d){if(1&a&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"currencyFormat"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"currencyFormat"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td",27),t.YNc(16,et,1,0,"p-button",28),t.YNc(17,it,1,0,"p-button",29),t.TgZ(18,"button",30),t._uU(19,"."),t.qZA()()()),2&a){const e=d.$implicit,n=t.oxw();t.xp6(2),t.Oqu(e.hotel.nombre),t.xp6(2),t.Oqu(e.secuencia_interna),t.xp6(2),t.Oqu(e.usuario.usuario),t.xp6(2),t.Oqu(t.lcZ(9,8,e.total)),t.xp6(3),t.Oqu(t.lcZ(12,10,e.subtotal)),t.xp6(3),t.Oqu(n.getEstado(e.estado_id)),t.xp6(2),t.Q6J("ngIf",0!==e.estado_id),t.xp6(1),t.Q6J("ngIf",0!==e.estado_id||n.permisoEliminar)}}function at(a,d){1&a&&(t.TgZ(0,"tr")(1,"td",33),t._uU(2,"Cargando informacion porfavor espere ..."),t.qZA()())}const nt=function(){return{"min-width":"50rem"}},st=function(){return["nombre","Hotel","acciones"]};let rt=(()=>{class a{constructor(e,n,i,r,l,f){this.FB=e,this.spinner=n,this.SaleService=i,this.router=r,this.layoutService=l,this.appComponent=f,this.loadingTable=!1,this.pageCount=10,this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1,this.first=0,this.rows=8}ngOnInit(){this.buildForm(),this.getIndex(),this.baseUrl=c.D.url,this.token=this.appComponent.getToken()}buildForm(){this.formSearch=this.FB.group({search:["",[]]})}redirectToCrearVenta(){this.router.navigate(["dashboard/dashboardSell/sale-detail"])}getEstado(e){switch(e){case 1:return"Activa";case 0:return"Anulada";default:return"Desconocido"}}getIndex(e="",n=this.pageCount,i=1){this.spinner.show(),this.loadingTable=!0,this.SaleService.getAll(n,e,i).subscribe(r=>{this.loadingTable=!1,this.salesData=r.data,this.countRegisters=r.total,this.ultimaPage=r.last_page,r.total>n&&(this.disablePageRight=!0),this.validatePage(),this.spinner.hide()},r=>{console.log("Error: ",r),this.spinner.hide()})}confirmDelete(e){U().fire({title:"\xbfEstas seguro que deseas anular esta venta?",text:"Ten cuidado esta acci\xf3n no se prodr\xe1 reversar",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(n=>{n.isConfirmed&&(this.spinner.show(),this.SaleService.deleteSale({id:e}).subscribe(i=>{this.spinner.hide(),"success"==i.code?(U().fire({title:"Exito",text:"Venta anulada exitosamente.",icon:"success"}),this.getIndex(),this.layoutService.reloadComponent()):U().fire({title:"Error",text:"Error al anular la venta.",icon:"error"})},i=>{console.log("Error: ",i)}))})}onPage(e){this.pageCount=e.rows,this.getIndex("",this.pageCount)}searchInput(){let e=this.formSearch.get("search").value;this.pageActual=1,""==e&&this.getIndex(e)}buscarPorTecla(e){"Enter"==e.code&&this.search()}search(){let e=this.formSearch.get("search").value;this.getIndex(e)}onPageChange(e){this.first=e.first,this.rows=e.rows}leftTable(){this.pageActual=this.pageActual-1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}confirmAbrirPdf(e){console.log(e),window.open(this.baseUrl+"/ventasPdf/"+e+"?token="+this.token,"_blank")}static#t=this.\u0275fac=function(n){return new(n||a)(t.Y36(o.qu),t.Y36(C.t2),t.Y36(T),t.Y36(b.F0),t.Y36(Y.P),t.Y36(W.y))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-sale"]],decls:24,vars:11,consts:[["type","ball-scale-multiple"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Crear","icon","",1,"p-button-outlined","mr-2",3,"click"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"keyup.enter","input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[1,"flex","gap-1"],["icon","pi pi-file-pdf","severity","danger",3,"click",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"click",4,"ngIf"],["disabled","",2,"visibility","hidden"],["icon","pi pi-file-pdf","severity","danger",3,"click"],["icon","pi pi-trash","severity","danger",3,"click"],["colspan","8"]],template:function(n,i){1&n&&(t._UZ(0,"ngx-spinner",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),t._uU(5,"Ventas"),t.qZA(),t.TgZ(6,"div",4),t._UZ(7,"div",5),t.qZA()(),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return i.redirectToCrearVenta()}),t.qZA()()()(),t.TgZ(10,"div",8)(11,"div",9)(12,"div",10)(13,"p-table",11),t.NdJ("onPage",function(l){return i.onPage(l)}),t.YNc(14,X,7,1,"ng-template",12),t.YNc(15,tt,15,0,"ng-template",13),t.YNc(16,ot,20,12,"ng-template",14),t.YNc(17,at,3,0,"ng-template",15),t.qZA(),t._UZ(18,"br"),t.TgZ(19,"div",16)(20,"span",17)(21,"button",18),t.NdJ("click",function(){return i.leftTable()}),t.qZA(),t._UZ(22,"button",19),t.TgZ(23,"button",20),t.NdJ("click",function(){return i.rightTable()}),t.qZA()()()()()()),2&n&&(t.xp6(13),t.Q6J("value",i.salesData)("tableStyle",t.DdM(9,nt))("loading",i.loadingTable)("rows",8)("globalFilterFields",t.DdM(10,st))("rowHover",!0),t.xp6(8),t.Q6J("disabled",!i.disablePageLeft),t.xp6(1),t.Q6J("label",i.pageActual),t.xp6(1),t.Q6J("disabled",!i.disablePageRight))},dependencies:[_.O5,v.iA,B.jx,Z.Hq,Z.zx,o._Y,o.Fj,o.JJ,o.JL,y.H,q.o,o.sg,o.u,C.Ro,H.D]})}return a})();var $=s(2506),V=s(4055),j=s(6263),lt=s(8725),G=s(7161),K=s(5609);function ct(a,d){if(1&a&&(t.TgZ(0,"div",65)(1,"span",66),t._uU(2),t.qZA()()),2&a){const e=d.$implicit;t.xp6(2),t.lnq(" ",e.numero_documento," ",e.nombres," ",e.apellidos,"")}}function pt(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"button",67),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.crearCliente())}),t.qZA()}}function dt(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"button",68),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.cargarAHabitacion())}),t.qZA()}}function ut(a,d){1&a&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Categor\xeda"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Total"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Acci\xf3n"),t.qZA()())}function gt(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"td")(1,"button",71),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,r=t.oxw();return t.KtG(r.modals(i.nombre))}),t.qZA()()}}function mt(a,d){1&a&&t._UZ(0,"td")}function _t(a,d){if(1&a&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"currencyFormat"),t.qZA(),t.YNc(6,gt,2,0,"td",69),t.YNc(7,mt,1,0,"ng-template",null,70,t.W1O),t.qZA()),2&a){const e=d.$implicit,n=t.MAs(8);t.xp6(2),t.Oqu(e.nombre),t.xp6(2),t.hij("$",t.lcZ(5,4,e.total),""),t.xp6(2),t.Q6J("ngIf",e.accion)("ngIfElse",n)}}function ht(a,d){1&a&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Nombre"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Precio"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Impuesto"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Cantidad"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Total"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Acciones"),t.qZA()())}function ft(a,d){1&a&&(t.TgZ(0,"span",74),t._uU(1,"*"),t.qZA())}function vt(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"currencyFormat"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"currencyFormat"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.YNc(12,ft,2,0,"span",72),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"currencyFormat"),t.qZA(),t.TgZ(16,"td")(17,"p-button",73),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.eliminarProducto(r))}),t.qZA()()()}if(2&a){const e=d.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,6,e.nombre)),t.xp6(3),t.hij("$",t.lcZ(6,8,e.subtotal),""),t.xp6(3),t.hij("$",t.lcZ(9,10,e.impuestos),""),t.xp6(3),t.Oqu(e.cantidad),t.xp6(1),t.Q6J("ngIf",e.stockModificado),t.xp6(2),t.hij("$",t.lcZ(15,12,e.total),"")}}function bt(a,d){1&a&&(t.TgZ(0,"tr")(1,"td",78)(2,"span"),t._uU(3,"*"),t.qZA(),t._uU(4," El stock de estos productos ha sido actualizado. "),t.qZA()())}function Tt(a,d){if(1&a&&(t.TgZ(0,"tr")(1,"td",75),t._uU(2,"Totales:"),t.qZA(),t.TgZ(3,"td",75),t._uU(4),t.ALo(5,"currencyFormat"),t.qZA(),t.TgZ(6,"td",76),t._uU(7),t.ALo(8,"currencyFormat"),t.qZA(),t.TgZ(9,"td",76),t._uU(10),t.ALo(11,"currencyFormat"),t.qZA()(),t.YNc(12,bt,5,0,"tr",77)),2&a){const e=t.oxw();t.xp6(4),t.hij(" $",t.lcZ(5,4,e.totalProductos-e.totalProductosImpuestos),""),t.xp6(3),t.hij(" $",t.lcZ(8,6,e.totalProductosImpuestos),""),t.xp6(3),t.hij(" $",t.lcZ(11,8,e.totalProductos),""),t.xp6(2),t.Q6J("ngIf",e.stockProductoModificado&&e.productosAgregados.length>0)}}function xt(a,d){1&a&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Nombre"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Precio"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Impuesto"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Cantidad"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Total"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Acciones"),t.qZA()())}function Ct(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"currencyFormat"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"currencyFormat"),t.qZA(),t.TgZ(14,"td")(15,"p-button",73),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.eliminarReceta(r))}),t.qZA()()()}if(2&a){const e=d.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,5,e.nombre)),t.xp6(3),t.hij("$",t.lcZ(6,7,e.subtotal),""),t.xp6(3),t.hij("$",e.impuestos,""),t.xp6(2),t.Oqu(e.cantidad),t.xp6(2),t.hij("$",t.lcZ(13,9,e.total),"")}}function Zt(a,d){if(1&a&&(t.TgZ(0,"tr")(1,"td",75),t._uU(2,"Totales:"),t.qZA(),t.TgZ(3,"td",75),t._uU(4),t.ALo(5,"currencyFormat"),t.qZA(),t.TgZ(6,"td",76),t._uU(7),t.ALo(8,"currencyFormat"),t.qZA(),t.TgZ(9,"td",75),t._uU(10),t.ALo(11,"currencyFormat"),t.qZA(),t.TgZ(12,"td"),t._uU(13,"\xa0"),t.qZA()()),2&a){const e=t.oxw();t.xp6(4),t.hij(" $",t.lcZ(5,3,e.totalRecetas-e.totalRecetasImpuestos),""),t.xp6(3),t.hij(" $",t.lcZ(8,5,e.totalRecetasImpuestos),""),t.xp6(3),t.hij(" $",t.lcZ(11,7,e.totalRecetas),"")}}function At(a,d){if(1&a&&(t.TgZ(0,"div",79)(1,"span",66),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"div"),t._UZ(5,"p-tag",80),t.ALo(6,"currencyFormat"),t._UZ(7,"p-tag",80),t.qZA()()),2&a){const e=d.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,3,e.nombre)),t.xp6(3),t.MGl("value","$",t.lcZ(6,5,e.precioTotal),""),t.xp6(2),t.MGl("value","Stock: ",1==e.sin_limite_cantidad?e.stockActual:"Ilimitado","")}}function yt(a,d){1&a&&(t.TgZ(0,"span",82),t._uU(1,"Producto es requerido."),t.qZA())}function It(a,d){if(1&a&&(t.TgZ(0,"div",81),t.YNc(1,yt,2,0,"span",37),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.formProducto.get("producto_id").hasError("required"))}}function St(a,d){1&a&&(t.TgZ(0,"div",82),t._uU(1,"Campo requerido"),t.qZA())}function Pt(a,d){1&a&&(t.TgZ(0,"div",83),t._uU(1,"La cantidad excede el stock disponible."),t.qZA())}function Mt(a,d){if(1&a&&(t.TgZ(0,"div",79)(1,"span",66),t._uU(2),t.qZA(),t._UZ(3,"p-tag",80),t.ALo(4,"currencyFormat"),t.qZA()),2&a){const e=d.$implicit;t.xp6(2),t.Oqu(e.nombre),t.xp6(1),t.MGl("value","$",t.lcZ(4,2,e.precioTotal),"")}}function Dt(a,d){1&a&&(t.TgZ(0,"span",82),t._uU(1,"Receta es requerida."),t.qZA())}function Ut(a,d){if(1&a&&(t.TgZ(0,"div",81),t.YNc(1,Dt,2,0,"span",37),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.formReceta.get("receta_id").hasError("required"))}}function Et(a,d){1&a&&(t.TgZ(0,"div",82),t._uU(1,"Campo requerido"),t.qZA())}function qt(a,d){1&a&&(t.TgZ(0,"div",84),t._uU(1,"La cantidad excede el stock disponible."),t.qZA())}function wt(a,d){if(1&a&&(t.TgZ(0,"div",65)(1,"span",66),t._uU(2),t.qZA()()),2&a){const e=d.$implicit;t.xp6(2),t.Oqu(e.nombre)}}function Jt(a,d){1&a&&(t.TgZ(0,"div",82),t._uU(1,"Campo requerido"),t.qZA())}function kt(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"div",91)(1,"p-button",92),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,r=t.oxw();return t.KtG(r.eliminarMetodoPago(i))}),t.qZA()()}}function Nt(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"div",85)(1,"div",86)(2,"label"),t._uU(3,"M\xe9todo de Pago"),t.qZA(),t._UZ(4,"input",87),t.qZA(),t.TgZ(5,"div",88)(6,"label"),t._uU(7,"Valor"),t.qZA(),t.TgZ(8,"input",89),t.NdJ("blur",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.calcularTotalMetodosPago())}),t.qZA(),t.YNc(9,Jt,2,0,"div",37),t.qZA(),t.YNc(10,kt,2,0,"div",90),t.qZA()}if(2&a){const e=d.$implicit,n=d.index,i=t.oxw();t.Q6J("formGroupName",n),t.xp6(9),t.Q6J("ngIf",e.get("valor").hasError("required")),t.xp6(1),t.Q6J("ngIf",i.metodosPago.controls.length>1)}}function Rt(a,d){1&a&&(t.TgZ(0,"div",93),t._UZ(1,"p-message",94),t.qZA())}const Ft=function(a){return{"selected-card":a}};function Ot(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"div",95)(1,"div",96),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.seleccionarHabitacion(r.id))}),t.TgZ(2,"div",97)(3,"h4"),t._uU(4),t.qZA()()()()}if(2&a){const e=d.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(2,Ft,n.habitacionSeleccionada===e.id)),t.xp6(3),t.Oqu(e.nombre)}}function Qt(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"app-clientes",98,99),t.NdJ("clienteCreado",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.handleClienteCreado(i))}),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("vieneDeHabitaciones",e.creandoCliente)}}const Lt=function(){return{"min-width":"20rem"}},z=function(){return{"min-width":"35rem"}},O=function(){return{width:"60vw"}},Yt=function(){return{width:"50vw"}};let Bt=(()=>{class a{constructor(e,n,i,r,l){this.FB=e,this.spinner=n,this.saleService=i,this.router=r,this.layoutService=l,this.loadingTable=!1,this.clienteData=[],this.validacionStock=!1,this.habitacionesOcupadas=[],this.selectedClienteId=null,this.mostrarModal=!1,this.habitacionSeleccionada=null,this.unaHabitacion=!1,this.productosAgregados=[],this.recetasAgregadas=[],this.totalProductos=0,this.totalProductosImpuestos=0,this.totalRecetas=0,this.totalRecetasImpuestos=0,this.totalImpuestos=0,this.subtotal=0,this.total=0,this.totales=[{nombre:"Productos/Servicios",total:this.totalProductos-this.totalProductosImpuestos,accion:!0},{nombre:"Recetas",total:this.totalRecetas-this.totalRecetasImpuestos,accion:!0},{nombre:"Impuestos",total:this.totalImpuestos},{nombre:"Subtotal",total:this.subtotal},{nombre:"Total",total:this.total}],this.recetasData=[],this.displayModalRecipes=!1,this.productsData=[],this.displayModalProducts=!1,this.dataMetodosPago=[],this.displayModalMetodosPago=!1,this.montoSinRedondear=0,this.excedente=0,this.activarRedondear=!1,this.stockProductoModificado=!1,this.creandoCliente=!1,this.totalMetodosPago=0,this.buildForm()}ngOnInit(){this.spinner.hide(),this.buildForm(),this.loadData()}buildForm(){this.formCliente=this.FB.group({cliente_id:[null,[]]}),this.formHabitaciones=this.FB.group({habitacion_id:[null,[]]}),this.formProducto=this.FB.group({producto_id:[null,o.kI.required],cantidad:[1,[o.kI.required,o.kI.min(1)]]}),this.formReceta=this.FB.group({receta_id:[null,o.kI.required],cantidad:[1,[o.kI.required,o.kI.min(1)]]}),this.formMetodoPago=this.FB.group({metodos_pago:this.FB.array([]),cambio:[0,o.kI.required]}),this.agregarMetodoPago({value:{id:1,nombre:"Efectivo"}}),this.formFacturar=this.FB.group({isFacturaElectronica:[""]})}crearCliente(){this.creandoCliente=!0}handleClienteCreado(e){this.creandoCliente=!1,e&&this.loadData()}get metodosPago(){return this.formMetodoPago.get("metodos_pago")}agregarMetodoPago(e){if(this.metodosPago.controls.find(i=>i.get("metodo_pago_id").value===e.value.id))return;const n=this.FB.group({metodo_pago_id:[e.value.id,o.kI.required],valor:[null,[o.kI.required,o.kI.min(1)]],nombre:[e.value.nombre]});n.get("nombre").disable(),this.metodosPago.push(n)}eliminarMetodoPago(e){this.metodosPago.removeAt(e)}calcularTotalMetodosPago(){this.totalMetodosPago=0,this.metodosPago.controls.forEach(e=>{let n=e.get("valor").value;isNaN(n)&&(n=0),this.totalMetodosPago+=n})}submitFactura(){this.formMetodoPago.valid&&(this.displayModalMetodosPago=!1,this.calcularTotales())}loadData(){this.spinner.show(),this.saleService.getDatosVentasCrear().subscribe(e=>{function n(i){const r=parseFloat(i.precio);let l=0;return i.impuestos.forEach(f=>{const m=r*(Number(f.impuesto.porcentaje)/100);l+=m}),r+l}this.spinner.hide(),this.productsData=e.productos.map(i=>({...i,precioTotal:n(i),tipo_servicio_id:1===i.tipo_producto?1:2,stockModificado:!1})),this.recetasData=e.recetas.map(i=>({...i,precioTotal:n(i),tipo_servicio_id:4})),this.clienteData=e.clientes,this.habitacionesOcupadas=e.habitaciones,this.dataMetodosPago=e.metodosPago},e=>{console.error(e)})}agregarProductos(){const e=this.formProducto.get("producto_id").value,n=this.formProducto.get("cantidad").value,i=parseFloat(e.precio),r=i*e.impuestos_total/100,l=(i+r)*n,f={...e,cantidad:Number(n),subtotal:i,total:l,stockModificado:!1,impuestos:r};if(this.productosAgregados.some(m=>m.id===f.id)){const m=this.productosAgregados.findIndex(w=>w.id===f.id);this.productosAgregados[m].cantidad+=f.cantidad,this.productosAgregados[m].total+=f.total}else this.productosAgregados.push(f);this.productsData.find(m=>m.id===f.id).stockActual-=n,this.stockProductoModificado=this.productosAgregados.some(m=>1==m.stockModificado),this.calcularTotales(),this.displayModalProducts=!1,this.formProducto.reset()}validarStock(e){if("producto"==e&&this.formProducto.valid){const n=this.formProducto.get("producto_id").value,i=this.formProducto.get("cantidad").value;this.validacionStock=n.stockActual<i&&1==n.sin_limite_cantidad}}eliminarProducto(e){const n=this.productosAgregados.indexOf(e);n>-1&&(this.productosAgregados.splice(n,1),this.productsData.find(i=>i.id===e.id).stockActual+=e.cantidad),this.stockProductoModificado=this.productosAgregados.some(i=>1==i.stockModificado),this.calcularTotales()}agregarRecetas(){const e=this.formReceta.get("receta_id").value,n=this.formReceta.get("cantidad").value,i=parseFloat(e.precio),r=i*e.impuestos_total/100,l=(i+r)*n,f={...e,cantidad:n,subtotal:i,total:l,impuestos:r};if(this.recetasAgregadas.some(m=>m.id===f.id)){const m=this.recetasAgregadas.findIndex(w=>w.id===f.id);this.recetasAgregadas[m].total+=f.total,this.recetasAgregadas[m].cantidad+=f.cantidad}else this.recetasAgregadas.push(f);this.calcularTotales(),this.displayModalRecipes=!1,this.formReceta.reset()}eliminarReceta(e){const n=this.recetasAgregadas.findIndex(i=>i.id===e.id);-1!==n?this.recetasAgregadas.splice(n,1):console.error(`No se encontr\xf3 la receta con id ${e.id} en recetasAgregadas`),this.calcularTotales()}calcularTotales(){this.totalProductos=this.productosAgregados.reduce((n,i)=>n+i.total,0),this.totalProductosImpuestos=this.productosAgregados.reduce((n,i)=>n+i.impuestos*i.cantidad,0),this.totalRecetas=this.recetasAgregadas.reduce((n,i)=>n+i.total,0),this.totalRecetasImpuestos=this.recetasAgregadas.reduce((n,i)=>n+i.impuestos*i.cantidad,0),this.totalImpuestos=this.totalProductosImpuestos+this.totalRecetasImpuestos,this.subtotal=this.totalProductos-this.totalProductosImpuestos+(this.totalRecetas-this.totalRecetasImpuestos),this.total=this.subtotal+this.totalImpuestos,this.totales=[{nombre:"Productos/Servicios",total:this.totalProductos-this.totalProductosImpuestos,accion:!0},{nombre:"Recetas",total:this.totalRecetas-this.totalRecetasImpuestos,accion:!0},{nombre:"Impuestos",total:this.totalImpuestos},{nombre:"Subtotal",total:this.subtotal},{nombre:"Total",total:this.total}],this.activarRedondear?(this.montoSinRedondear=this.total,this.total=function e(n){let i=n%50,r=0;return i>0&&(r=50-i),n+r}(this.total),this.excedente=this.total-this.montoSinRedondear,this.totales[4]={nombre:"Total sin redondear",total:this.montoSinRedondear},this.totales.push({nombre:"Excedente",total:this.excedente}),this.totales.push({nombre:"Total",total:this.total})):(this.excedente=0,this.totales=this.totales.filter(n=>"Total sin redondear"!==n.nombre||"Excedente"!==n.nombre))}modals(e){switch(e){case"Productos/Servicios":this.formProducto.reset(),this.displayModalProducts=!0,this.validacionStock=!1;break;case"Recetas":this.formReceta.reset(),this.displayModalRecipes=!0,this.validacionStock=!1;break;case"Pagar":this.displayModalMetodosPago=!0}}submitFacturaElectronica(){}crearVenta(){this.spinner.show();const e=[...this.productosAgregados,...this.recetasAgregadas];if(!Array.isArray(e))return this.spinner.hide(),void U().fire({title:"Error",text:"Hubo un error al preparar los detalles de la venta.",icon:"error"});let n={cliente_id:this.formCliente.get("cliente_id").value?parseInt(this.formCliente.get("cliente_id").value[0].id):null,total:this.total,subtotal:this.subtotal,excedente:this.excedente,total_impuestos:this.totalImpuestos,estado_id:1};const i=new FormData;for(const l in n)n.hasOwnProperty(l)&&i.append(l,n[l]);e.forEach((l,f)=>{l.consumo_id=l.id,l.valor_consumo=l.subtotal,l.tipo_consumo=l.tipo_servicio_id,l.valor_impuesto=l.impuestos||0;for(const m in l)l.hasOwnProperty(m)&&i.append(`detalles_venta[${f}][${m}]`,l[m])}),this.formMetodoPago.get("metodos_pago").value.forEach((l,f)=>{for(const m in l)l.hasOwnProperty(m)&&i.append(`metodos_pago[${f}][${m}]`,l[m])}),this.saleService.createVentas(i).subscribe(l=>{this.spinner.hide(),l.venta?(this.formCliente.reset(),this.productosAgregados=[],this.recetasAgregadas=[],this.calcularTotales(),U().fire({title:"Exito",text:"Venta creada exitosamente.",icon:"success"}).then(()=>{this.router.navigate(["/dashboard/dashboardSell"])}),this.layoutService.reloadComponent()):"warning"===l.code?U().fire({title:"Advertencia",text:l.msm,icon:"warning"}):U().fire({title:"Error",text:"Error al crear la venta.",icon:"error"})},l=>{if(400===l.status&&l.error.error.startsWith("Stock insuficiente")){this.spinner.hide(),U().fire({title:"Advertencia",text:l.error.error,icon:"warning"});const f=l.error.productos_sin_stock;this.stockProductoModificado=!0,f.forEach(m=>{const w=this.productsData.find(Q=>Q.id===m.id),F=this.productosAgregados.find(Q=>Q.consumo_id===m.id);w&&(w.stockActual=0),F&&(F.cantidad=m.stockActual,F.total=w.precioTotal*F.cantidad,F.stockModificado=!0),this.calcularTotales()})}else this.spinner.hide(),console.error("Error:",l)})}obtenerHabitacionesOcupadas(e){this.saleService.getHabitacionesOcupadas(e).subscribe(n=>{this.habitacionesOcupadas=n,this.habitacionesOcupadas.length>1?(this.unaHabitacion=!1,this.mostrarModal=!1):1===this.habitacionesOcupadas.length?(this.habitacionSeleccionada=this.habitacionesOcupadas[0].id,this.unaHabitacion=!0,this.mostrarModal=!1):(this.unaHabitacion=!1,this.mostrarModal=!1)},n=>{console.error(n)})}onClienteSeleccionado(e){e&&e.length>0?this.obtenerHabitacionesOcupadas(e[0].id):this.resetHabitaciones()}resetHabitaciones(){this.habitacionesOcupadas=[],this.unaHabitacion=!1,this.habitacionSeleccionada=null,this.mostrarModal=!1}seleccionarHabitacion(e){this.habitacionSeleccionada=e,this.mostrarModal=!0,this.unaHabitacion=!0}cargarAHabitacion(){if(this.habitacionSeleccionada&&(this.productosAgregados.length>0||this.recetasAgregadas.length>0)){const e={habitacion_id:this.habitacionSeleccionada,items:[...this.productosAgregados.map(n=>({id:n.id,cantidad:n.cantidad,tipo:this.getTipoId(n.tipo_servicio_id),valor:n.total})),...this.recetasAgregadas.map(n=>({id:n.id,cantidad:n.cantidad,tipo:this.getTipoId(n.tipo_servicio_id),valor:n.total}))]};this.saleService.cargarItemsAHabitacion(e).subscribe(n=>{this.mostrarModal=!1,U().fire("\xc9xito","Items cargados exitosamente a la habitaci\xf3n","success").then(()=>{this.resetHabitaciones(),this.productosAgregados=[],this.recetasAgregadas=[],this.total=0,this.router.navigate(["/dashboard/dashboardSell"])})},n=>{U().fire("Error","Hubo un error al cargar los items a la habitaci\xf3n","error")})}}getTipoId(e){switch(e){case 1:return 1;case 2:return 2;case 4:return 4;default:throw new Error("Tipo desconocido")}}onHabitacionSeleccionada(e){e&&e.length>0?(this.habitacionSeleccionada=e[0].id,this.unaHabitacion=!0):(this.habitacionSeleccionada=null,this.unaHabitacion=!1)}static#t=this.\u0275fac=function(n){return new(n||a)(t.Y36(o.qu),t.Y36(C.t2),t.Y36(T),t.Y36(b.F0),t.Y36(Y.P))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-sale-detail"]],decls:132,vars:83,consts:[["type","ball-scale-multiple"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-center","flex-column","lg:flex-row"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",1,"p-button-outlined","mr-4",3,"routerLink"],[1,"font-medium","text-3xl","text-900"],[1,"card","mt-3",2,"margin-bottom","14px"],[1,"p-fluid"],[1,"col-12",2,"display","flex","justify-content","space-between","align-items","center","width","100%"],[1,"col-4",2,"display","flex","flex-direction","column",3,"formGroup"],["for","cliente",2,"font-size","large","margin-bottom","15px"],["formControlName","cliente_id","selectionLimit","1","optionLabel","nombres","placeholder","Buscar hu\xe9sped","display","chip","emptyMessage","Cargando hu\xe9spedes...",1,"multiselect-custom",3,"options","onChange"],["pTemplate","item"],["pTemplate","footer"],[1,"col-4",2,"display","flex","flex-direction","column","align-items","center","justify-content","center"],[1,"flex-grow-1","text-right",2,"margin-top","40px"],["pButton","","pRipple","","label","Seleccionar habitaci\xf3n",1,"p-button","mr-2",3,"disabled","click"],[1,"col-4",2,"display","flex","flex-direction","column","align-items","flex-end","justify-content","flex-end"],[2,"display","flex","flex-direction","column","gap","10px"],[1,"font-medium","text-3xl","text-500"],["pButton","","pRipple","","label","Pagar",1,"p-button","mr-2",2,"width","100%",3,"disabled","click"],["pButton","","pRipple","","label","Cargar a habitaci\xf3n","class","p-button mr-2",3,"click",4,"ngIf"],[1,"grid"],[1,"col-12"],[1,"card",2,"padding","30px","margin-top","0"],[1,"col-12","lg:col-5"],["responsiveLayout","scroll",3,"value","tableStyle","rows"],["pTemplate","header"],["pTemplate","body"],[1,"col-7"],[2,"padding","10px"],["header","Agregar Producto/Servicio",3,"visible","modal","draggable","resizable","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-6","md:col-6"],["formControlName","producto_id","placeholder","Buscar Producto/Servicio","optionLabel","nombre","emptyMessage","Cargando productos...",1,"dropdown-custom",3,"options","onChange"],["style","margin-top: 14px;",4,"ngIf"],["type","number","min","1","formControlName","cantidad","placeholder","Cantidad","pInputText","",1,"w-full","mb-3","border-round-3xl",3,"input"],["style","color: red;",4,"ngIf"],["style","color: orangered;",4,"ngIf"],[1,"field","col-12","md:col-12"],["pButton","","pRipple","","label","Agregar Producto","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"disabled"],["header","Agregar Receta",3,"visible","modal","draggable","resizable","visibleChange"],["formControlName","receta_id","placeholder","Buscar Receta","optionLabel","nombre","emptyMessage","Cargando recetas...",1,"dropdown-custom",3,"options"],["type","number","min","1","formControlName","cantidad","placeholder","Cantidad","pInputText","",1,"w-full","mb-3","border-round-3xl"],["class","field col-12","style","color: red;",4,"ngIf"],["pButton","","pRipple","","label","Agregar Receta","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"disabled"],["header","Facturar",3,"visible","modal","draggable","resizable","visibleChange"],["formArrayName","metodos_pago",1,"p-fluid","p-formgrid","grid"],[1,"field","col-12"],[1,"font-medium","text-2xl","text-500","text-center"],["optionLabel","nombre","emptyMessage","Cargando m\xe9todos de pago...","placeholder","Buscar M\xe9todo de Pago",1,"dropdown-custom",3,"options","autoDisplayFirst","onChange"],["class","grid",3,"formGroupName",4,"ngFor","ngForOf"],["class","col-6","style","padding: 0; margin-top: 15px;",4,"ngIf"],[1,"flex",2,"justify-content","space-between"],[1,"flex","align-items-center",2,"gap","10px"],["severity","info","text","Generar Factura electronica"],["formControlName","isFacturaElectronica"],[1,"flex","flex-column","justify-end",2,"justify-content","end","align-items","end"],[1,"font-medium","text-2xl","text-500","text-right"],["pButton","","pRipple","","icon","",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"label","disabled","click"],["header","Seleccione una habitaci\xf3n",3,"visible","modal","draggable","resizable","visibleChange"],["class","col-6","style","margin-bottom: 10px;",4,"ngFor","ngForOf"],[1,"modal-footer"],["pButton","","pRipple","",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"label","click"],[3,"vieneDeHabitaciones","clienteCreado",4,"ngIf"],[1,"flex","align-items-center"],[1,"ml-2"],["pButton","","pRipple","","label","Registrar nuevo hu\xe9sped","type","button","icon","pi pi-plus",1,"w-full","bg-blue","boder-blue","mb-5","border-round-3xl",3,"click"],["pButton","","pRipple","","label","Cargar a habitaci\xf3n",1,"p-button","mr-2",3,"click"],[4,"ngIf","ngIfElse"],["emptyTd",""],["pButton","","pRipple","","icon","pi pi-plus",1,"p-button",3,"click"],["style","color: orangered; font-size: xx-large;",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"click"],[2,"color","orangered","font-size","xx-large"],["colspan","1"],["colspan","2"],[4,"ngIf"],["colspan","6",2,"color","orangered"],[1,"flex","align-items-center",2,"display","flex","justify-content","space-between"],[1,"padding",3,"value"],[2,"margin-top","14px"],[2,"color","red"],[2,"color","orangered"],[1,"field","col-12",2,"color","red"],[1,"grid",3,"formGroupName"],[1,"col-6","md:col-5"],["type","text","min","1","formControlName","nombre","placeholder","Metodo de pago","pInputText","","disabled","",1,"w-full","mb-3","border-round-3xl"],[1,"col-4","md:col-5"],["type","number","min","1","formControlName","valor","placeholder","Valor","pInputText","",1,"w-full","mb-3","border-round-3xl",3,"blur"],["class","col-2 mt-4 eliminar-metodo-pago",4,"ngIf"],[1,"col-2","mt-4","eliminar-metodo-pago"],["pRipple","","type","button","icon","pi pi-trash","severity","danger",3,"click"],[1,"col-6",2,"padding","0","margin-top","15px"],["severity","error","text","El total ingresado no es igual al total a pagar"],[1,"col-6",2,"margin-bottom","10px"],[1,"p-card",2,"cursor","pointer",3,"ngClass","click"],[1,"p-card-body"],[3,"vieneDeHabitaciones","clienteCreado"],["clientes",""]],template:function(n,i){1&n&&(t._UZ(0,"ngx-spinner",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div"),t._UZ(4,"button",3),t.qZA(),t.TgZ(5,"div")(6,"div",4),t._uU(7,"Crear venta"),t.qZA()()()(),t.TgZ(8,"div",5)(9,"p-toolbar",6)(10,"div",7)(11,"div",8)(12,"label",9),t._uU(13,"Hu\xe9sped"),t.qZA(),t.TgZ(14,"p-multiSelect",10),t.NdJ("onChange",function(l){return i.onClienteSeleccionado(l.value)}),t.YNc(15,ct,3,3,"ng-template",11),t.YNc(16,pt,1,0,"ng-template",12),t.qZA()(),t.TgZ(17,"div",13)(18,"div",14)(19,"button",15),t.NdJ("click",function(){return i.mostrarModal=!0}),t.qZA()()(),t.TgZ(20,"div",16)(21,"div",17)(22,"div",18),t._uU(23),t.ALo(24,"currencyFormat"),t.qZA(),t.TgZ(25,"button",19),t.NdJ("click",function(){return i.modals("Pagar")}),t.qZA(),t.YNc(26,dt,1,0,"button",20),t.qZA()()()()(),t.TgZ(27,"div",21)(28,"div",22)(29,"div",23)(30,"h3"),t._uU(31,"Detalles de venta"),t.qZA(),t.TgZ(32,"div",21)(33,"div",24)(34,"p-table",25),t.YNc(35,ut,7,0,"ng-template",26),t.YNc(36,_t,9,6,"ng-template",27),t.qZA()(),t.TgZ(37,"div",28)(38,"div",29)(39,"h5"),t._uU(40,"Productos/Servicios"),t.qZA(),t.TgZ(41,"p-table",25),t.YNc(42,ht,13,0,"ng-template",26),t.YNc(43,vt,18,14,"ng-template",27),t.YNc(44,Tt,13,10,"ng-template",12),t.qZA()(),t._UZ(45,"hr"),t.TgZ(46,"div",29)(47,"h5"),t._uU(48,"Recetas"),t.qZA(),t.TgZ(49,"p-table",25),t.YNc(50,xt,13,0,"ng-template",26),t.YNc(51,Ct,16,11,"ng-template",27),t.YNc(52,Zt,14,9,"ng-template",12),t.qZA()()()()()()(),t.TgZ(53,"p-dialog",30),t.NdJ("visibleChange",function(l){return i.displayModalProducts=l}),t.TgZ(54,"div",22)(55,"form",31),t.NdJ("ngSubmit",function(){return i.agregarProductos()}),t.TgZ(56,"div",32)(57,"div",33)(58,"label"),t._uU(59,"Producto/Servicio"),t.qZA(),t.TgZ(60,"p-dropdown",34),t.NdJ("onChange",function(){return i.validarStock("producto")}),t.YNc(61,At,8,7,"ng-template",11),t.qZA(),t.YNc(62,It,2,1,"div",35),t.qZA(),t.TgZ(63,"div",33)(64,"label"),t._uU(65,"Cantidad"),t.qZA(),t.TgZ(66,"input",36),t.NdJ("input",function(){return i.validarStock("producto")}),t.qZA(),t.YNc(67,St,2,0,"div",37),t.YNc(68,Pt,2,0,"div",38),t.qZA(),t.TgZ(69,"div",39),t._UZ(70,"button",40),t.qZA()(),t._UZ(71,"br"),t.qZA()()(),t.TgZ(72,"p-dialog",41),t.NdJ("visibleChange",function(l){return i.displayModalRecipes=l}),t.TgZ(73,"div",22)(74,"form",31),t.NdJ("ngSubmit",function(){return i.agregarRecetas()}),t.TgZ(75,"div",32)(76,"div",33)(77,"label"),t._uU(78,"Receta"),t.qZA(),t.TgZ(79,"p-dropdown",42),t.YNc(80,Mt,5,4,"ng-template",11),t.qZA(),t.YNc(81,Ut,2,1,"div",35),t.qZA(),t.TgZ(82,"div",33)(83,"label"),t._uU(84,"Cantidad"),t.qZA(),t._UZ(85,"input",43),t.YNc(86,Et,2,0,"div",37),t.YNc(87,qt,2,0,"div",44),t.qZA(),t.TgZ(88,"div",39),t._UZ(89,"button",45),t.qZA()(),t._UZ(90,"br"),t.qZA()()(),t.TgZ(91,"p-dialog",46),t.NdJ("visibleChange",function(l){return i.displayModalMetodosPago=l}),t.TgZ(92,"div",22)(93,"form",31),t.NdJ("ngSubmit",function(){return i.submitFactura()}),t.TgZ(94,"div",47)(95,"div",48)(96,"div",49),t._uU(97),t.ALo(98,"currencyFormat"),t.qZA()(),t.TgZ(99,"div",48)(100,"label"),t._uU(101,"Agregar m\xe9todo de pago"),t.qZA(),t.TgZ(102,"p-dropdown",50),t.NdJ("onChange",function(l){return i.agregarMetodoPago(l)}),t.YNc(103,wt,3,1,"ng-template",11),t.qZA()(),t.TgZ(104,"div",48),t.YNc(105,Nt,11,3,"div",51),t.YNc(106,Rt,2,0,"div",52),t._UZ(107,"hr"),t.TgZ(108,"div",53)(109,"div",54),t._UZ(110,"p-message",55),t.TgZ(111,"form",31),t.NdJ("ngSubmit",function(){return i.submitFacturaElectronica()}),t._UZ(112,"p-inputSwitch",56),t.qZA()(),t.TgZ(113,"div",57)(114,"div",58),t._uU(115),t.ALo(116,"currencyFormat"),t.qZA(),t.TgZ(117,"div",58),t._uU(118),t.ALo(119,"currencyFormat"),t.ALo(120,"currencyFormat"),t.qZA()()()()(),t.TgZ(121,"div",48)(122,"button",59),t.NdJ("click",function(){return i.crearVenta()}),t.qZA()()()()(),t.TgZ(123,"p-dialog",60),t.NdJ("visibleChange",function(l){return i.mostrarModal=l}),t.TgZ(124,"div",22)(125,"div",32)(126,"div",39)(127,"div",21),t.YNc(128,Ot,5,4,"div",61),t.qZA()()()(),t.TgZ(129,"div",62)(130,"button",63),t.NdJ("click",function(){return i.cargarAHabitacion()}),t.qZA()()(),t.YNc(131,Qt,2,1,"app-clientes",64)),2&n&&(t.xp6(4),t.Q6J("routerLink","/dashboard/dashboardSell"),t.xp6(7),t.Q6J("formGroup",i.formCliente),t.xp6(3),t.Q6J("options",i.clienteData),t.xp6(5),t.Q6J("disabled",i.habitacionesOcupadas.length<=1||0===i.productosAgregados.length&&0===i.recetasAgregadas.length),t.xp6(4),t.hij("Total: $",t.lcZ(24,66,i.total),""),t.xp6(2),t.Q6J("disabled",i.total<1),t.xp6(1),t.Q6J("ngIf",i.unaHabitacion&&(i.productosAgregados.length>0||i.recetasAgregadas.length>0)),t.xp6(8),t.Q6J("value",i.totales)("tableStyle",t.DdM(76,Lt))("rows",8),t.xp6(7),t.Q6J("value",i.productosAgregados)("tableStyle",t.DdM(77,z))("rows",5),t.xp6(8),t.Q6J("value",i.recetasAgregadas)("tableStyle",t.DdM(78,z))("rows",5),t.xp6(4),t.Akn(t.DdM(79,O)),t.Q6J("visible",i.displayModalProducts)("modal",!0)("draggable",!1)("resizable",!1),t.xp6(2),t.Q6J("formGroup",i.formProducto),t.xp6(5),t.Q6J("options",i.productsData),t.xp6(2),t.Q6J("ngIf",i.formProducto.get("producto_id").errors&&(i.formProducto.get("producto_id").dirty||i.formProducto.get("producto_id").touched)),t.xp6(5),t.Q6J("ngIf",i.formProducto.get("cantidad").hasError("required")),t.xp6(1),t.Q6J("ngIf",i.validacionStock),t.xp6(2),t.Q6J("disabled",i.formProducto.invalid||i.validacionStock),t.xp6(2),t.Akn(t.DdM(80,O)),t.Q6J("visible",i.displayModalRecipes)("modal",!0)("draggable",!1)("resizable",!1),t.xp6(2),t.Q6J("formGroup",i.formReceta),t.xp6(5),t.Q6J("options",i.recetasData),t.xp6(2),t.Q6J("ngIf",i.formReceta.get("receta_id").errors&&(i.formReceta.get("receta_id").dirty||i.formReceta.get("receta_id").touched)),t.xp6(5),t.Q6J("ngIf",i.formReceta.get("cantidad").hasError("required")),t.xp6(1),t.Q6J("ngIf",i.validacionStock),t.xp6(2),t.Q6J("disabled",i.formReceta.invalid),t.xp6(2),t.Akn(t.DdM(81,Yt)),t.Q6J("visible",i.displayModalMetodosPago)("modal",!0)("draggable",!1)("resizable",!1),t.xp6(2),t.Q6J("formGroup",i.formMetodoPago),t.xp6(4),t.hij("Total a pagar: $",t.lcZ(98,68,i.total),""),t.xp6(5),t.Q6J("options",i.dataMetodosPago)("autoDisplayFirst",!1),t.xp6(3),t.Q6J("ngForOf",i.metodosPago.controls),t.xp6(1),t.Q6J("ngIf",i.totalMetodosPago!=i.total),t.xp6(5),t.Q6J("formGroup",i.formFacturar),t.xp6(4),t.hij("Total ingresado: $",t.lcZ(116,70,i.totalMetodosPago),""),t.xp6(3),t.hij("Pendiente: $",i.total-i.totalMetodosPago>0?t.lcZ(119,72,i.total-i.totalMetodosPago):t.lcZ(120,74,0),""),t.xp6(4),t.Q6J("label","Pagar")("disabled",i.totalMetodosPago!=i.total||0===i.total||i.formMetodoPago.invalid),t.xp6(1),t.Akn(t.DdM(82,O)),t.Q6J("visible",i.mostrarModal)("modal",!0)("draggable",!1)("resizable",!1),t.xp6(5),t.Q6J("ngForOf",i.habitacionesOcupadas),t.xp6(2),t.Q6J("label","Cargar a habitaci\xf3n"),t.xp6(1),t.Q6J("ngIf",i.creandoCliente))},dependencies:[_.mk,_.sg,_.O5,b.rH,v.iA,B.jx,Z.Hq,Z.zx,o._Y,o.Fj,o.wV,o.JJ,o.JL,o.qQ,y.H,E.o,q.o,g.Lt,A.V,o.sg,o.u,o.x0,o.CE,C.Ro,V.NU,j.V,lt.R,G.q,K.Ql,_.rS,H.D],styles:['@charset "UTF-8";.flex[_ngcontent-%COMP%]{display:flex;align-items:center}.flex-grow-1[_ngcontent-%COMP%]{flex-grow:1}.text-right[_ngcontent-%COMP%]{text-align:right}.mr-2[_ngcontent-%COMP%]{margin-right:2rem}.multiselect-custom[_ngcontent-%COMP%]{width:100%!important}.padding[_ngcontent-%COMP%]{padding:1%}.selected-card[_ngcontent-%COMP%]{background-color:#5e5f601a}']})}return a})(),Ht=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.oAB({type:a});static#i=this.\u0275inj=t.cJS({imports:[b.Bz.forChild([{path:"",component:rt,canActivate:[$.a],data:{permissions:["dashboard.venta"]}},{path:"sale-detail",component:Bt,canActivate:[$.a],data:{permissions:["dashboard.venta"]}}]),b.Bz]})}return a})();var $t=s(2169),Vt=s(5617),jt=s(6208);let Gt=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.oAB({type:a});static#i=this.\u0275inj=t.cJS({providers:[{provide:I.TP,useClass:N.n,multi:!0},T],imports:[_.ez,Ht,v.U$,S.O,o.u5,Z.hJ,y.T,M.EV,E.V,J.Xt,q.j,k.A,g.kW,D.cc,x.L$,A.S,u.ii.forRoot(),o.UX,C.ef,p.U,h.dp,V.q4,$t.o,j.W,Vt.ClientesModule,G.O,jt.m,K.Iu]})}return a})()},9326:(R,P,s)=>{s.d(P,{D:()=>o});var _=s(4946);let o=(()=>{class v{transform(Z){if(""===Z)return"";const y=Number(Z).toFixed(2),[M,E]=y.split(".");return M.replace(/\B(?=(\d{3})+(?!\d))/g,".")}static#t=this.\u0275fac=function(y){return new(y||v)};static#e=this.\u0275pipe=_.Yjl({name:"currencyFormat",type:v,pure:!0})}return v})()},6208:(R,P,s)=>{s.d(P,{m:()=>v});var _=s(6814),o=s(4946);let v=(()=>{class S{static#t=this.\u0275fac=function(M){return new(M||S)};static#e=this.\u0275mod=o.oAB({type:S});static#i=this.\u0275inj=o.cJS({imports:[_.ez]})}return S})()},2169:(R,P,s)=>{s.d(P,{o:()=>C});var _=s(6814),o=s(4946),v=s(5219),S=s(8468);let C=(()=>{class p{static \u0275fac=function(t){return new(t||p)};static \u0275mod=o.oAB({type:p});static \u0275inj=o.cJS({imports:[_.ez,S.x,v.m8,v.m8]})}return p})()},7161:(R,P,s)=>{s.d(P,{O:()=>N,q:()=>I});var _=s(6814),o=s(4946),v=s(2591),S=s(2736),Z=s(3823),y=s(8468);function M(u,C){1&u&&o._UZ(0,"CheckIcon",4),2&u&&o.Q6J("styleClass","p-inline-message-icon")}function E(u,C){1&u&&o._UZ(0,"InfoCircleIcon",4),2&u&&o.Q6J("styleClass","p-inline-message-icon")}function J(u,C){1&u&&o._UZ(0,"TimesCircleIcon",4),2&u&&o.Q6J("styleClass","p-inline-message-icon")}function q(u,C){1&u&&o._UZ(0,"ExclamationTriangleIcon",4),2&u&&o.Q6J("styleClass","p-inline-message-icon")}function k(u,C){if(1&u&&o._UZ(0,"span",6),2&u){const p=o.oxw(2);o.Q6J("innerHTML",p.text,o.oJD)}}function g(u,C){if(1&u&&(o.TgZ(0,"div"),o.YNc(1,k,1,1,"span",5),o.qZA()),2&u){const p=o.oxw();o.xp6(1),o.Q6J("ngIf",!p.escape)}}function D(u,C){if(1&u&&(o.TgZ(0,"span",8),o._uU(1),o.qZA()),2&u){const p=o.oxw(2);o.xp6(1),o.Oqu(p.text)}}function x(u,C){if(1&u&&o.YNc(0,D,2,1,"span",7),2&u){const p=o.oxw();o.Q6J("ngIf",p.escape)}}const A=function(u,C,p,h,c){return{"p-inline-message-info":u,"p-inline-message-warn":C,"p-inline-message-error":p,"p-inline-message-success":h,"p-inline-message-icon-only":c}};let I=(()=>{class u{severity;text;escape=!0;style;styleClass;get icon(){return this.severity&&this.severity.trim()?this.severity:"info"}static \u0275fac=function(h){return new(h||u)};static \u0275cmp=o.Xpm({type:u,selectors:[["p-message"]],hostAttrs:[1,"p-element"],inputs:{severity:"severity",text:"text",escape:"escape",style:"style",styleClass:"styleClass"},decls:8,vars:16,consts:[["aria-live","polite",1,"p-inline-message","p-component","p-inline-message",3,"ngStyle","ngClass"],[3,"styleClass",4,"ngIf"],[4,"ngIf","ngIfElse"],["escapeOut",""],[3,"styleClass"],["class","p-inline-message-text",3,"innerHTML",4,"ngIf"],[1,"p-inline-message-text",3,"innerHTML"],["class","p-inline-message-text",4,"ngIf"],[1,"p-inline-message-text"]],template:function(h,c){if(1&h&&(o.TgZ(0,"div",0),o.YNc(1,M,1,1,"CheckIcon",1),o.YNc(2,E,1,1,"InfoCircleIcon",1),o.YNc(3,J,1,1,"TimesCircleIcon",1),o.YNc(4,q,1,1,"ExclamationTriangleIcon",1),o.YNc(5,g,2,1,"div",2),o.YNc(6,x,1,1,"ng-template",null,3,o.W1O),o.qZA()),2&h){const t=o.MAs(7);o.Tol(c.styleClass),o.Q6J("ngStyle",c.style)("ngClass",o.qbA(10,A,"info"===c.severity,"warn"===c.severity,"error"===c.severity,"success"===c.severity,null==c.text)),o.xp6(1),o.Q6J("ngIf","success"===c.icon),o.xp6(1),o.Q6J("ngIf","info"===c.icon),o.xp6(1),o.Q6J("ngIf","error"===c.icon),o.xp6(1),o.Q6J("ngIf","warn"===c.icon),o.xp6(1),o.Q6J("ngIf",!c.escape)("ngIfElse",t)}},dependencies:function(){return[_.mk,_.O5,_.PC,v.n,Z.u,y.x,S.L]},styles:[".p-inline-message{display:inline-flex;align-items:center;justify-content:center;vertical-align:top}.p-inline-message-icon-only .p-inline-message-text{visibility:hidden;width:0}.p-fluid .p-inline-message{display:flex}\n"],encapsulation:2,changeDetection:0})}return u})(),N=(()=>{class u{static \u0275fac=function(h){return new(h||u)};static \u0275mod=o.oAB({type:u});static \u0275inj=o.cJS({imports:[_.ez,v.n,Z.u,y.x,S.L]})}return u})()},6263:(R,P,s)=>{s.d(P,{V:()=>q,W:()=>k});var _=s(6814),o=s(4946),v=s(5219);function S(g,D){if(1&g&&o._UZ(0,"span",5),2&g){const x=o.oxw(2);o.Q6J("ngClass",x.icon)}}function Z(g,D){if(1&g&&(o.ynx(0),o.YNc(1,S,1,1,"span",4),o.BQk()),2&g){const x=o.oxw();o.xp6(1),o.Q6J("ngIf",x.icon)}}function y(g,D){}function M(g,D){1&g&&o.YNc(0,y,0,0,"ng-template")}function E(g,D){if(1&g&&(o.TgZ(0,"span",6),o.YNc(1,M,1,0,null,7),o.qZA()),2&g){const x=o.oxw();o.xp6(1),o.Q6J("ngTemplateOutlet",x.iconTemplate)}}const J=["*"];let q=(()=>{class g{style;styleClass;severity;value;icon;rounded;templates;iconTemplate;ngAfterContentInit(){this.templates?.forEach(x=>{"icon"===x.getType()&&(this.iconTemplate=x.template)})}containerClass(){return{"p-tag p-component":!0,"p-tag-info":"info"===this.severity,"p-tag-success":"success"===this.severity,"p-tag-warning":"warning"===this.severity,"p-tag-danger":"danger"===this.severity,"p-tag-rounded":this.rounded}}static \u0275fac=function(A){return new(A||g)};static \u0275cmp=o.Xpm({type:g,selectors:[["p-tag"]],contentQueries:function(A,I,N){if(1&A&&o.Suo(N,v.jx,4),2&A){let u;o.iGM(u=o.CRH())&&(I.templates=u)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",severity:"severity",value:"value",icon:"icon",rounded:"rounded"},ngContentSelectors:J,decls:6,vars:7,consts:[[3,"ngClass","ngStyle"],[4,"ngIf"],["class","p-tag-icon",4,"ngIf"],[1,"p-tag-value"],["class","p-tag-icon",3,"ngClass",4,"ngIf"],[1,"p-tag-icon",3,"ngClass"],[1,"p-tag-icon"],[4,"ngTemplateOutlet"]],template:function(A,I){1&A&&(o.F$t(),o.TgZ(0,"span",0),o.Hsn(1),o.YNc(2,Z,2,1,"ng-container",1),o.YNc(3,E,2,1,"span",2),o.TgZ(4,"span",3),o._uU(5),o.qZA()()),2&A&&(o.Tol(I.styleClass),o.Q6J("ngClass",I.containerClass())("ngStyle",I.style),o.xp6(2),o.Q6J("ngIf",!I.iconTemplate),o.xp6(1),o.Q6J("ngIf",I.iconTemplate),o.xp6(2),o.Oqu(I.value))},dependencies:[_.mk,_.O5,_.tP,_.PC],styles:[".p-tag{display:inline-flex;align-items:center;justify-content:center}.p-tag-icon,.p-tag-value,.p-tag-icon.pi{line-height:1.5}.p-tag.p-tag-rounded{border-radius:10rem}\n"],encapsulation:2,changeDetection:0})}return g})(),k=(()=>{class g{static \u0275fac=function(A){return new(A||g)};static \u0275mod=o.oAB({type:g});static \u0275inj=o.cJS({imports:[_.ez,v.m8,v.m8]})}return g})()}}]);