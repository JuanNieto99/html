"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[916],{7916:(je,Z,d)=>{d.r(Z),d.d(Z,{ProductsModule:()=>Ve});var g=d(6814),a=d(95),h=d(8027),P=d(6068),_=d(707),x=d(4480),Q=d(4104),O=d(6340),M=d(6022),T=d(3714),q=d(6218),A=d(2352),Y=d(1865),F=d(354),U=d(7213),E=d(9862),R=d(8712),D=d(5722),I=d(4670),k=d(3519),p=d.n(k),e=d(4946),w=d(5619),z=d(4444);let y=(()=>{class o{constructor(t){this.httpClient=t,this.dataSubject=new w.X([]),this.endpointListar="/productoListar",this.endpointProductGet="/productoEditar/",this.endpointProductCreate="/productoCrear/",this.endpointProductUpdate="/productoActualizar",this.endpointEliminar="/productoEliminar",this.data=this.dataSubject.asObservable(),this.baseUrl=z.D.url}getAll(t,r=""){return this.httpClient.post(`${this.baseUrl+this.endpointListar}?per_page=${t}&search=${r}`,{})}getProducto(t){return this.httpClient.get(`${this.baseUrl+this.endpointProductGet+t}`)}refreshUsersData(){this.getAll(30).subscribe(t=>{this.dataSubject.next(t.data)},t=>{console.log("Error: ",t)})}createProduct(t){return this.httpClient.post(`${this.baseUrl+this.endpointProductCreate}`,t)}eliminarProduct(t){return this.httpClient.post(`${this.baseUrl+this.endpointEliminar}`,t)}updateProducto(t){return this.httpClient.post(`${this.baseUrl+this.endpointProductUpdate}`,t)}static#e=this.\u0275fac=function(r){return new(r||o)(e.LFG(E.eN))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var B=d(8645),V=d(2181),j=d(9773),u=d(6825),L=d(6593);const G=["overlay"];function H(o,s){1&o&&e._UZ(0,"div")}function $(o,s){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,H,1,0,"div",6),e.qZA()),2&o){const t=e.oxw(2);e.Tol(t.spinner.class),e.Udp("color",t.spinner.color),e.xp6(1),e.Q6J("ngForOf",t.spinner.divArray)}}function X(o,s){if(1&o&&(e._UZ(0,"div",7),e.ALo(1,"safeHtml")),2&o){const t=e.oxw(2);e.Q6J("innerHTML",e.lcZ(1,1,t.template),e.oJD)}}function K(o,s){if(1&o&&(e.TgZ(0,"div",1,2),e.YNc(2,$,2,5,"div",3),e.YNc(3,X,2,3,"div",4),e.TgZ(4,"div",5),e.Hsn(5),e.qZA()()),2&o){const t=e.oxw();e.Udp("background-color",t.spinner.bdColor)("z-index",t.spinner.zIndex)("position",t.spinner.fullScreen?"fixed":"absolute"),e.Q6J("@.disabled",t.disableAnimation)("@fadeIn","in"),e.xp6(2),e.Q6J("ngIf",!t.template),e.xp6(1),e.Q6J("ngIf",t.template),e.xp6(1),e.Udp("z-index",t.spinner.zIndex)}}const W=["*"],ee={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":4,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1},C="primary";class m{constructor(s){Object.assign(this,s)}static create(s){return!s?.template&&!s?.type&&console.warn('[ngx-spinner]: Property "type" is missed. Please, provide animation type to <ngx-spinner> component\n        and ensure css is added to angular.json file'),new m(s)}}let N=(()=>{class o{constructor(){this.spinnerObservable=new w.X(null)}getSpinner(t){return this.spinnerObservable.asObservable().pipe((0,V.h)(r=>r&&r.name===t))}show(t=C,r){return new Promise((i,n)=>{setTimeout(()=>{r&&Object.keys(r).length?(r.name=t,this.spinnerObservable.next(new m({...r,show:!0})),i(!0)):(this.spinnerObservable.next(new m({name:t,show:!0})),i(!0))},10)})}hide(t=C,r=10){return new Promise((i,n)=>{setTimeout(()=>{this.spinnerObservable.next(new m({name:t,show:!1})),i(!0)},r)})}static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const S=new e.OlP("NGX_SPINNER_CONFIG");let te=(()=>{class o{constructor(t){this._sanitizer=t}transform(t){if(t)return this._sanitizer.bypassSecurityTrustHtml(t)}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(L.H7,16))};static#t=this.\u0275pipe=e.Yjl({name:"safeHtml",type:o,pure:!0})}return o})(),ie=(()=>{class o{constructor(t,r,i,n){this.spinnerService=t,this.changeDetector=r,this.elementRef=i,this.globalConfig=n,this.disableAnimation=!1,this.spinner=new m,this.ngUnsubscribe=new B.x,this.setDefaultOptions=()=>{const{type:l}=this.globalConfig??{};this.spinner=m.create({name:this.name,bdColor:this.bdColor,size:this.size,color:this.color,type:this.type??l,fullScreen:this.fullScreen,divArray:this.divArray,divCount:this.divCount,show:this.show,zIndex:this.zIndex,template:this.template,showSpinner:this.showSpinner})},this.bdColor="rgba(51,51,51,0.8)",this.zIndex=99999,this.color="#fff",this.size="large",this.fullScreen=!0,this.name=C,this.template=null,this.showSpinner=!1,this.divArray=[],this.divCount=0,this.show=!1}initObservable(){this.spinnerService.getSpinner(this.name).pipe((0,j.R)(this.ngUnsubscribe)).subscribe(t=>{this.setDefaultOptions(),Object.assign(this.spinner,t),t.show&&this.onInputChange(),this.changeDetector.detectChanges()})}ngOnInit(){this.setDefaultOptions(),this.initObservable()}isSpinnerZone(t){return t===this.elementRef.nativeElement.parentElement||t.parentNode&&this.isSpinnerZone(t.parentNode)}ngOnChanges(t){for(const r in t)if(r){const i=t[r];if(i.isFirstChange())return;typeof i.currentValue<"u"&&i.currentValue!==i.previousValue&&""!==i.currentValue&&(this.spinner[r]=i.currentValue,"showSpinner"===r&&(i.currentValue?this.spinnerService.show(this.spinner.name,this.spinner):this.spinnerService.hide(this.spinner.name)),"name"===r&&this.initObservable())}}getClass(t,r){this.spinner.divCount=ee[t],this.spinner.divArray=Array(this.spinner.divCount).fill(0).map((n,l)=>l);let i="";switch(r.toLowerCase()){case"small":i="la-sm";break;case"medium":i="la-2x";break;case"large":i="la-3x"}return"la-"+t+" "+i}onInputChange(){this.spinner.class=this.getClass(this.spinner.type,this.spinner.size)}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(N),e.Y36(e.sBO),e.Y36(e.SBq),e.Y36(S,8))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["ngx-spinner"]],viewQuery:function(r,i){if(1&r&&e.Gf(G,5),2&r){let n;e.iGM(n=e.CRH())&&(i.spinnerDOM=n.first)}},inputs:{bdColor:"bdColor",size:"size",color:"color",type:"type",fullScreen:"fullScreen",name:"name",zIndex:"zIndex",template:"template",showSpinner:"showSpinner",disableAnimation:"disableAnimation"},features:[e.TTD],ngContentSelectors:W,decls:1,vars:1,consts:[["class","ngx-spinner-overlay",3,"background-color","z-index","position",4,"ngIf"],[1,"ngx-spinner-overlay"],["overlay",""],[3,"class","color",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[1,"loading-text"],[4,"ngFor","ngForOf"],[3,"innerHTML"]],template:function(r,i){1&r&&(e.F$t(),e.YNc(0,K,6,12,"div",0)),2&r&&e.Q6J("ngIf",i.spinner.show)},dependencies:[g.sg,g.O5,te],styles:[".ngx-spinner-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%}.ngx-spinner-overlay[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.loading-text){top:50%;left:50%;margin:0;position:absolute;transform:translate(-50%,-50%)}.loading-text[_ngcontent-%COMP%]{position:absolute;top:60%;left:50%;transform:translate(-50%,-60%)}"],data:{animation:[(0,u.X$)("fadeIn",[(0,u.SB)("in",(0,u.oB)({opacity:1})),(0,u.eR)(":enter",[(0,u.oB)({opacity:0}),(0,u.jt)(300)]),(0,u.eR)(":leave",(0,u.jt)(200,(0,u.oB)({opacity:0})))])]},changeDetection:0})}return o})(),oe=(()=>{class o{static forRoot(t){return{ngModule:o,providers:[{provide:S,useValue:t}]}}static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275mod=e.oAB({type:o});static#i=this.\u0275inj=e.cJS({imports:[g.ez]})}return o})();var re=d(5219);const ne=["fileUpload"],ae=["fileUploadCreate"];function se(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",40)(1,"h5",41),e._uU(2,"Lista de Productos"),e.qZA(),e.TgZ(3,"span",42)(4,"form",43)(5,"input",44),e.NdJ("input",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.search(i.dt))}),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("formGroup",t.formSearch)}}function de(o,s){1&o&&(e.TgZ(0,"tr")(1,"th",45),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Medida"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Precio"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Cantidad"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Inventario"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Visible Venta"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Acciones"),e.qZA()())}function le(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",46),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td",47)(16,"p-button",48),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.editProduct(n.id))}),e.qZA(),e._UZ(17,"p-confirmDialog"),e.TgZ(18,"p-button",49),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.confirmDelete(n.id))}),e.qZA()()()}if(2&o){const t=s.$implicit,r=e.oxw();e.xp6(2),e.Q6J("value",r.productsData),e.xp6(2),e.Oqu(t.nombre),e.xp6(2),e.Oqu(t.medida.nombre),e.xp6(2),e.Oqu(t.precio),e.xp6(2),e.Oqu(t.cantidad),e.xp6(2),e.Oqu(t.inventario.nombre),e.xp6(2),e.Oqu(t.visible_venta?"si":"No")}}function ce(o,s){1&o&&(e.TgZ(0,"tr")(1,"td",50),e._uU(2,"Cargando informacion porfavor espere ..."),e.qZA()())}function ue(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function pe(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function me(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function fe(o,s){if(1&o&&(e.TgZ(0,"div",51),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("El n\xfamero debe ser mayor o igua a ",null==t.formCreateProduct||null==t.formCreateProduct.controls.cantidad?null:t.formCreateProduct.controls.cantidad.errors.min.min,"")}}function ge(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function he(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function ve(o,s){if(1&o&&(e.TgZ(0,"div",51),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("El n\xfamero debe ser mayor o igual a ",null==t.formCreateProduct||null==t.formCreateProduct.controls.precio?null:t.formCreateProduct.controls.precio.errors.min.min,"")}}function _e(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function be(o,s){if(1&o&&(e.TgZ(0,"div",51),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("El n\xfamero debe ser mayor o igual a ",null==t.formCreateProduct||null==t.formCreateProduct.controls.precio?null:t.formCreateProduct.controls.precio.errors.min.min,"")}}function Ce(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function Ze(o,s){if(1&o&&(e.TgZ(0,"div",51),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("El n\xfamero debe ser mayor o igua a ",null==t.formCreateProduct||null==t.formCreateProduct.controls.precio_base?null:t.formCreateProduct.controls.precio_base.errors.min.min,"")}}function Pe(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function xe(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function Te(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function qe(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function Ae(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function Ue(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function Ee(o,s){if(1&o&&(e.TgZ(0,"div",51),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("El n\xfamero debe ser mayor o igua a ",null==t.formCreateProduct||null==t.formCreateProduct.controls.cantidad?null:t.formCreateProduct.controls.cantidad.errors.min.min,"")}}function Ie(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function we(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function ye(o,s){if(1&o&&(e.TgZ(0,"div",51),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("El n\xfamero debe ser mayor o igual a ",null==t.formCreateProduct||null==t.formCreateProduct.controls.precio?null:t.formCreateProduct.controls.precio.errors.min.min,"")}}function Ne(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function Se(o,s){if(1&o&&(e.TgZ(0,"div",51),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("El n\xfamero debe ser mayor o igual a ",null==t.formCreateProduct||null==t.formCreateProduct.controls.precio?null:t.formCreateProduct.controls.precio.errors.min.min,"")}}function Je(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function Qe(o,s){if(1&o&&(e.TgZ(0,"div",51),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("El n\xfamero debe ser mayor o igua a ",null==t.formCreateProduct||null==t.formCreateProduct.controls.precio_base?null:t.formCreateProduct.controls.precio_base.errors.min.min,"")}}function Oe(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function Me(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}function Ye(o,s){1&o&&(e.TgZ(0,"div",51),e._uU(1,"Campo requerido"),e.qZA())}const Fe=function(){return{"min-width":"50rem"}},Re=function(){return["nombre","medida","precio","cantidad","inventario","acciones"]},De=function(){return[10,20,30]},J=function(){return{width:"50vw"}};let ke=(()=>{class o{ngOnInit(){this.buildForm(),this.getIndex(),this.visibleModalProducto=!1}constructor(t,r,i){this.productsService=t,this.FB=r,this.spinner=i,this.visibleModalProducto=!0,this.ventaVisible=!1,this.pageCount=10,this.imagen=null,this.loadingTable=!1,this.visibleModalProductoEditar=!1,this.idEditando=0,this.first=0,this.rows=8,this.data=Array(18).fill(0)}openModal(){this.onCreate()}getIndex(t="",r=this.pageCount){this.spinner.show(),this.loadingTable=!0,this.productsService.getAll(r,t).subscribe(i=>{this.loadingTable=!1,console.log("Response: ",i),this.productsData=i.data,this.countRegisters=i.total,this.spinner.hide()},i=>{console.log("Error: ",i)})}newProduct(){this.spinner.show();let t=this.formCreateProduct.value;t.medida_id=t.medida_id.id,t.inventario_id=t.inventario_id.id,t.visible_venta=t.visible_venta.id,t.limite_cantidad=t.limite_cantidad.id,t.tipo_producto=t.tipo_producto.id,t.estado=1;const r=new FormData;for(const i in t)t.hasOwnProperty(i)&&r.append(i,t[i]);if(null!=this.imagen){const i=new Blob([this.imagen],{type:"image/png"}),n=new File([i],"nombre_archivo.png",{type:"image/png"});r.append("imagen",n)}this.productsService.createProduct(r).subscribe(i=>{this.spinner.hide(),this.imagen=null,this.visibleModalProducto=!1,"success"==i.code?(p().fire({title:"Exito",text:"Producto creado exitosamente.",icon:"success"}),this.getIndex()):p().fire({title:"Error",text:"Error al crear el producto.",icon:"error"})},i=>{console.log("Error: ",i)})}buildForm(){this.formSearch=this.FB.group({search:["",[]]}),this.formCreateProduct=this.FB.group({nombre:["",[a.kI.required]],medida_id:["",[a.kI.required]],descripcion:["",[a.kI.required]],precio:["",[a.kI.required,a.kI.min(1)]],cantidad:["",[a.kI.required,a.kI.pattern("^[0-9]*$"),a.kI.min(0)]],inventario_id:["",[a.kI.required]],visible_venta:["",[a.kI.required]],precio_base:["",[a.kI.required,a.kI.min(0)]],limite_cantidad:["",[a.kI.required]],stop_minimo:["",[a.kI.required,a.kI.min(0)]],tipo_producto:["",[a.kI.required]]}),this.formEditProduct=this.FB.group({nombre:["",[a.kI.required]],medida_id:["",[a.kI.required]],descripcion:["",[a.kI.required]],precio:["",[a.kI.required,a.kI.min(1)]],cantidad:["",[a.kI.required,a.kI.pattern("^[0-9]*$"),a.kI.min(0)]],inventario_id:["",[a.kI.required]],visible_venta:["",[a.kI.required]],precio_base:["",[a.kI.required,a.kI.min(0)]],limite_cantidad:["",[a.kI.required]],stop_minimo:["",[a.kI.required,a.kI.min(0)]],tipo_producto:["",[a.kI.required]]})}search(t){let r=this.formSearch.get("search").value;this.getIndex(r)}onPage(t){this.pageCount=t.rows,this.getIndex("",this.pageCount)}onCreate(){this.fileUploadCreate.clear(),this.imagen=null,this.formCreateProduct.reset(),this.productsService.getProducto(0).subscribe(t=>{this.medida=t.medida,this.inventario=t.inventario,this.visibleVenta=t.visible_venta,this.limiteCantidad=t.sin_limite,this.tipo=t.tipo,this.visibleModalProducto=!0},t=>{console.log("Error: ",t)})}editProduct(t){this.imagen=null,this.fileUpload.clear(),this.idEditando=t,this.spinner.show(),this.productsService.getProducto(t).subscribe(r=>{this.spinner.hide(),this.medida=r.medida,this.inventario=r.inventario,this.visibleVenta=r.visible_venta,this.limiteCantidad=r.sin_limite,this.tipo=r.tipo,this.dataEditarInfoProductos=r.producto;let i=null,n=null,l=null,v=null,f=null;this.medida.forEach(c=>{c.id==this.dataEditarInfoProductos.medida_id&&(i=c)}),this.inventario.forEach(c=>{c.id==this.dataEditarInfoProductos.inventario_id&&(n=c)}),this.limiteCantidad.forEach(c=>{c.id==this.dataEditarInfoProductos.sin_limite_cantidad&&(l=c)}),this.tipo.forEach(c=>{c.id==this.dataEditarInfoProductos.tipo_producto&&(v=c)}),this.visibleVenta.forEach(c=>{c.id==this.dataEditarInfoProductos.visible_venta&&(f=c)}),console.log(),setTimeout(()=>{this.formEditProduct.get("nombre").setValue(this.dataEditarInfoProductos.nombre),this.formEditProduct.get("medida_id").setValue(i),this.formEditProduct.get("descripcion").setValue(this.dataEditarInfoProductos.descripcion),this.formEditProduct.get("precio").setValue(this.dataEditarInfoProductos.precio),this.formEditProduct.get("cantidad").setValue(this.dataEditarInfoProductos.cantidad),this.formEditProduct.get("inventario_id").setValue(n),this.formEditProduct.get("visible_venta").setValue(f),this.formEditProduct.get("limite_cantidad").setValue(l),this.formEditProduct.get("stop_minimo").setValue(this.dataEditarInfoProductos.stop_minimo),this.formEditProduct.get("tipo_producto").setValue(v),this.formEditProduct.get("precio_base").setValue(this.dataEditarInfoProductos.precio_base),this.visibleModalProductoEditar=!0,this.cargarImagen(r.imagen)},1)},r=>{console.log("Error: ",r)})}cargarImagen(t){const r=atob(t),i=new Array(r.length);for(let f=0;f<r.length;f++)i[f]=r.charCodeAt(f);const n=new Uint8Array(i),l=new Blob([n],{type:"image/jpeg"}),v=new File([l],"nombre_archivo.jpg",{type:"image/jpeg"});this.fileUpload.clear(),this.fileUpload.files=[v]}submitCreate(){this.formCreateProduct.valid?this.newProduct():this.formCreateProduct.markAllAsTouched()}onSelect(t){this.imagen=t.currentFiles[0]}blobToBase64(t){return new Promise((r,i)=>{const n=new FileReader;n.onloadend=()=>{n.result&&"string"==typeof n.result?r(n.result):i(new Error("Error al convertir Blob a Base64"))},n.onerror=()=>{i(new Error("Error al leer el Blob"))},n.readAsDataURL(t)})}confirmDelete(t){p().fire({title:"\xbfEstas Seguro que deseas eliminar el producto?",text:"Ten cuidado esta acci\xf3n no se prodr\xe1 reversar",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(r=>{r.isConfirmed&&(this.spinner.show(),this.productsService.eliminarProduct({id:t}).subscribe(i=>{this.spinner.hide(),"success"==i.code?(p().fire({title:"Exito",text:"Producto eliminado exitosamente.",icon:"success"}),this.getIndex()):p().fire({title:"Error",text:"Error al eliminar el producto.",icon:"error"})},i=>{console.log("Error: ",i)}))})}onRemove(t){this.imagen=null}updateProducto(){this.spinner.show();let t=this.formEditProduct.value;t.medida_id=t.medida_id.id,t.inventario_id=t.inventario_id.id,t.visible_venta=t.visible_venta.id,t.limite_cantidad=t.limite_cantidad.id,t.tipo_producto=t.tipo_producto.id,t.id=this.idEditando,t.estado=1;const r=new FormData;for(const i in t)t.hasOwnProperty(i)&&r.append(i,t[i]);if(null!=this.imagen){const i=new Blob([this.imagen],{type:"image/png"}),n=new File([i],"nombre_archivo.png",{type:"image/png"});r.append("imagen",n)}this.productsService.updateProducto(r).subscribe(i=>{this.spinner.hide(),this.imagen=null,this.visibleModalProductoEditar=!1,"success"==i.code?(p().fire({title:"Exito",text:"Producto creado exitosamente.",icon:"success"}),this.getIndex()):p().fire({title:"Error",text:"Error al crear el producto.",icon:"error"})},i=>{console.log("Error: ",i)})}submitUpdate(){this.formEditProduct.valid&&this.updateProducto()}onPageChange(t){this.first=t.first,this.rows=t.rows}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(y),e.Y36(a.qu),e.Y36(N))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-products"]],viewQuery:function(r,i){if(1&r&&(e.Gf(ne,5),e.Gf(ae,5)),2&r){let n;e.iGM(n=e.CRH())&&(i.fileUpload=n.first),e.iGM(n=e.CRH())&&(i.fileUploadCreate=n.first)}},decls:161,vars:74,consts:[["type","ball-scale-multiple"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"pi","pi-users","mr-2"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Crear","icon","pi pi-star",1,"p-button-outlined","mr-2",3,"click"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","showPageLinks","first","totalRecords","tableStyle","loading","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],["header","Nuevo Producto",3,"visible","modal","draggable","resizable","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6"],["type","text","pInputText","","formControlName","nombre",1,"w-full","mb-3","border-round-3xl"],["style","color: red;",4,"ngIf"],["optionLabel","nombre","formControlName","medida_id",3,"options"],["type","number","formControlName","cantidad","pInputText","",1,"w-full","mb-3","border-round-3xl"],["formControlName","limite_cantidad","optionLabel","nombre",3,"options"],["formControlName","inventario_id","optionLabel","nombre",3,"options"],["type","number","pInputText","","formControlName","precio",1,"w-full","mb-3","border-round-3xl"],["type","number","pInputText","","formControlName","stop_minimo",1,"w-full","mb-3","border-round-3xl"],["type","number","pInputText","","formControlName","precio_base",1,"w-full","mb-3","border-round-3xl"],["formControlName","visible_venta","optionLabel","nombre",3,"options"],["formControlName","tipo_producto","optionLabel","nombre",3,"options"],[1,"field","col-12","md:col-12"],["name","imsgenes[]","chooseLabel","Seleccionar","cancelLabel","Cancelar","accept","image/*",3,"showUploadButton","maxFileSize","onRemove","onClear","onSelect"],["fileUploadCreate",""],["formControlName","descripcion","pInputTextarea","","required","","rows","3","cols","20"],["pButton","","pRipple","","label","Crear Producto","icon","pi pi-fw pi-star","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],["header","Editar Producto",3,"visible","modal","draggable","resizable","visibleChange"],["fileUpload",""],["pButton","","pRipple","","label","Editar Producto","icon","pi pi-fw pi-star","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"input"],[2,"width","3rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-user-edit","severity","info",3,"click"],["icon","pi pi-trash","severity","danger",3,"click"],["colspan","8"],[2,"color","red"]],template:function(r,i){1&r&&(e._UZ(0,"ngx-spinner",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),e._uU(5,"Productos"),e.qZA(),e.TgZ(6,"div",4)(7,"div",5),e._UZ(8,"i",6),e.TgZ(9,"span"),e._uU(10),e.qZA()()()(),e.TgZ(11,"div",7)(12,"button",8),e.NdJ("click",function(){return i.openModal()}),e.qZA()()()(),e.TgZ(13,"div",9)(14,"div",10)(15,"div",11)(16,"p-table",12),e.NdJ("onPage",function(l){return i.onPage(l)}),e.YNc(17,se,6,1,"ng-template",13),e.YNc(18,de,17,0,"ng-template",14),e.YNc(19,le,19,7,"ng-template",15),e.YNc(20,ce,3,0,"ng-template",16),e.qZA()()()(),e.TgZ(21,"p-dialog",17),e.NdJ("visibleChange",function(l){return i.visibleModalProducto=l}),e.TgZ(22,"div",10)(23,"h5"),e._uU(24,"Completa el formulario"),e.qZA(),e.TgZ(25,"form",18),e.NdJ("ngSubmit",function(){return i.submitCreate()}),e.TgZ(26,"div",19)(27,"div",20)(28,"label"),e._uU(29,"Nombre"),e.qZA(),e._UZ(30,"input",21),e.YNc(31,ue,2,0,"div",22),e.qZA(),e.TgZ(32,"div",20)(33,"label"),e._uU(34,"Medida"),e.qZA(),e._UZ(35,"p-dropdown",23),e.YNc(36,pe,2,0,"div",22),e.qZA(),e.TgZ(37,"div",20)(38,"label"),e._uU(39,"Cantidad"),e.qZA(),e._UZ(40,"input",24),e.YNc(41,me,2,0,"div",22),e.YNc(42,fe,2,1,"div",22),e.qZA(),e.TgZ(43,"div",20)(44,"label"),e._uU(45,"Sin limite Cantidad"),e.qZA(),e._UZ(46,"p-dropdown",25),e.qZA(),e.TgZ(47,"div",20)(48,"label"),e._uU(49,"Inventario"),e.qZA(),e._UZ(50,"p-dropdown",26),e.YNc(51,ge,2,0,"div",22),e.qZA(),e.TgZ(52,"div",20)(53,"label"),e._uU(54,"Precio"),e.qZA(),e._UZ(55,"input",27),e.YNc(56,he,2,0,"div",22),e.YNc(57,ve,2,1,"div",22),e.qZA(),e.TgZ(58,"div",20)(59,"label"),e._uU(60,"Stop minimo"),e.qZA(),e._UZ(61,"input",28),e.YNc(62,_e,2,0,"div",22),e.YNc(63,be,2,1,"div",22),e.qZA(),e.TgZ(64,"div",20)(65,"label"),e._uU(66,"Precio base"),e.qZA(),e._UZ(67,"input",29),e.YNc(68,Ce,2,0,"div",22),e.YNc(69,Ze,2,1,"div",22),e.qZA(),e.TgZ(70,"div",20)(71,"label"),e._uU(72,"Visible Venta"),e.qZA(),e._UZ(73,"p-dropdown",30),e.YNc(74,Pe,2,0,"div",22),e.qZA(),e.TgZ(75,"div",20)(76,"label"),e._uU(77,"Tipo"),e.qZA(),e._UZ(78,"p-dropdown",31),e.YNc(79,xe,2,0,"div",22),e.qZA(),e.TgZ(80,"div",32)(81,"p-fileUpload",33,34),e.NdJ("onRemove",function(l){return i.onRemove(l)})("onClear",function(l){return i.onRemove(l)})("onSelect",function(l){return i.onSelect(l)}),e.qZA()(),e.TgZ(83,"div",32)(84,"label"),e._uU(85,"Descripcion"),e.qZA(),e._UZ(86,"textarea",35),e.YNc(87,Te,2,0,"div",22),e.qZA(),e.TgZ(88,"div",32),e._UZ(89,"button",36),e.qZA()(),e._UZ(90,"br"),e.qZA()()(),e.TgZ(91,"p-dialog",37),e.NdJ("visibleChange",function(l){return i.visibleModalProductoEditar=l}),e.TgZ(92,"div",10)(93,"h5"),e._uU(94,"Completa el formulario"),e.qZA(),e.TgZ(95,"form",18),e.NdJ("ngSubmit",function(){return i.submitUpdate()}),e.TgZ(96,"div",19)(97,"div",20)(98,"label"),e._uU(99,"Nombre"),e.qZA(),e._UZ(100,"input",21),e.YNc(101,qe,2,0,"div",22),e.qZA(),e.TgZ(102,"div",20)(103,"label"),e._uU(104,"Medida"),e.qZA(),e._UZ(105,"p-dropdown",23),e.YNc(106,Ae,2,0,"div",22),e.qZA(),e.TgZ(107,"div",20)(108,"label"),e._uU(109,"Cantidad"),e.qZA(),e._UZ(110,"input",24),e.YNc(111,Ue,2,0,"div",22),e.YNc(112,Ee,2,1,"div",22),e.qZA(),e.TgZ(113,"div",20)(114,"label"),e._uU(115,"Sin limite Cantidad"),e.qZA(),e._UZ(116,"p-dropdown",25),e.qZA(),e.TgZ(117,"div",20)(118,"label"),e._uU(119,"Inventario"),e.qZA(),e._UZ(120,"p-dropdown",26),e.YNc(121,Ie,2,0,"div",22),e.qZA(),e.TgZ(122,"div",20)(123,"label"),e._uU(124,"Precio"),e.qZA(),e._UZ(125,"input",27),e.YNc(126,we,2,0,"div",22),e.YNc(127,ye,2,1,"div",22),e.qZA(),e.TgZ(128,"div",20)(129,"label"),e._uU(130,"Stop minimo"),e.qZA(),e._UZ(131,"input",28),e.YNc(132,Ne,2,0,"div",22),e.YNc(133,Se,2,1,"div",22),e.qZA(),e.TgZ(134,"div",20)(135,"label"),e._uU(136,"Precio base"),e.qZA(),e._UZ(137,"input",29),e.YNc(138,Je,2,0,"div",22),e.YNc(139,Qe,2,1,"div",22),e.qZA(),e.TgZ(140,"div",20)(141,"label"),e._uU(142,"Visible Venta"),e.qZA(),e._UZ(143,"p-dropdown",30),e.YNc(144,Oe,2,0,"div",22),e.qZA(),e.TgZ(145,"div",20)(146,"label"),e._uU(147,"Tipo"),e.qZA(),e._UZ(148,"p-dropdown",31),e.YNc(149,Me,2,0,"div",22),e.qZA(),e.TgZ(150,"div",32)(151,"p-fileUpload",33,38),e.NdJ("onRemove",function(l){return i.onRemove(l)})("onClear",function(l){return i.onRemove(l)})("onSelect",function(l){return i.onSelect(l)}),e.qZA()(),e.TgZ(153,"div",32)(154,"label"),e._uU(155,"Descripcion"),e.qZA(),e._UZ(156,"textarea",35),e.YNc(157,Ye,2,0,"div",22),e.qZA(),e.TgZ(158,"div",32),e._UZ(159,"button",39),e.qZA()(),e._UZ(160,"br"),e.qZA()()()),2&r&&(e.xp6(10),e.hij("",i.countRegisters," Productos Creados"),e.xp6(6),e.Q6J("value",i.productsData)("showPageLinks",!0)("first",1)("totalRecords",17)("tableStyle",e.DdM(69,Fe))("loading",i.loadingTable)("rows",8)("globalFilterFields",e.DdM(70,Re))("paginator",!0)("rowsPerPageOptions",e.DdM(71,De))("showCurrentPageReport",!0)("rowHover",!0),e.xp6(5),e.Akn(e.DdM(72,J)),e.Q6J("visible",i.visibleModalProducto)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(4),e.Q6J("formGroup",i.formCreateProduct),e.xp6(6),e.Q6J("ngIf",i.formCreateProduct.get("nombre").hasError("required")),e.xp6(4),e.Q6J("options",i.medida),e.xp6(1),e.Q6J("ngIf",i.formCreateProduct.get("medida_id").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formCreateProduct.get("cantidad").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.formCreateProduct.get("cantidad").hasError("min")),e.xp6(4),e.Q6J("options",i.limiteCantidad),e.xp6(4),e.Q6J("options",i.inventario),e.xp6(1),e.Q6J("ngIf",i.formCreateProduct.get("inventario_id").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formCreateProduct.get("precio").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.formCreateProduct.get("precio").hasError("min")),e.xp6(5),e.Q6J("ngIf",i.formCreateProduct.get("stop_minimo").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.formCreateProduct.get("stop_minimo").hasError("min")),e.xp6(5),e.Q6J("ngIf",i.formCreateProduct.get("precio_base").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.formCreateProduct.get("precio_base").hasError("min")),e.xp6(4),e.Q6J("options",i.visibleVenta),e.xp6(1),e.Q6J("ngIf",i.formCreateProduct.get("visible_venta").hasError("required")),e.xp6(4),e.Q6J("options",i.tipo),e.xp6(1),e.Q6J("ngIf",i.formCreateProduct.get("tipo_producto").hasError("required")),e.xp6(2),e.Q6J("showUploadButton",!1)("maxFileSize",1e6),e.xp6(6),e.Q6J("ngIf",i.formCreateProduct.get("descripcion").hasError("required")),e.xp6(4),e.Akn(e.DdM(73,J)),e.Q6J("visible",i.visibleModalProductoEditar)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(4),e.Q6J("formGroup",i.formEditProduct),e.xp6(6),e.Q6J("ngIf",i.formEditProduct.get("nombre").hasError("required")),e.xp6(4),e.Q6J("options",i.medida),e.xp6(1),e.Q6J("ngIf",i.formEditProduct.get("medida_id").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formEditProduct.get("cantidad").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.formEditProduct.get("cantidad").hasError("min")),e.xp6(4),e.Q6J("options",i.limiteCantidad),e.xp6(4),e.Q6J("options",i.inventario),e.xp6(1),e.Q6J("ngIf",i.formEditProduct.get("inventario_id").hasError("required")),e.xp6(5),e.Q6J("ngIf",i.formEditProduct.get("precio").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.formEditProduct.get("precio").hasError("min")),e.xp6(5),e.Q6J("ngIf",i.formEditProduct.get("stop_minimo").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.formEditProduct.get("stop_minimo").hasError("min")),e.xp6(5),e.Q6J("ngIf",i.formEditProduct.get("precio_base").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.formEditProduct.get("precio_base").hasError("min")),e.xp6(4),e.Q6J("options",i.visibleVenta),e.xp6(1),e.Q6J("ngIf",i.formEditProduct.get("visible_venta").hasError("required")),e.xp6(4),e.Q6J("options",i.tipo),e.xp6(1),e.Q6J("ngIf",i.formEditProduct.get("tipo_producto").hasError("required")),e.xp6(2),e.Q6J("showUploadButton",!1)("maxFileSize",1e6),e.xp6(6),e.Q6J("ngIf",i.formEditProduct.get("descripcion").hasError("required")))},dependencies:[g.O5,h.iA,re.jx,h.UA,h.Mo,P.p,_.Hq,_.zx,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,x.H,T.o,q.g,A.Lt,U.V,a.sg,a.u,ie],styles:["svg[_ngcontent-%COMP%]{width:45%}"]})}return o})(),ze=(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275mod=e.oAB({type:o});static#i=this.\u0275inj=e.cJS({imports:[I.Bz.forChild([{path:"",component:ke}]),I.Bz]})}return o})();var Be=d(1712);let Ve=(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275mod=e.oAB({type:o});static#i=this.\u0275inj=e.cJS({providers:[{provide:E.TP,useClass:R.n,multi:!0},y],imports:[g.ez,ze,h.U$,P.O,a.u5,_.hJ,x.T,Q.EV,O.V,M.Xt,T.j,q.A,A.kW,Y.cc,F.L$,U.S,D.ii.forRoot(),a.UX,oe,Be.U]})}return o})()}}]);