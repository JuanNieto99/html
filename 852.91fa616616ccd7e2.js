"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[852],{9852:(q,F,l)=>{l.r(F),l.d(F,{ProductsModule:()=>Ne});var f=l(177),n=l(4341),v=l(3386),R=l(5493),P=l(1141),T=l(563),$=l(9998),y=l(1830),N=l(4714),D=l(2242),G=l(1305),c=l(9883),I=l(494),m=l(981),_=l(1570),g=l(1626),Y=l(635),x=l(4058),k=l(3091),J=l(8032),p=l.n(J),C=l(5989),t=l(540),z=l(4412),O=l(306);let V=(()=>{class i{constructor(e){this.httpClient=e,this.dataSubject=new z.t([]),this.endpointListar="/productoListar",this.endpointProductGet="/productoEditar/",this.endpointProductCreate="/productoCrear",this.endpointProductUpdate="/productoActualizar",this.endpointEliminar="/productoEliminar",this.endpointProductImpuesto="/productoImpuestoGet",this.endpointProductImpuestoCrear="/productoImpuestoCrear",this.endpointGetProductImpuesto="/getProductoImpuesto",this.endpointProductoDetalleMostrar="/productoDetalleMostrar",this.endpointProductoDetalleCrear="/productoDetalleCrear",this.endpointEliminarDetalle="/productoDetalleEliminar",this.data=this.dataSubject.asObservable(),this.baseUrl=O.T.url}getAll(e,r="",o=1){return this.httpClient.post(`${this.baseUrl+this.endpointListar}?per_page=${e}&page=${o}&search=${r}`,{})}getProducto(e){return this.httpClient.get(`${this.baseUrl+this.endpointProductGet+e}`)}refreshUsersData(){this.getAll(30).subscribe(e=>{this.dataSubject.next(e.data)},e=>{console.log("Error: ",e)})}createProduct(e){return this.httpClient.post(`${this.baseUrl+this.endpointProductCreate}`,e)}eliminarProduct(e){return this.httpClient.post(`${this.baseUrl+this.endpointEliminar}`,e)}updateProducto(e){return this.httpClient.post(`${this.baseUrl+this.endpointProductUpdate}`,e)}getImpuesto(e,r=10,o=1,a=""){return this.httpClient.get(`${this.baseUrl+this.endpointProductImpuesto}/${e}?per_page=${r}&page=${o}${a?`&search=${a}`:""}`)}createImpuesto(e){return this.httpClient.post(`${this.baseUrl+this.endpointProductImpuestoCrear}`,e)}getImpuestoCrear(){return this.httpClient.get(`${this.baseUrl+this.endpointGetProductImpuesto}`)}getDetallesProducto(e,r=10,o=1,a=""){return this.httpClient.get(`${this.baseUrl+this.endpointProductoDetalleMostrar}/${e}?per_page=${r}&page=${o}${a?`&search=${a}`:""}`)}createDetalle(e){return this.httpClient.post(`${this.baseUrl+this.endpointProductoDetalleCrear}`,e)}deleteDetalle(e){return this.httpClient.post(`${this.baseUrl+this.endpointEliminarDetalle}`,e)}static{this.\u0275fac=function(r){return new(r||i)(t.KVO(g.Qq))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var j=l(6554),A=l(5779),B=l(935),X=l(8542);const Q=["fileUpload"],H=["fileUploadCreate"];function K(i,s){if(1&i){const e=t.RV6();t.j41(0,"button",40),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.openModal())}),t.k0s()}}function Z(i,s){if(1&i){const e=t.RV6();t.j41(0,"div",41),t.nrm(1,"span"),t.j41(2,"span",42)(3,"form",43)(4,"div",44)(5,"input",45),t.bIt("keyup.enter",function(o){t.eBV(e);const a=t.XpG();return t.Njj(a.buscarPorTecla(o))})("input",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.searchInput())}),t.k0s(),t.j41(6,"button",46),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.search())}),t.k0s()()()()()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("formGroup",e.formSearch)}}function W(i,s){1&i&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Nombre"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Medida"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Precio"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Tipo"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Inventario"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Visible venta"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Visible recetas"),t.k0s(),t.j41(15,"th"),t.EFF(16,"Cantidad"),t.k0s(),t.j41(17,"th"),t.EFF(18,"Acciones"),t.k0s()())}function tt(i,s){if(1&i){const e=t.RV6();t.j41(0,"p-button",50),t.bIt("click",function(){t.eBV(e);const o=t.XpG().$implicit,a=t.XpG();return t.Njj(a.editProduct(o.id))}),t.k0s()}}function et(i,s){if(1&i&&t.nrm(0,"p-button",52),2&i){const e=t.XpG(2).$implicit;t.Y8G("routerLink",e.id+"/impuesto")}}function it(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,et,1,1,"p-button",51),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(1),t.Y8G("ngIf","1"==e.tipo_producto)}}function ot(i,s){if(1&i){const e=t.RV6();t.j41(0,"p-button",53),t.bIt("click",function(){t.eBV(e);const o=t.XpG().$implicit,a=t.XpG();return t.Njj(a.confirmDelete(o.id))}),t.k0s()}}function rt(i,s){if(1&i&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.nI1(3,"titlecase"),t.k0s(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.j41(6,"td"),t.EFF(7),t.nI1(8,"number"),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.k0s(),t.j41(15,"td"),t.EFF(16),t.k0s(),t.j41(17,"td"),t.EFF(18),t.k0s(),t.j41(19,"td",47),t.DNE(20,tt,1,0,"p-button",48),t.DNE(21,it,2,1,"div",26),t.DNE(22,ot,1,0,"p-button",49),t.k0s()()),2&i){const e=s.$implicit,r=t.XpG();t.R7$(2),t.JRh(t.bMT(3,11,e.nombre)),t.R7$(3),t.JRh(e.medida.nombre),t.R7$(2),t.JRh(t.bMT(8,13,e.precio)),t.R7$(3),t.JRh("1"==e.tipo_producto?"Producto":"Servicio"),t.R7$(2),t.JRh(e.inventario.nombre),t.R7$(2),t.JRh(e.visible_venta?"Si":"No"),t.R7$(2),t.JRh(e.visible_receta?"Si":"No"),t.R7$(2),t.JRh(e.cantidad),t.R7$(2),t.Y8G("ngIf",r.permisoActualizar),t.R7$(1),t.Y8G("ngIf",r.permisoDetalle||r.permisoImpuesto),t.R7$(1),t.Y8G("ngIf",r.permisoEliminar)}}function at(i,s){1&i&&(t.j41(0,"tr")(1,"td",54),t.EFF(2,"Cargando informacion porfavor espere ..."),t.k0s()())}function nt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function st(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"M\xe1ximo 50 caracteres"),t.k0s())}function dt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,nt,2,0,"div",55),t.DNE(2,st,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("nombre").hasError("required")),t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("nombre").hasError("maxlength"))}}function lt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function ct(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,lt,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("tipo_producto").hasError("required"))}}function ut(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function pt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,ut,2,0,"div",55),t.k0s()),2&i){const e=t.XpG(2);t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("medida_id").hasError("required"))}}function mt(i,s){if(1&i&&(t.j41(0,"div",24)(1,"label"),t.EFF(2,"Medida"),t.k0s(),t.nrm(3,"p-dropdown",57),t.DNE(4,pt,2,1,"div",26),t.k0s()),2&i){const e=t.XpG();t.R7$(3),t.Y8G("options",e.medida),t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("medida_id").invalid&&(e.formCreateProduct.get("medida_id").dirty||e.formCreateProduct.get("medida_id").touched))}}function _t(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function ft(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Debe ser mayor o igual a 0"),t.k0s())}function gt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,_t,2,0,"div",55),t.DNE(2,ft,2,0,"div",55),t.k0s()),2&i){const e=t.XpG(2);t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("cantidad").hasError("required")),t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("cantidad").hasError("min"))}}function ht(i,s){if(1&i&&(t.j41(0,"div",24)(1,"label"),t.EFF(2,"Cantidad"),t.k0s(),t.nrm(3,"input",58),t.DNE(4,gt,3,2,"div",26),t.k0s()),2&i){const e=t.XpG();t.R7$(4),t.Y8G("ngIf",e.formCreateProduct.get("cantidad").invalid&&(e.formCreateProduct.get("cantidad").dirty||e.formCreateProduct.get("cantidad").touched))}}function bt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function vt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,bt,2,0,"div",55),t.k0s()),2&i){const e=t.XpG(2);t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("limite_cantidad").hasError("required"))}}function Pt(i,s){if(1&i&&(t.j41(0,"div",24)(1,"label"),t.nrm(2,"p-tag",59),t.EFF(3," Cantidad limitada "),t.k0s(),t.nrm(4,"p-dropdown",60),t.DNE(5,vt,2,1,"div",26),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("pTooltip",e.cantidadLimitadaPlaceholder),t.R7$(2),t.Y8G("options",e.limiteCantidad),t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("limite_cantidad").invalid&&(e.formCreateProduct.get("limite_cantidad").dirty||e.formCreateProduct.get("limite_cantidad").touched))}}function Ct(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function Et(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,Ct,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("inventario_id").hasError("required"))}}function It(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function kt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Debe ser mayor o igual a 1"),t.k0s())}function Tt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,It,2,0,"div",55),t.DNE(2,kt,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("precio").hasError("required")),t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("precio").hasError("min"))}}function Dt(i,s){1&i&&(t.j41(0,"div",24)(1,"label"),t.EFF(2,"Stock m\xednimo"),t.k0s(),t.nrm(3,"input",61),t.k0s())}function jt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function Ft(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Debe ser mayor o igual a 0"),t.k0s())}function Rt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,jt,2,0,"div",55),t.DNE(2,Ft,2,0,"div",55),t.k0s()),2&i){const e=t.XpG(2);t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("precio_base").hasError("required")),t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("precio_base").hasError("min"))}}function Gt(i,s){if(1&i&&(t.j41(0,"div",24)(1,"label"),t.EFF(2,"Precio base"),t.k0s(),t.nrm(3,"input",62),t.DNE(4,Rt,3,2,"div",26),t.k0s()),2&i){const e=t.XpG();t.R7$(4),t.Y8G("ngIf",e.formCreateProduct.get("precio_base").invalid&&(e.formCreateProduct.get("precio_base").dirty||e.formCreateProduct.get("precio_base").touched))}}function xt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function $t(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,xt,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("visible_venta").hasError("required"))}}function yt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function Nt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,yt,2,0,"div",55),t.k0s()),2&i){const e=t.XpG(2);t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("visible_receta").hasError("required"))}}function Yt(i,s){if(1&i){const e=t.RV6();t.j41(0,"div",24)(1,"label"),t.EFF(2,"Visible receta"),t.k0s(),t.j41(3,"p-dropdown",63),t.bIt("onChange",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.onVisibleRecetaChange())}),t.k0s(),t.DNE(4,Nt,2,1,"div",26),t.k0s()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("options",e.visibleReceta),t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("visible_receta").invalid&&(e.formCreateProduct.get("visible_receta").dirty||e.formCreateProduct.get("visible_receta").touched))}}function Vt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"M\xe1ximo 500 caracteres"),t.k0s())}function wt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,Vt,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formCreateProduct.get("descripcion").hasError("maxlength"))}}function St(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function At(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"M\xe1ximo 50 caracteres"),t.k0s())}function Bt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,St,2,0,"div",55),t.DNE(2,At,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("nombre").hasError("required")),t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("nombre").hasError("maxlength"))}}function Xt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function Mt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,Xt,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("tipo_producto").hasError("required"))}}function Ut(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function Lt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,Ut,2,0,"div",55),t.k0s()),2&i){const e=t.XpG(2);t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("medida_id").hasError("required"))}}function qt(i,s){if(1&i&&(t.j41(0,"div",24)(1,"label"),t.EFF(2,"Medida"),t.k0s(),t.nrm(3,"p-dropdown",57),t.DNE(4,Lt,2,1,"div",26),t.k0s()),2&i){const e=t.XpG();t.R7$(3),t.Y8G("options",e.medida),t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("medida_id").invalid&&(e.formEditProduct.get("medida_id").dirty||e.formEditProduct.get("medida_id").touched))}}function Jt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function zt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,Jt,2,0,"div",55),t.k0s()),2&i){const e=t.XpG(2);t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("limite_cantidad").hasError("required"))}}function Ot(i,s){if(1&i&&(t.j41(0,"div",24)(1,"label"),t.nrm(2,"p-tag",59),t.EFF(3," Cantidad limitada "),t.k0s(),t.nrm(4,"p-dropdown",60),t.DNE(5,zt,2,1,"div",26),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("pTooltip",e.cantidadLimitadaPlaceholder),t.R7$(2),t.Y8G("options",e.limiteCantidad),t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("limite_cantidad").invalid&&(e.formEditProduct.get("limite_cantidad").dirty||e.formEditProduct.get("limite_cantidad").touched))}}function Qt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function Ht(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,Qt,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("inventario_id").hasError("required"))}}function Kt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function Zt(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Debe ser mayor o igual a 1"),t.k0s())}function Wt(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,Kt,2,0,"div",55),t.DNE(2,Zt,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("precio").hasError("required")),t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("precio").hasError("min"))}}function te(i,s){1&i&&(t.j41(0,"div",24)(1,"label"),t.EFF(2,"Stock m\xednimo"),t.k0s(),t.nrm(3,"input",61),t.k0s())}function ee(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function ie(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Debe ser mayor o igual a 0"),t.k0s())}function oe(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,ee,2,0,"div",55),t.DNE(2,ie,2,0,"div",55),t.k0s()),2&i){const e=t.XpG(2);t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("precio_base").hasError("required")),t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("precio_base").hasError("min"))}}function re(i,s){if(1&i&&(t.j41(0,"div",24)(1,"label"),t.EFF(2,"Precio base"),t.k0s(),t.nrm(3,"input",62),t.DNE(4,oe,3,2,"div",26),t.k0s()),2&i){const e=t.XpG();t.R7$(4),t.Y8G("ngIf",e.formEditProduct.get("precio_base").invalid&&(e.formEditProduct.get("precio_base").dirty||e.formEditProduct.get("precio_base").touched))}}function ae(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function ne(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,ae,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("visible_venta").hasError("required"))}}function se(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"Campo requerido"),t.k0s())}function de(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,se,2,0,"div",55),t.k0s()),2&i){const e=t.XpG(2);t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("visible_receta").hasError("required"))}}function le(i,s){if(1&i){const e=t.RV6();t.j41(0,"div",24)(1,"label"),t.EFF(2,"Visible receta"),t.k0s(),t.j41(3,"p-dropdown",63),t.bIt("onChange",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.onVisibleRecetaChangeEdit())}),t.k0s(),t.DNE(4,de,2,1,"div",26),t.k0s()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("options",e.visibleReceta),t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("visible_receta").invalid&&(e.formEditProduct.get("visible_receta").dirty||e.formEditProduct.get("visible_receta").touched))}}function ce(i,s){1&i&&(t.j41(0,"div",56),t.EFF(1,"M\xe1ximo 500 caracteres"),t.k0s())}function ue(i,s){if(1&i&&(t.j41(0,"div"),t.DNE(1,ce,2,0,"div",55),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.formEditProduct.get("descripcion").hasError("maxlength"))}}const pe=function(){return{"min-width":"50rem"}},me=function(){return["nombre","medida","precio","cantidad","inventario","acciones"]},M=function(){return{width:"60vw"}};let _e=(()=>{class i{ngOnInit(){this.buildForm(),this.getIndex(),this.visibleModalProducto=!1}constructor(e,r,o){this.productsService=e,this.FB=r,this.spinner=o,this.permisoCrear=C.u.hasPermission(["gestionInventario.productos.crear"]),this.permisoActualizar=C.u.hasPermission(["gestionInventario.productos.actualizar"]),this.permisoEliminar=C.u.hasPermission(["gestionInventario.productos.eliminar"]),this.permisoDetalle=C.u.hasPermission(["gestionInventario.productos.detalle"]),this.permisoImpuesto=C.u.hasPermission(["gestionInventario.productos.impuestoProducto"]),this.visibleModalProducto=!0,this.ventaVisible=!1,this.pageCount=10,this.imagen=null,this.loadingTable=!1,this.visibleModalProductoEditar=!1,this.idEditando=0,this.first=0,this.rows=8,this.data=Array(18).fill(0),this.pageActual=1,this.ultimaPage=1,this.disablePageLeft=!1,this.disablePageRight=!1,this.registrosContar=0,this.visibleServicio=!0,this.visibleServicioEditar=!0,this.cantidadLimitadaPlaceholder='Si seleccionas "S\xed", al producto se le descontar\xe1n cantidades cada vez que se haga una transacci\xf3n. Si seleccionas "No", no se descontar\xe1'}openModal(){this.onCreate()}getIndex(e="",r=this.pageCount,o=1){this.spinner.show(),this.loadingTable=!0,this.productsService.getAll(r,e,o).subscribe(a=>{this.loadingTable=!1,this.productsData=a.data,this.ultimaPage=a.last_page,this.registrosContar=a.total,this.ultimaPage=a.last_page,a.total>r&&(this.disablePageRight=!0),this.validatePage(),this.spinner.hide()},a=>{console.log("Error: ",a)})}newProduct(){this.spinner.show();let e=this.formCreateProduct.value;e.inventario_id=e.inventario_id.id,e.visible_venta=e.visible_venta.id,e.tipo_producto=e.tipo_producto.id,e.visible_receta=e.visible_receta?e?.visible_receta.id:0,e.estado=1,2!=e.tipo_producto?(e.medida_id=e.medida_id.id,e.limite_cantidad=e.limite_cantidad.id):(e.cantidad=0,e.limite_cantidad=0,e.medida_id=0,e.precio_base=0,e.stop_minimo=0);const r=new FormData;for(const o in e)e.hasOwnProperty(o)&&r.append(o,e[o]);if(null!=this.imagen){const o=new Blob([this.imagen],{type:"image/png"}),a=new File([o],"nombre_archivo.png",{type:"image/png"});r.append("imagen",a)}this.productsService.createProduct(r).subscribe(o=>{this.spinner.hide(),this.imagen=null,this.visibleModalProducto=!1,"success"==o.code?(this.formCreateProduct.reset(),p().fire({title:"Exito",text:"Producto creado exitosamente.",icon:"success"}),this.getIndex()):p().fire({title:"Error",text:"Error al crear el producto.",icon:"error"})},o=>{console.log("Error: ",o)})}buildForm(){this.formSearch=this.FB.group({search:["",[]]}),this.formCreateProduct=this.FB.group({nombre:["",[n.k0.required,n.k0.maxLength(50)]],medida_id:["",n.k0.required],descripcion:["",[n.k0.maxLength(500)]],precio:["",[n.k0.required,n.k0.min(1)]],cantidad:["",[n.k0.required,n.k0.pattern("^[0-9]*$"),n.k0.min(0)]],inventario_id:["",n.k0.required],visible_venta:["",n.k0.required],visible_receta:["",n.k0.required],precio_base:["",[n.k0.required,n.k0.min(0)]],limite_cantidad:["",n.k0.required],stop_minimo:["",[]],tipo_producto:["",n.k0.required]}),this.formEditProduct=this.FB.group({nombre:["",[n.k0.required,n.k0.maxLength(50)]],medida_id:["",n.k0.required],descripcion:["",[n.k0.maxLength(500)]],precio:["",[n.k0.required,n.k0.min(1)]],cantidad:["",[n.k0.required,n.k0.pattern("^[0-9]*$"),n.k0.min(0)]],inventario_id:["",n.k0.required],visible_venta:["",n.k0.required],visible_receta:["",n.k0.required],precio_base:["",[n.k0.required,n.k0.min(0)]],limite_cantidad:["",n.k0.required],stop_minimo:["",[]],tipo_producto:["",n.k0.required]})}searchInput(){let e=this.formSearch.get("search").value;this.pageActual=1,""==e&&this.getIndex(e)}search(){let e=this.formSearch.get("search").value;this.getIndex(e)}onPage(e){this.pageCount=e.rows,this.getIndex("",this.pageCount)}onCreate(){this.fileUploadCreate.clear(),this.imagen=null,this.formCreateProduct.reset(),this.productsService.getProducto(0).subscribe(e=>{this.medida=e.medida,this.inventario=e.inventario,this.visibleVenta=e.visible_venta,this.visibleReceta=e.visible_receta,this.limiteCantidad=e.sin_limite,this.tipo=e.tipo,this.visibleModalProducto=!0,this.registrosContar=e.total,this.onChangeTipoProductoCrear()},e=>{console.log("Error: ",e)})}editProduct(e){this.imagen=null,this.fileUpload.clear(),this.idEditando=e,this.spinner.show(),this.productsService.getProducto(e).subscribe(r=>{this.spinner.hide(),this.medida=r.medida,this.inventario=r.inventario,this.visibleVenta=r.visible_venta,this.visibleReceta=r.visible_receta,this.limiteCantidad=r.sin_limite,this.tipo=r.tipo,this.dataEditarInfoProductos=r.producto;let o=null,a=null,d=null,b=null,h=null,E=null;this.medida.forEach(u=>{u.id==this.dataEditarInfoProductos.medida_id&&(o=u)}),this.inventario.forEach(u=>{u.id==this.dataEditarInfoProductos.inventario_id&&(a=u)}),this.limiteCantidad.forEach(u=>{u.id==this.dataEditarInfoProductos.sin_limite_cantidad&&(d=u)}),this.tipo.forEach(u=>{u.id==this.dataEditarInfoProductos.tipo_producto&&(b=u)}),this.visibleVenta.forEach(u=>{u.id==this.dataEditarInfoProductos.visible_venta&&(h=u)}),this.visibleReceta.forEach(u=>{u.id==this.dataEditarInfoProductos.visible_receta&&(E=u)}),setTimeout(()=>{this.onChangeTipoProductoEditarIncio(b),this.formEditProduct.get("nombre").setValue(this.dataEditarInfoProductos.nombre),this.formEditProduct.get("medida_id").setValue(o),this.formEditProduct.get("descripcion").setValue(this.dataEditarInfoProductos.descripcion),this.formEditProduct.get("precio").setValue(this.dataEditarInfoProductos.precio),this.formEditProduct.get("cantidad").setValue(this.dataEditarInfoProductos.cantidad),this.formEditProduct.get("inventario_id").setValue(a),this.formEditProduct.get("visible_venta").setValue(h),this.formEditProduct.get("limite_cantidad").setValue(d),this.formEditProduct.get("stop_minimo").setValue(this.dataEditarInfoProductos.stop_minimo),this.formEditProduct.get("tipo_producto").setValue(b),this.formEditProduct.get("precio_base").setValue(this.dataEditarInfoProductos.precio_base),this.formEditProduct.get("visible_receta").setValue(E),this.visibleModalProductoEditar=!0,this.cargarImagen(r.imagen)},1)},r=>{console.log("Error: ",r)})}cargarImagen(e){const r=atob(e),o=new Array(r.length);for(let h=0;h<r.length;h++)o[h]=r.charCodeAt(h);const a=new Uint8Array(o),d=new Blob([a],{type:"image/jpeg"}),b=new File([d],"nombre_archivo.jpg",{type:"image/jpeg"});this.fileUpload.clear(),this.fileUpload.files=[b]}submitCreate(){this.formCreateProduct.valid?this.newProduct():this.formCreateProduct.markAllAsTouched()}onSelect(e){this.imagen=e.currentFiles[0]}blobToBase64(e){return new Promise((r,o)=>{const a=new FileReader;a.onloadend=()=>{a.result&&"string"==typeof a.result?r(a.result):o(new Error("Error al convertir Blob a Base64"))},a.onerror=()=>{o(new Error("Error al leer el Blob"))},a.readAsDataURL(e)})}confirmDelete(e){p().fire({title:"\xbfEstas Seguro que deseas eliminar el producto?",text:"Ten cuidado esta acci\xf3n no se prodr\xe1 reversar",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(r=>{r.isConfirmed&&(this.spinner.show(),this.productsService.eliminarProduct({id:e}).subscribe(o=>{this.spinner.hide(),"success"==o.code?(p().fire({title:"Exito",text:"Producto eliminado exitosamente.",icon:"success"}),this.getIndex()):p().fire({title:"Error",text:"Error al eliminar el producto.",icon:"error"})},o=>{console.log("Error: ",o)}))})}onRemove(e){this.imagen=null}updateProducto(e=!1){this.spinner.show();let r=this.formEditProduct.value;"object"==typeof r.inventario_id&&(r.inventario_id=r.inventario_id.id),"object"==typeof r.visible_venta&&(r.visible_venta=r.visible_venta.id),"object"==typeof r.tipo_producto&&(r.tipo_producto=r.tipo_producto.id),"object"==typeof r.visible_receta&&(r.visible_receta=r?.visible_receta.id),r.id=this.idEditando,r.estado=1,r.confirm=e,2!=r.tipo_producto?("object"==typeof r.medida_id&&(r.medida_id=r.medida_id.id),"object"==typeof r.limite_cantidad&&(r.limite_cantidad=r.limite_cantidad.id)):(r.cantidad=0,r.limite_cantidad=0,r.medida_id=0,r.precio_base=0,r.stop_minimo=0);const o=new FormData;for(const a in r)r.hasOwnProperty(a)&&o.append(a,r[a]);if(null!=this.imagen){const a=new Blob([this.imagen],{type:"image/png"}),d=new File([a],"nombre_archivo.png",{type:"image/png"});o.append("imagen",d)}this.productsService.updateProducto(o).subscribe(a=>{this.spinner.hide(),this.imagen=null,this.visibleModalProductoEditar=!1,"success"==a.code?(p().fire({title:"Exito",text:"Producto editado exitosamente.",icon:"success"}),this.getIndex()):p().fire({title:"Error",text:"Error al editar el producto.",icon:"error"})},a=>{if(this.spinner.hide(),this.visibleModalProductoEditar=!1,"error"==a.error.code){const d=a.error.registros,b=this.productsData.findIndex(u=>u.id==d[0].producto_id),h=this.productsData[b];let E=d.map(u=>u.nombre_receta).join(", ");p().fire({title:"Error al actualizar",html:`\n                        <p style="margin: 0;">Para cambiar la visibilidad de \xe9ste producto </p>\n                        <p>debes eliminarlo de las siguientes recetas:</p>\n                        <p style="color: orangered"> ${E} </p>\n                        <p>\xbfQuieres eliminar el producto <span style="color: orangered;">${h.nombre}</span> de estas recetas?</p>\n                        `,icon:"warning",showConfirmButton:!0,confirmButtonText:"Eliminar",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(u=>{u.isConfirmed?this.updateProducto(!0):this.imagen=null})}})}submitUpdate(){this.formEditProduct.valid&&this.updateProducto()}onPageChange(e){this.first=e.first,this.rows=e.rows}leftTable(){this.pageActual=this.pageActual-1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}rightTable(){this.pageActual=this.pageActual+1,this.getIndex("",this.pageCount,this.pageActual),this.validatePage()}validatePage(){1==this.pageActual&&(this.disablePageLeft=!1),this.pageActual>1&&(this.disablePageLeft=!0),this.ultimaPage==this.pageActual&&(this.disablePageRight=!1),this.ultimaPage>this.pageActual&&(this.disablePageRight=!0)}onChangeTipoProductoCrear(){let e=this.formCreateProduct.get("tipo_producto").value;1==e?.id&&(this.visibleServicio=!0,this.formCreateProduct.get("medida_id").enable(),this.formCreateProduct.get("cantidad").enable(),this.formCreateProduct.get("limite_cantidad").enable(),this.formCreateProduct.get("stop_minimo").enable(),this.formCreateProduct.get("precio_base").enable(),this.formCreateProduct.get("visible_receta").enable(),this.formCreateProduct.get("cantidad").setValue(null),this.formCreateProduct.get("medida_id").setValue(null),this.formCreateProduct.get("limite_cantidad").setValue(null),this.formCreateProduct.get("stop_minimo").setValue(null),this.formCreateProduct.get("precio_base").setValue(null),this.formCreateProduct.get("visible_receta").setValue(null)),2==e?.id&&(this.visibleServicio=!1,this.formCreateProduct.get("medida_id").disable(),this.formCreateProduct.get("cantidad").disable(),this.formCreateProduct.get("limite_cantidad").disable(),this.formCreateProduct.get("stop_minimo").disable(),this.formCreateProduct.get("precio_base").disable(),this.formCreateProduct.get("visible_receta").disable(),this.formCreateProduct.get("cantidad").setValue(0),this.formCreateProduct.get("medida_id").setValue(0),this.formCreateProduct.get("limite_cantidad").setValue(0),this.formCreateProduct.get("stop_minimo").setValue(0),this.formCreateProduct.get("precio_base").setValue(0),this.formCreateProduct.get("visible_receta").setValue(0)),setTimeout(()=>{if(1==this.formCreateProduct.get("visible_venta").value.id){let o=null;this.visibleVenta.forEach(a=>{0==a.id&&(o=a)}),this.formCreateProduct.get("visible_receta").setValue(o)}},100)}onChangeTipoProductoEditar(){let e=this.formEditProduct.get("tipo_producto").value;1==e?.id&&(this.visibleServicioEditar=!0,this.formEditProduct.get("medida_id").enable(),this.formEditProduct.get("cantidad").enable(),this.formEditProduct.get("limite_cantidad").enable(),this.formEditProduct.get("stop_minimo").enable(),this.formEditProduct.get("precio_base").enable(),this.formEditProduct.get("cantidad").setValue(this.editarData.cantidad),this.formEditProduct.get("medida_id").setValue(this.editarData.medida_id),this.formEditProduct.get("limite_cantidad").setValue(this.editarData.limite_cantidad),this.formEditProduct.get("stop_minimo").setValue(this.editarData.stop_minimo),this.formEditProduct.get("precio_base").setValue(this.editarData.precio_base)),2==e?.id&&(this.editarData=this.formEditProduct.value,this.visibleServicioEditar=!1,this.formEditProduct.get("cantidad").disable(),this.formEditProduct.get("limite_cantidad").disable(),this.formEditProduct.get("stop_minimo").disable(),this.formEditProduct.get("precio_base").disable(),this.formEditProduct.get("cantidad").setValue(0),this.formEditProduct.get("medida_id").setValue(0),this.formEditProduct.get("limite_cantidad").setValue(0),this.formEditProduct.get("stop_minimo").setValue(0),this.formEditProduct.get("precio_base").setValue(0))}onChangeTipoProductoEditarIncio(e){1==e.id&&(this.visibleServicioEditar=!0,this.formEditProduct.get("medida_id").enable(),this.formEditProduct.get("cantidad").enable(),this.formEditProduct.get("limite_cantidad").enable(),this.formEditProduct.get("stop_minimo").enable(),this.formEditProduct.get("precio_base").enable()),2==e.id&&(this.editarData=this.formEditProduct.value,this.visibleServicioEditar=!1,this.formEditProduct.get("cantidad").disable(),this.formEditProduct.get("limite_cantidad").disable(),this.formEditProduct.get("stop_minimo").disable(),this.formEditProduct.get("precio_base").disable(),this.formEditProduct.get("cantidad").setValue(0),this.formEditProduct.get("medida_id").setValue(0),this.formEditProduct.get("limite_cantidad").setValue(0),this.formEditProduct.get("stop_minimo").setValue(0),this.formEditProduct.get("precio_base").setValue(0))}onVisibleVentaChange(){if(1==this.formCreateProduct.get("visible_venta").value.id){let r=null;this.visibleVenta.forEach(o=>{0==o.id&&(r=o)}),this.formCreateProduct.get("visible_receta").setValue(r)}}onVisibleRecetaChange(){if(1==this.formCreateProduct.get("visible_receta").value.id){let r=null;this.visibleVenta.forEach(o=>{0==o.id&&(r=o)}),this.formCreateProduct.get("visible_venta").setValue(r)}}onVisibleVentaChangeEdit(){if(1==this.formEditProduct.get("visible_venta").value.id){let r=null;this.visibleVenta.forEach(o=>{0==o.id&&(r=o)}),this.formEditProduct.get("visible_receta").setValue(r)}}onVisibleRecetaChangeEdit(){if(1==this.formEditProduct.get("visible_receta").value.id){let r=null;this.visibleVenta.forEach(o=>{0==o.id&&(r=o)}),this.formEditProduct.get("visible_venta").setValue(r)}}buscarPorTecla(e){"Enter"==e.code&&this.search()}static{this.\u0275fac=function(r){return new(r||i)(t.rXU(V),t.rXU(n.ok),t.rXU(j.ex))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-products"]],viewQuery:function(r,o){if(1&r&&(t.GBs(Q,5),t.GBs(H,5)),2&r){let a;t.mGM(a=t.lsd())&&(o.fileUpload=a.first),t.mGM(a=t.lsd())&&(o.fileUploadCreate=a.first)}},decls:115,vars:63,consts:[["type","ball-scale-multiple","size","large","bdColor","rgba(192,192,192,0.8)","template","<img src='assets/loading/cargando.gif' />"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Crear","class","p-button-outlined mr-2","icon","",3,"click",4,"ngIf"],[1,"grid","mt-3"],[1,"col-12"],[1,"card","px-3","py-3"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","usuario",3,"value","tableStyle","loading","rows","globalFilterFields","rowHover","onPage"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],["header","Nuevo Producto",3,"visible","modal","draggable","resizable","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6"],["type","text","pInputText","","formControlName","nombre",1,"w-full","mb-3","border-round-3xl"],[4,"ngIf"],["formControlName","tipo_producto","optionLabel","nombre",3,"options","onChange"],["class","field col-12 md:col-6",4,"ngIf"],["formControlName","inventario_id","optionLabel","nombre",3,"options"],["type","number","min","1","pInputText","","formControlName","precio",1,"w-full","mb-3","border-round-3xl"],["formControlName","visible_venta","optionLabel","nombre",3,"options","onChange"],[1,"field","col-12","md:col-12"],["name","imsgenes[]","chooseLabel","Seleccionar","cancelLabel","Cancelar","accept","image/*",3,"showUploadButton","maxFileSize","onRemove","onClear","onSelect"],["fileUploadCreate",""],["formControlName","descripcion","pInputTextarea","","rows","3","cols","20"],["pButton","","pRipple","","label","Crear Producto","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"disabled"],["header","Editar Producto",3,"visible","modal","draggable","resizable","visibleChange"],["fileUpload",""],["pButton","","pRipple","","label","Editar Producto","icon","pi pi-fw pi-star","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"disabled"],["pButton","","pRipple","","label","Crear","icon","",1,"p-button-outlined","mr-2",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[3,"formGroup"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"keyup.enter","input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","info",3,"click",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"click",4,"ngIf"],["icon","pi pi-pencil","severity","info",3,"click"],["icon","pi pi-cog","severity","danger",3,"routerLink",4,"ngIf"],["icon","pi pi-cog","severity","danger",3,"routerLink"],["icon","pi pi-trash","severity","danger",3,"click"],["colspan","8"],["style","color: red;",4,"ngIf"],[2,"color","red"],["optionLabel","nombre","formControlName","medida_id",3,"options"],["type","number","min","0","formControlName","cantidad","pInputText","",1,"w-full","mb-3","border-round-3xl"],["icon","pi pi-info-circle",3,"pTooltip"],["formControlName","limite_cantidad","optionLabel","nombre",3,"options"],["type","number","min","0","pInputText","","formControlName","stop_minimo",1,"w-full","mb-3","border-round-3xl"],["type","number","min","0","pInputText","","formControlName","precio_base",1,"w-full","mb-3","border-round-3xl"],["formControlName","visible_receta","optionLabel","nombre",3,"options","onChange"]],template:function(r,o){1&r&&(t.nrm(0,"ngx-spinner",0),t.j41(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),t.EFF(5,"Productos / Servicios"),t.k0s(),t.j41(6,"div",4),t.nrm(7,"div",5),t.k0s()(),t.j41(8,"div",6),t.DNE(9,K,1,0,"button",7),t.k0s()()(),t.j41(10,"div",8)(11,"div",9)(12,"div",10)(13,"p-table",11),t.bIt("onPage",function(d){return o.onPage(d)}),t.DNE(14,Z,7,1,"ng-template",12),t.DNE(15,W,19,0,"ng-template",13),t.DNE(16,rt,23,15,"ng-template",14),t.DNE(17,at,3,0,"ng-template",15),t.k0s(),t.nrm(18,"br"),t.j41(19,"div",16)(20,"span",17)(21,"button",18),t.bIt("click",function(){return o.leftTable()}),t.k0s(),t.nrm(22,"button",19),t.j41(23,"button",20),t.bIt("click",function(){return o.rightTable()}),t.k0s()()()()()(),t.j41(24,"p-dialog",21),t.bIt("visibleChange",function(d){return o.visibleModalProducto=d}),t.j41(25,"div",9)(26,"form",22),t.bIt("ngSubmit",function(){return o.submitCreate()}),t.j41(27,"div",23)(28,"div",24)(29,"label"),t.EFF(30,"Nombre"),t.k0s(),t.nrm(31,"input",25),t.DNE(32,dt,3,2,"div",26),t.k0s(),t.j41(33,"div",24)(34,"label"),t.EFF(35,"Tipo"),t.k0s(),t.j41(36,"p-dropdown",27),t.bIt("onChange",function(){return o.onChangeTipoProductoCrear()}),t.k0s(),t.DNE(37,ct,2,1,"div",26),t.k0s(),t.DNE(38,mt,5,2,"div",28),t.DNE(39,ht,5,1,"div",28),t.DNE(40,Pt,6,3,"div",28),t.j41(41,"div",24)(42,"label"),t.EFF(43,"Bodega"),t.k0s(),t.nrm(44,"p-dropdown",29),t.DNE(45,Et,2,1,"div",26),t.k0s(),t.j41(46,"div",24)(47,"label"),t.EFF(48,"Precio"),t.k0s(),t.nrm(49,"input",30),t.DNE(50,Tt,3,2,"div",26),t.k0s(),t.DNE(51,Dt,4,0,"div",28),t.DNE(52,Gt,5,1,"div",28),t.j41(53,"div",24)(54,"label"),t.EFF(55,"Visible venta"),t.k0s(),t.j41(56,"p-dropdown",31),t.bIt("onChange",function(){return o.onVisibleVentaChange()}),t.k0s(),t.DNE(57,$t,2,1,"div",26),t.k0s(),t.DNE(58,Yt,5,2,"div",28),t.j41(59,"div",32)(60,"p-fileUpload",33,34),t.bIt("onRemove",function(d){return o.onRemove(d)})("onClear",function(d){return o.onRemove(d)})("onSelect",function(d){return o.onSelect(d)}),t.k0s()(),t.j41(62,"div",32)(63,"label"),t.EFF(64,"Descripci\xf3n"),t.k0s(),t.nrm(65,"textarea",35),t.DNE(66,wt,2,1,"div",26),t.k0s(),t.j41(67,"div",32),t.nrm(68,"button",36),t.k0s()(),t.nrm(69,"br"),t.k0s()()(),t.j41(70,"p-dialog",37),t.bIt("visibleChange",function(d){return o.visibleModalProductoEditar=d}),t.j41(71,"div",9)(72,"form",22),t.bIt("ngSubmit",function(){return o.submitUpdate()}),t.j41(73,"div",23)(74,"div",24)(75,"label"),t.EFF(76,"Nombre"),t.k0s(),t.nrm(77,"input",25),t.DNE(78,Bt,3,2,"div",26),t.k0s(),t.j41(79,"div",24)(80,"label"),t.EFF(81,"Tipo"),t.k0s(),t.j41(82,"p-dropdown",27),t.bIt("onChange",function(){return o.onChangeTipoProductoEditar()}),t.k0s(),t.DNE(83,Mt,2,1,"div",26),t.k0s(),t.DNE(84,qt,5,2,"div",28),t.DNE(85,Ot,6,3,"div",28),t.j41(86,"div",24)(87,"label"),t.EFF(88,"Bodega"),t.k0s(),t.nrm(89,"p-dropdown",29),t.DNE(90,Ht,2,1,"div",26),t.k0s(),t.j41(91,"div",24)(92,"label"),t.EFF(93,"Precio"),t.k0s(),t.nrm(94,"input",30),t.DNE(95,Wt,3,2,"div",26),t.k0s(),t.DNE(96,te,4,0,"div",28),t.DNE(97,re,5,1,"div",28),t.j41(98,"div",24)(99,"label"),t.EFF(100,"Visible venta"),t.k0s(),t.j41(101,"p-dropdown",31),t.bIt("onChange",function(){return o.onVisibleVentaChangeEdit()}),t.k0s(),t.DNE(102,ne,2,1,"div",26),t.k0s(),t.DNE(103,le,5,2,"div",28),t.j41(104,"div",32)(105,"p-fileUpload",33,38),t.bIt("onRemove",function(d){return o.onRemove(d)})("onClear",function(d){return o.onRemove(d)})("onSelect",function(d){return o.onSelect(d)}),t.k0s()(),t.j41(107,"div",32)(108,"label"),t.EFF(109,"Descripci\xf3n"),t.k0s(),t.nrm(110,"textarea",35),t.DNE(111,ue,2,1,"div",26),t.k0s(),t.j41(112,"div",32),t.nrm(113,"button",39),t.k0s()(),t.nrm(114,"br"),t.k0s()()()),2&r&&(t.R7$(9),t.Y8G("ngIf",o.permisoCrear),t.R7$(4),t.Y8G("value",o.productsData)("tableStyle",t.lJ4(59,pe))("loading",o.loadingTable)("rows",8)("globalFilterFields",t.lJ4(60,me))("rowHover",!0),t.R7$(8),t.Y8G("disabled",!o.disablePageLeft),t.R7$(1),t.Y8G("label",o.pageActual),t.R7$(1),t.Y8G("disabled",!o.disablePageRight),t.R7$(1),t.Aen(t.lJ4(61,M)),t.Y8G("visible",o.visibleModalProducto)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(2),t.Y8G("formGroup",o.formCreateProduct),t.R7$(6),t.Y8G("ngIf",o.formCreateProduct.get("nombre").invalid&&(o.formCreateProduct.get("nombre").dirty||o.formCreateProduct.get("nombre").touched)),t.R7$(4),t.Y8G("options",o.tipo),t.R7$(1),t.Y8G("ngIf",o.formCreateProduct.get("tipo_producto").invalid&&(o.formCreateProduct.get("tipo_producto").dirty||o.formCreateProduct.get("tipo_producto").touched)),t.R7$(1),t.Y8G("ngIf",o.visibleServicio),t.R7$(1),t.Y8G("ngIf",o.visibleServicio),t.R7$(1),t.Y8G("ngIf",o.visibleServicio),t.R7$(4),t.Y8G("options",o.inventario),t.R7$(1),t.Y8G("ngIf",o.formCreateProduct.get("inventario_id").invalid&&(o.formCreateProduct.get("inventario_id").dirty||o.formCreateProduct.get("inventario_id").touched)),t.R7$(5),t.Y8G("ngIf",o.formCreateProduct.get("precio").invalid&&(o.formCreateProduct.get("precio").dirty||o.formCreateProduct.get("precio").touched)),t.R7$(1),t.Y8G("ngIf",o.visibleServicio),t.R7$(1),t.Y8G("ngIf",o.visibleServicio),t.R7$(4),t.Y8G("options",o.visibleVenta),t.R7$(1),t.Y8G("ngIf",o.formCreateProduct.get("visible_venta").invalid&&(o.formCreateProduct.get("visible_venta").dirty||o.formCreateProduct.get("visible_venta").touched)),t.R7$(1),t.Y8G("ngIf",o.visibleServicio),t.R7$(2),t.Y8G("showUploadButton",!1)("maxFileSize",1e6),t.R7$(6),t.Y8G("ngIf",o.formCreateProduct.get("descripcion").invalid&&(o.formCreateProduct.get("descripcion").dirty||o.formCreateProduct.get("descripcion").touched)),t.R7$(2),t.Y8G("disabled",o.formCreateProduct.invalid),t.R7$(2),t.Aen(t.lJ4(62,M)),t.Y8G("visible",o.visibleModalProductoEditar)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(2),t.Y8G("formGroup",o.formEditProduct),t.R7$(6),t.Y8G("ngIf",o.formEditProduct.get("nombre").invalid&&(o.formEditProduct.get("nombre").dirty||o.formEditProduct.get("nombre").touched)),t.R7$(4),t.Y8G("options",o.tipo),t.R7$(1),t.Y8G("ngIf",o.formEditProduct.get("tipo_producto").invalid&&(o.formEditProduct.get("tipo_producto").dirty||o.formEditProduct.get("tipo_producto").touched)),t.R7$(1),t.Y8G("ngIf",o.visibleServicioEditar),t.R7$(1),t.Y8G("ngIf",o.visibleServicioEditar),t.R7$(4),t.Y8G("options",o.inventario),t.R7$(1),t.Y8G("ngIf",o.formEditProduct.get("inventario_id").invalid&&(o.formEditProduct.get("inventario_id").dirty||o.formEditProduct.get("inventario_id").touched)),t.R7$(5),t.Y8G("ngIf",o.formEditProduct.get("precio").invalid&&(o.formEditProduct.get("precio").dirty||o.formEditProduct.get("precio").touched)),t.R7$(1),t.Y8G("ngIf",o.visibleServicioEditar),t.R7$(1),t.Y8G("ngIf",o.visibleServicioEditar),t.R7$(4),t.Y8G("options",o.visibleVenta),t.R7$(1),t.Y8G("ngIf",o.formEditProduct.get("visible_venta").invalid&&(o.formEditProduct.get("visible_venta").dirty||o.formEditProduct.get("visible_venta").touched)),t.R7$(1),t.Y8G("ngIf",o.visibleServicioEditar),t.R7$(2),t.Y8G("showUploadButton",!1)("maxFileSize",1e6),t.R7$(6),t.Y8G("ngIf",o.formEditProduct.get("descripcion").invalid&&(o.formEditProduct.get("descripcion").dirty||o.formEditProduct.get("descripcion").touched)),t.R7$(2),t.Y8G("disabled",o.formEditProduct.invalid))},dependencies:[f.bT,k.Wk,v.XI,A.Ei,R.N,P._f,P.$n,n.qT,n.me,n.Q0,n.BC,n.cb,n.VZ,T.n,D.S,G.Z,c.ms,_.l,n.j4,n.JD,j.et,B.v,X.m,f.QX,f.PV],styles:["svg[_ngcontent-%COMP%]{width:45%}"]})}}return i})();var w=l(4945);function fe(i,s){if(1&i){const e=t.RV6();t.j41(0,"div",50),t.nrm(1,"span"),t.j41(2,"span",51)(3,"form",7)(4,"div",52)(5,"input",53),t.bIt("keyup.enter",function(o){t.eBV(e);const a=t.XpG(2);return t.Njj(a.buscarPorTeclaDetalles(o))})("input",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.searchInputDetalles())}),t.k0s(),t.j41(6,"button",54),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.searchDetalles())}),t.k0s()()()()()}if(2&i){const e=t.XpG(2);t.R7$(3),t.Y8G("formGroup",e.formSearch)}}function ge(i,s){1&i&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Cantidad"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Tipo de operaci\xf3n"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Estado"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Usuario"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Secuencia Factura"),t.k0s()())}function he(i,s){1&i&&t.nrm(0,"td")}const be=function(i){return{color:i,"font-weight":900}};function ve(i,s){if(1&i&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td",55),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.DNE(11,he,1,0,"ng-template",null,56,t.C5r),t.k0s()),2&i){const e=s.$implicit,r=t.XpG(2);t.R7$(2),t.JRh(e.cantidad),t.R7$(2),t.JRh(r.tipo_operacion_name(e.tipo_operacion_id)),t.R7$(1),t.Y8G("ngStyle",t.eq3(6,be,r.getColor(e.estado))),t.R7$(1),t.JRh(r.operacion(e.estado)),t.R7$(2),t.JRh(null!=e.usuario&&e.usuario.nombres?e.usuario.nombres+" "+e.usuario.apellidos:e.usuario.usuario),t.R7$(2),t.JRh(e.secuencia_interna)}}function Pe(i,s){1&i&&(t.j41(0,"tr")(1,"td",57),t.EFF(2,"Cargando informacion porfavor espere ..."),t.k0s()())}const U=function(){return{"min-width":"50rem"}};function Ce(i,s){if(1&i){const e=t.RV6();t.j41(0,"p-tabPanel",31)(1,"div",32)(2,"div",33)(3,"div")(4,"label",34),t.EFF(5),t.k0s()()(),t.j41(6,"div",35)(7,"div")(8,"button",36),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.openModalAgregar())}),t.k0s(),t.EFF(9," Agregar Producto "),t.k0s(),t.j41(10,"div")(11,"button",37),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.openModalDescontar())}),t.k0s(),t.EFF(12," Descontar Producto "),t.k0s()()(),t.j41(13,"div",38)(14,"div",20)(15,"div",39)(16,"p-table",40),t.DNE(17,fe,7,1,"ng-template",41),t.DNE(18,ge,11,0,"ng-template",42),t.DNE(19,ve,13,8,"ng-template",43),t.DNE(20,Pe,3,0,"ng-template",44),t.k0s(),t.nrm(21,"br"),t.j41(22,"div",45)(23,"span",46)(24,"button",47),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.leftTableDetalles())}),t.k0s(),t.nrm(25,"button",48),t.j41(26,"button",49),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.rightTableDetalles())}),t.k0s()()()()()()()}if(2&i){const e=t.XpG();t.R7$(5),t.SpI("Stock: ",e.stock,""),t.R7$(11),t.Y8G("value",e.dataDetails)("tableStyle",t.lJ4(9,U))("loading",e.loadingTable)("rows",8)("rowHover",!0),t.R7$(8),t.Y8G("disabled",!e.disablePageLeftDetalles),t.R7$(1),t.Y8G("label",e.pageActualDetalles),t.R7$(1),t.Y8G("disabled",!e.disablePageRightDetalles)}}function Ee(i,s){if(1&i){const e=t.RV6();t.j41(0,"div",50),t.nrm(1,"span"),t.j41(2,"span",51)(3,"form",7)(4,"div",52)(5,"input",53),t.bIt("keyup.enter",function(o){t.eBV(e);const a=t.XpG(2);return t.Njj(a.buscarPorTeclaImpuestos(o))})("input",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.searchInputImpuestos())}),t.k0s(),t.j41(6,"button",54),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.searchImpuestos())}),t.k0s()()()()()}if(2&i){const e=t.XpG(2);t.R7$(3),t.Y8G("formGroup",e.formSearch)}}function Ie(i,s){1&i&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Nombre"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Porcentaje"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Acciones"),t.k0s()())}function ke(i,s){if(1&i){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td",64)(6,"p-button",65),t.bIt("click",function(){const a=t.eBV(e).$implicit,d=t.XpG(2);return t.Njj(d.confirmDelete(a.id))}),t.k0s()()()}if(2&i){const e=s.$implicit;t.R7$(2),t.JRh(e.nombre),t.R7$(2),t.JRh(e.porcentaje)}}function Te(i,s){1&i&&(t.j41(0,"tr")(1,"td",57),t.EFF(2,"Cargando informacion porfavor espere ..."),t.k0s()())}function De(i,s){if(1&i){const e=t.RV6();t.j41(0,"p-tabPanel",58)(1,"div",32)(2,"div",59)(3,"div")(4,"div",60)(5,"button",36),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.openModalCrear())}),t.k0s(),t.EFF(6," Agregar Impuesto "),t.k0s()(),t.j41(7,"div",61)(8,"button",62),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.enviarImpuesto())}),t.k0s()()()(),t.j41(9,"div",38)(10,"div",20)(11,"div",39)(12,"p-table",63),t.DNE(13,Ee,7,1,"ng-template",41),t.DNE(14,Ie,7,0,"ng-template",42),t.DNE(15,ke,7,2,"ng-template",43),t.DNE(16,Te,3,0,"ng-template",44),t.k0s(),t.nrm(17,"br"),t.j41(18,"div",45)(19,"span",46)(20,"button",47),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.leftTableImpuestos())}),t.k0s(),t.nrm(21,"button",48),t.j41(22,"button",49),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.rightTableImpuestos())}),t.k0s()()()()()()()}if(2&i){const e=t.XpG();t.R7$(12),t.Y8G("value",e.impuestosData)("tableStyle",t.lJ4(7,U))("loading",e.loadingTable)("rows",8),t.R7$(8),t.Y8G("disabled",!e.disablePageLeftImpuestos),t.R7$(1),t.Y8G("label",e.pageActualImpuestos),t.R7$(1),t.Y8G("disabled",!e.disablePageRightImpuestos)}}function je(i,s){1&i&&(t.j41(0,"div",66),t.EFF(1,"Campo requerido"),t.k0s())}function Fe(i,s){1&i&&(t.j41(0,"div",66),t.EFF(1,"Campo requerido"),t.k0s())}function Re(i,s){1&i&&(t.j41(0,"div",66),t.EFF(1,"Campo requerido"),t.k0s())}const S=function(){return{width:"60vw"}};let Ge=(()=>{class i{constructor(e,r,o,a,d){this.FB=e,this.productsService=r,this.spinner=o,this.route=a,this.router=d,this.permisoDetalle=C.u.hasPermission(["gestionInventario.productos.detalle"]),this.permisoImpuesto=C.u.hasPermission(["gestionInventario.productos.impuestoProducto"]),this.loadingTable=!0,this.impuestosData=[],this.impuestoModalCrear=!1,this.dataDetails=[],this.productoModalAgregar=!1,this.productoModalDescontar=!1,this.pageActualDetalles=1,this.pageCountDetalles=10,this.disablePageLeftDetalles=!1,this.disablePageRightDetalles=!1,this.pageActualImpuestos=1,this.pageCountImpuestos=10,this.disablePageLeftImpuestos=!1,this.disablePageRightImpuestos=!1}ngOnInit(){this.impuestosData=[],this.route.params.subscribe(e=>{this.id=e.id}),this.formCreate=this.FB.group({impuesto:["",n.k0.required]}),setTimeout(()=>{this.loadImpuesto()}),this.buildForm(),this.pageActualDetalles=1,this.getDetallesProducto(this.id,this.pageCountDetalles,this.pageActualDetalles)}buildForm(){this.formSearch=this.FB.group({search:["",[]]}),this.form=this.FB.group({nombreProducto:["",[]],precio:["",[]],cantidad:["",[]],medida:["",[]]}),this.form.get("nombreProducto").disable(),this.form.get("precio").disable(),this.form.get("cantidad").disable(),this.form.get("medida").disable(),this.formCreateDetalle=this.FB.group({cantidad:["",n.k0.required]}),this.formDescontarDetalle=this.FB.group({cantidad:["",n.k0.required]})}getDetallesProducto(e,r=this.pageCountDetalles,o=1,a=""){this.spinner.show(),this.loadingTable=!0,this.productsService.getDetallesProducto(e,r,o,a).subscribe(d=>{this.spinner.hide(),this.loadingTable=!1,this.productsData=d.producto,this.dataDetails=d.detalles.data,this.tipo_operacion=d.tipo_operacion,this.stock=this.productsData.cantidad,this.ultimaPageDetalles=d.detalles.last_page,this.registrosContarDetalles=d.detalles.total,this.pageActualDetalles=o,this.validatePageDetalles();const b=Number(this.productsData.precio).toLocaleString("es-CO");this.form.get("nombreProducto").setValue(this.productsData.nombre.charAt(0).toUpperCase()+this.productsData.nombre.slice(1).toLowerCase()),this.form.get("precio").setValue(`$${b}`),this.form.get("cantidad").setValue(this.productsData.cantidad),d.medida.forEach(E=>{E.id==this.productsData.medida_id&&this.form.get("medida").setValue(E.nombre)}),this.ultimoIngresado=d.registro_reciente},d=>{this.spinner.hide(),this.loadingTable=!1,console.log("Error: ",d)})}searchInputDetalles(){let e=this.formSearch.get("search").value;this.pageActualDetalles=1,""==e&&this.getDetallesProducto(this.id,this.pageCountDetalles,this.pageActualDetalles,e)}searchDetalles(){let e=this.formSearch.get("search").value;this.pageActualDetalles=1,this.getDetallesProducto(this.id,this.pageCountDetalles,this.pageActualDetalles,e)}onPageDetalles(e){this.pageActualDetalles=e.page+1,this.pageCountDetalles=e.rows,this.getDetallesProducto(this.id,this.pageCountDetalles,this.pageActualDetalles,this.formSearch.get("search").value)}buscarPorTeclaDetalles(e){"Enter"==e.code&&this.searchDetalles()}leftTableDetalles(){this.pageActualDetalles--,this.getDetallesProducto(this.productsData.id,this.pageCountDetalles,this.pageActualDetalles),this.validatePageDetalles()}rightTableDetalles(){this.pageActualDetalles++,this.getDetallesProducto(this.productsData.id,this.pageCountDetalles,this.pageActualDetalles),this.validatePageDetalles()}validatePageDetalles(){this.disablePageLeftDetalles=1!=this.pageActualDetalles,this.disablePageRightDetalles=!(this.pageActualDetalles>=this.ultimaPageDetalles)}agregarProducto(){const e={producto_id:this.id,cantidad:this.formCreateDetalle.get("cantidad").value};this.productsService.createDetalle(e).subscribe(r=>{"success"==r.code?(this.productoModalAgregar=!1,this.getDetallesProducto(this.id),p().fire({title:"Exito",text:"Producto agregado correctamente",icon:"success"}),this.formCreateDetalle.reset()):(this.productoModalAgregar=!1,p().fire({title:"Error",text:"No se pudo agregar el producto",icon:"error"}))})}eliminarProducto(e){p().fire({title:"Advertencia",text:"\xbfEst\xe1 seguro de eliminar \xe9ste registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(r=>{r.isConfirmed&&this.productsService.deleteDetalle({id:e}).subscribe(a=>{"success"==a.code?(this.getDetallesProducto(this.id),p().fire({title:"Exito",text:"Producto eliminado correctamente",icon:"success"})):p().fire({title:"Error",text:"No se pudo eliminar el producto",icon:"error"})})})}operacion(e){return 2==e?"Ingresado":4==e?"Descontado":3==e?"Consumido":0==e?"Anulado":"Operacion no identificada"}tipo_operacion_name(e){return this.tipo_operacion.filter(o=>o.id==e)[0].nombre}getColor(e){switch(this.operacion(e)){case"Ingresado":return"#52D328";case"Consumido":case"Descontado":return"red";default:return"black"}}totalDisponible(){let e=0;return this.dataDetails.forEach(r=>{2==r.estado?e+=r.cantidad:3==r.estado&&(e-=r.cantidad)}),1==this.productsData?.sin_limite_cantidad?e:"Ilimitado"}submitCreate(){this.impuestoModalCrear=!1,0==this.impuestosData.filter(r=>r?.id==this.formCreate.get("impuesto").value.id).length?this.impuestosData.push({nombre:this.formCreate.get("impuesto").value.nombre,porcentaje:this.formCreate.get("impuesto").value.porcentaje,id:this.formCreate.get("impuesto").value.id}):p().fire({title:"Advertecia",text:"El Impuesto ya fue agregado.",icon:"warning"})}descontarProducto(){const e={producto_id:this.id,cantidad:this.formDescontarDetalle.get("cantidad").value,estado:4};this.productsService.createDetalle(e).subscribe(r=>{"success"==r.code?(this.productoModalDescontar=!1,this.getDetallesProducto(this.id),p().fire({title:"Exito",text:"Producto descontado correctamente",icon:"success"}),this.formDescontarDetalle.reset()):(this.productoModalDescontar=!1,p().fire({title:"Error",text:"No se pudo descontar el producto",icon:"error"}))},r=>{console.log("Error:",r),this.productoModalDescontar=!1,p().fire({title:"Error",text:"Ocurri\xf3 un error al intentar descontar el producto",icon:"error"})})}openModalCrear(){this.impuestoModalCrear=!0,this.getImpuestoCrear()}openModalAgregar(){this.productoModalAgregar=!0}openModalDescontar(){this.productoModalDescontar=!0}onChangeCreateImpuesto(){}confirmDelete(e){this.impuestosData=this.impuestosData.filter(r=>r.id!=e)}loadImpuesto(e=this.pageCountImpuestos,r=1,o=""){this.productsService.getImpuesto(this.id,e,r,o).subscribe(a=>{this.impuestosData=a.impuestoProducto.data.map(d=>({nombre:d.impuesto.nombre,porcentaje:d.impuesto.porcentaje,id:d.impuesto_id})),this.ultimaPageImpuestos=a.impuestoProducto.last_page,this.registrosContarImpuestos=a.impuestoProducto.total,this.validatePageImpuestos()},a=>{console.log("Error: ",a)})}searchInputImpuestos(){let e=this.formSearch.get("search").value;this.pageActualImpuestos=1,""==e&&this.loadImpuesto(this.pageCountImpuestos,this.pageActualImpuestos,e)}searchImpuestos(){let e=this.formSearch.get("search").value;this.pageActualImpuestos=1,this.loadImpuesto(this.pageCountImpuestos,this.pageActualImpuestos,e)}onPageImpuestos(e){this.pageActualImpuestos=e.page+1,this.pageCountImpuestos=e.rows,this.loadImpuesto(this.pageCountImpuestos,this.pageActualImpuestos,this.formSearch.get("search").value)}buscarPorTeclaImpuestos(e){"Enter"==e.code&&this.searchImpuestos()}leftTableImpuestos(){this.pageActualImpuestos--,this.loadImpuesto(this.pageCountImpuestos,this.pageActualImpuestos),this.validatePageImpuestos()}rightTableImpuestos(){this.pageActualImpuestos++,this.loadImpuesto(this.pageCountImpuestos,this.pageActualImpuestos),this.validatePageImpuestos()}validatePageImpuestos(){this.disablePageLeftImpuestos=1!=this.pageActualImpuestos,this.disablePageRightImpuestos=!(this.pageActualImpuestos>=this.ultimaPageImpuestos)}getImpuestoCrear(){this.spinner.show(),this.productsService.getImpuestoCrear().subscribe(e=>{this.spinner.hide(),this.impuestos=e.impuestos})}saveImpuesto(e){this.productsService.createImpuesto(e).subscribe(r=>{r.val?(p().fire({title:"Exito",text:r.msm,icon:"success"}),this.router.navigate(["/dashboard/products"])):p().fire({title:"Error",text:r.msm,icon:"error"})})}enviarImpuesto(){this.saveImpuesto({impuestos:this.impuestosData,id:this.id})}static{this.\u0275fac=function(r){return new(r||i)(t.rXU(n.ok),t.rXU(V),t.rXU(j.ex),t.rXU(k.nX),t.rXU(k.Ix))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-products-tribute"]],decls:70,vars:35,consts:[["type","ball-scale-multiple","size","large","bdColor","rgba(192,192,192,0.8)","template","<img src='assets/loading/cargando.gif' />"],[1,"card","mb-3"],[1,"surface-section","px-2","pt-3","md:px-6","lg:px-8"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-column"],[1,"flex"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",1,"p-button-outlined","mr-4",3,"routerLink"],[1,"flex","align-items-center","font-medium","text-3xl","text-900"],[3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-6","md:col-4"],["type","text","formControlName","nombreProducto","pInputText","",1,"w-full","mb-3","border-round-3xl"],["type","text","formControlName","precio","pInputText","",1,"w-full","mb-3","border-round-3xl"],["type","text","formControlName","medida","pInputText","",1,"w-full","mb-3","border-round-3xl"],[1,"field","col-12","md:col-4"],["type","text","pInputText","","disabled","true",1,"w-full","mb-3","border-round-3xl",3,"value"],[1,"card"],["orientation","left"],["header","Detalles Producto","class","line-height-3 m-0",4,"ngIf"],["header","Impuestos Producto","class","line-height-3 m-0",4,"ngIf"],["header","Agregar Producto",3,"visible","modal","draggable","resizable","visibleChange"],[1,"col-12"],[3,"formGroup","ngSubmit"],[1,"field","col-12","md:col-12"],["type","number","min","1","formControlName","cantidad","placeholder","Cantidad","pInputText","",1,"w-full","mb-3","border-round-3xl"],["style","color: red;",4,"ngIf"],["pButton","","pRipple","","label","Agregar producto","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"disabled"],["header","Descontar Producto",3,"visible","modal","draggable","resizable","visibleChange"],["pButton","","pRipple","","label","Descontar producto","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl",3,"disabled"],["header","Agregar Impuesto",3,"visible","modal","draggable","resizable","visibleChange"],["formControlName","impuesto","optionLabel","nombre",3,"options","onChange"],["pButton","","pRipple","","label","Agregar Impuesto","icon","pi pi-fw","type","submit",1,"w-full","bg-admin","boder-admin","mb-5","border-round-3xl"],["header","Detalles Producto",1,"line-height-3","m-0"],[1,"surface-section","px-4","py-5","md:px-6","lg:px-8"],[1,"flex","align-items-center","justify-content-end","font-medium","text-3xl","text-900"],[1,"text-right","mr-4"],[1,"flex","align-items-center","justify-content-between","font-medium","text-3xl","text-900","mt-3"],["pButton","","pRipple","","type","button","icon","pi pi-plus",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-minus",1,"p-button-rounded","p-button-text",3,"click"],[1,"grid","mt-3"],[1,"card","px-3","py-3"],["responsiveLayout","scroll",3,"value","tableStyle","loading","rows","rowHover"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loadingbody"],[2,"text-align","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","","icon","pi pi-arrow-left",3,"disabled","click"],["pButton","","pRipple","",3,"label"],["pButton","","pRipple","","label","","icon","pi pi-arrow-right",3,"disabled","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"p-inputgroup"],["formControlName","search","pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"keyup.enter","input"],["type","button","pButton","","pRipple","",1,"pi","pi-search",3,"click"],[3,"ngStyle"],["relleno",""],["colspan","8"],["header","Impuestos Producto",1,"line-height-3","m-0"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"mt-3","lg:mt-0"],["pButton","","pRipple","","label","Guardar","icon","",1,"p-button-outlined","mr-2",3,"click"],["responsiveLayout","scroll",3,"value","tableStyle","loading","rows"],[1,"flex","gap-2"],["icon","pi pi-trash","severity","danger",3,"click"],[2,"color","red"]],template:function(r,o){1&r&&(t.nrm(0,"ngx-spinner",0),t.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t.nrm(5,"button",5),t.j41(6,"div",6),t.EFF(7," Detalle de Producto "),t.k0s()(),t.j41(8,"div")(9,"form",7),t.nrm(10,"br"),t.j41(11,"div",8)(12,"div",9)(13,"label"),t.EFF(14,"Nombre"),t.k0s(),t.nrm(15,"input",10),t.k0s(),t.j41(16,"div",9)(17,"label"),t.EFF(18," Precio "),t.k0s(),t.nrm(19,"input",11),t.k0s(),t.j41(20,"div",9)(21,"label"),t.EFF(22,"Medida"),t.k0s(),t.nrm(23,"br")(24,"input",12),t.k0s(),t.j41(25,"div",13)(26,"label"),t.EFF(27,"Total productos disponibles"),t.k0s(),t.nrm(28,"br")(29,"input",14),t.k0s()()()()()()(),t.j41(30,"div",15)(31,"p-tabView",16),t.DNE(32,Ce,27,10,"p-tabPanel",17),t.DNE(33,De,23,8,"p-tabPanel",18),t.k0s()(),t.j41(34,"p-dialog",19),t.bIt("visibleChange",function(d){return o.productoModalAgregar=d}),t.j41(35,"div",20)(36,"form",21),t.bIt("ngSubmit",function(){return o.agregarProducto()}),t.j41(37,"div",8)(38,"div",22)(39,"label"),t.EFF(40,"Agregar"),t.k0s(),t.nrm(41,"input",23),t.DNE(42,je,2,0,"div",24),t.k0s(),t.j41(43,"div",22),t.nrm(44,"button",25),t.k0s()(),t.nrm(45,"br"),t.k0s()()(),t.j41(46,"p-dialog",26),t.bIt("visibleChange",function(d){return o.productoModalDescontar=d}),t.j41(47,"div",20)(48,"form",21),t.bIt("ngSubmit",function(){return o.descontarProducto()}),t.j41(49,"div",8)(50,"div",22)(51,"label"),t.EFF(52,"Descontar"),t.k0s(),t.nrm(53,"input",23),t.DNE(54,Fe,2,0,"div",24),t.k0s(),t.j41(55,"div",22),t.nrm(56,"button",27),t.k0s()(),t.nrm(57,"br"),t.k0s()()(),t.j41(58,"p-dialog",28),t.bIt("visibleChange",function(d){return o.impuestoModalCrear=d}),t.j41(59,"div",20)(60,"form",21),t.bIt("ngSubmit",function(){return o.submitCreate()}),t.j41(61,"div",8)(62,"div",22)(63,"label"),t.EFF(64,"Impuesto"),t.k0s(),t.j41(65,"p-dropdown",29),t.bIt("onChange",function(){return o.onChangeCreateImpuesto()}),t.k0s(),t.DNE(66,Re,2,0,"div",24),t.k0s(),t.j41(67,"div",22),t.nrm(68,"button",30),t.k0s()(),t.nrm(69,"br"),t.k0s()()()),2&r&&(t.R7$(5),t.Y8G("routerLink","/dashboard/products"),t.R7$(4),t.Y8G("formGroup",o.form),t.R7$(20),t.Y8G("value",o.totalDisponible()),t.R7$(3),t.Y8G("ngIf",o.permisoDetalle),t.R7$(1),t.Y8G("ngIf",o.permisoImpuesto),t.R7$(1),t.Aen(t.lJ4(32,S)),t.Y8G("visible",o.productoModalAgregar)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(2),t.Y8G("formGroup",o.formCreateDetalle),t.R7$(6),t.Y8G("ngIf",o.formCreateDetalle.get("cantidad").hasError("required")),t.R7$(2),t.Y8G("disabled",o.formCreateDetalle.invalid),t.R7$(2),t.Aen(t.lJ4(33,S)),t.Y8G("visible",o.productoModalDescontar)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(2),t.Y8G("formGroup",o.formDescontarDetalle),t.R7$(6),t.Y8G("ngIf",o.formDescontarDetalle.get("cantidad").hasError("required")),t.R7$(2),t.Y8G("disabled",o.formDescontarDetalle.invalid),t.R7$(2),t.Aen(t.lJ4(34,S)),t.Y8G("visible",o.impuestoModalCrear)("modal",!0)("draggable",!1)("resizable",!1),t.R7$(2),t.Y8G("formGroup",o.formCreate),t.R7$(5),t.Y8G("options",o.impuestos),t.R7$(1),t.Y8G("ngIf",o.formCreate.get("impuesto").hasError("required")))},dependencies:[f.bT,f.B3,k.Wk,v.XI,A.Ei,P._f,P.$n,n.qT,n.me,n.Q0,n.BC,n.cb,n.VZ,T.n,D.S,c.ms,_.l,n.j4,n.JD,j.et,w.JQ,w.Kp]})}}return i})();var L=l(1765);let xe=(()=>{class i{static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[k.iI.forChild([{path:"",component:_e,canActivate:[L.q],data:{permissions:["gestionInventario.productos"]}},{path:":id/impuesto",component:Ge,canActivate:[L.q],data:{permissions:["gestionInventario.productos.detalle","gestionInventario.productos.impuestoProducto"]}}]),k.iI]})}}return i})();var $e=l(6627),ye=l(2011);let Ne=(()=>{class i{static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({providers:[{provide:g.a7,useClass:Y.R,multi:!0},V],imports:[f.MD,xe,v.bG,R.e,n.YN,P.tm,T.Z,$.MB,y.m,N.wZ,D.u,G.f,c.kr,I.Ko,m.O3,_.P,x.RZ.forRoot(),n.X1,j.PO,$e.I,ye.dL,w.fd,B.$,X.S]})}}return i})()},935:(q,F,l)=>{l.d(F,{$:()=>G,v:()=>D});var f=l(177),n=l(540),v=l(5779);function R(c,I){if(1&c&&n.nrm(0,"span",5),2&c){const m=n.XpG(2);n.Y8G("ngClass",m.icon)}}function P(c,I){if(1&c&&(n.qex(0),n.DNE(1,R,1,1,"span",4),n.bVm()),2&c){const m=n.XpG();n.R7$(1),n.Y8G("ngIf",m.icon)}}function T(c,I){}function $(c,I){1&c&&n.DNE(0,T,0,0,"ng-template")}function y(c,I){if(1&c&&(n.j41(0,"span",6),n.DNE(1,$,1,0,null,7),n.k0s()),2&c){const m=n.XpG();n.R7$(1),n.Y8G("ngTemplateOutlet",m.iconTemplate)}}const N=["*"];let D=(()=>{class c{style;styleClass;severity;value;icon;rounded;templates;iconTemplate;ngAfterContentInit(){this.templates?.forEach(m=>{"icon"===m.getType()&&(this.iconTemplate=m.template)})}containerClass(){return{"p-tag p-component":!0,"p-tag-info":"info"===this.severity,"p-tag-success":"success"===this.severity,"p-tag-warning":"warning"===this.severity,"p-tag-danger":"danger"===this.severity,"p-tag-rounded":this.rounded}}static \u0275fac=function(_){return new(_||c)};static \u0275cmp=n.VBU({type:c,selectors:[["p-tag"]],contentQueries:function(_,g,Y){if(1&_&&n.wni(Y,v.Ei,4),2&_){let x;n.mGM(x=n.lsd())&&(g.templates=x)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",severity:"severity",value:"value",icon:"icon",rounded:"rounded"},ngContentSelectors:N,decls:6,vars:7,consts:[[3,"ngClass","ngStyle"],[4,"ngIf"],["class","p-tag-icon",4,"ngIf"],[1,"p-tag-value"],["class","p-tag-icon",3,"ngClass",4,"ngIf"],[1,"p-tag-icon",3,"ngClass"],[1,"p-tag-icon"],[4,"ngTemplateOutlet"]],template:function(_,g){1&_&&(n.NAR(),n.j41(0,"span",0),n.SdG(1),n.DNE(2,P,2,1,"ng-container",1),n.DNE(3,y,2,1,"span",2),n.j41(4,"span",3),n.EFF(5),n.k0s()()),2&_&&(n.HbH(g.styleClass),n.Y8G("ngClass",g.containerClass())("ngStyle",g.style),n.R7$(2),n.Y8G("ngIf",!g.iconTemplate),n.R7$(1),n.Y8G("ngIf",g.iconTemplate),n.R7$(2),n.JRh(g.value))},dependencies:[f.YU,f.bT,f.T3,f.B3],styles:[".p-tag{display:inline-flex;align-items:center;justify-content:center}.p-tag-icon,.p-tag-value,.p-tag-icon.pi{line-height:1.5}.p-tag.p-tag-rounded{border-radius:10rem}\n"],encapsulation:2,changeDetection:0})}return c})(),G=(()=>{class c{static \u0275fac=function(_){return new(_||c)};static \u0275mod=n.$C({type:c});static \u0275inj=n.G2t({imports:[f.MD,v.Gg,v.Gg]})}return c})()}}]);